import{a as nt}from"./chunk-UNQU2UC2.js";import{a as Q,c as X,e as Y,i as Z,j as $,k as tt,l as et,n as it}from"./chunk-RG37TT4Q.js";import{a as at}from"./chunk-PBTFW77J.js";import"./chunk-QQWCK2ZL.js";import{c as J,e as K}from"./chunk-7BQHTMQB.js";import{i as j,j as H,k as q,m as U,p as G}from"./chunk-VUYFDMJB.js";import{Aa as M,Bb as R,Ga as W,La as v,Wa as N,X as g,Xa as m,Y as _,Ya as i,Za as e,_a as E,cb as V,db as z,eb as k,hb as p,ib as c,jb as F,kb as A,lb as w,mb as P,nb as r,ob as b,pb as u,qb as L,rb as f,sb as T,ta as B,tb as S,ua as s,vb as I,xb as y,zb as C}from"./chunk-CVFHM34U.js";import"./chunk-X5YLR3NI.js";import{a as D,c as O,i as h}from"./chunk-ODN5LVDJ.js";var lt=()=>["da_fare","in_lavorazione","completato"],dt=()=>[];function ct(l,a){if(l&1){let t=k();i(0,"div",16)(1,"button",17),p("click",function(){g(t);let n=c();return _(n.eliminaMacroTask())}),i(2,"i",5),r(3,"delete_forever"),e(),r(4," Elimina "),e(),i(5,"button",17),p("click",function(){g(t);let n=c();return _(n.salvaComeTemplate())}),i(6,"i",5),r(7,"content_copy"),e(),r(8," Salva come Template "),e(),i(9,"button",18),p("click",function(){g(t);let n=c();return _(n.salvaMacroTask())}),i(10,"i",5),r(11,"save"),e(),r(12),e()()}if(l&2){let t=c();s(),m("disabled",t.loading),s(4),m("disabled",t.loading),s(4),m("disabled",t.loading),s(),w("spin",t.loading),s(2),u(" ",t.loading?"Salvataggio...":"Salva"," ")}}function mt(l,a){if(l&1&&(i(0,"div",19)(1,"p",20),r(2),e()()),l&2){let t=c();s(2),u("ID: ",t.macroTask.id)}}function gt(l,a){l&1&&(i(0,"div",21),E(1,"div",22),i(2,"p"),r(3,"Caricamento task..."),e()())}function _t(l,a){if(l&1&&(i(0,"div",23)(1,"i",5),r(2,"warning"),e(),r(3),e()),l&2){let t=c();s(3),u(" ",t.error," ")}}function pt(l,a){if(l&1&&(i(0,"option",37),r(1),e()),l&2){let t=a.$implicit;m("value",t.id),s(),u(" ",t.ragione_sociale," ")}}function ut(l,a){if(l&1){let t=k();i(0,"div",57)(1,"button",18),p("click",function(){g(t);let n=c(2);return _(n.salvaMacroTask())}),i(2,"i",5),r(3,"save"),e(),r(4," Crea Macro Task "),e()()}if(l&2){let t=c(2);s(),m("disabled",t.loading),s(),w("spin",t.loading)}}function vt(l,a){l&1&&(i(0,"div",63)(1,"i",5),r(2,"layers"),e(),i(3,"h4"),r(4,"Nessuna sotto task"),e(),i(5,"p"),r(6,"Crea la prima sotto task per suddividere il lavoro"),e()())}function kt(l,a){if(l&1&&(i(0,"span",86)(1,"i",5),r(2,"checklist"),e(),r(3),e()),l&2){let t=c().$implicit;s(3),u(" ",t.task_dettaglio.length," dettagli ")}}function xt(l,a){if(l&1){let t=k();i(0,"li")(1,"a",81),p("click",function(){let n=g(t).$implicit,d=c(2).$implicit,x=c(4);return x.cambiaStatoSottoTask(d,n),_(x.closeDropdown())}),r(2),e()()}if(l&2){let t=a.$implicit,o=c(6);s(2),u(" ",o.getStatoTesto(t)," ")}}function ft(l,a){l&1&&(V(0),i(1,"li")(2,"h6",87),r(3,"Cambia Stato"),e()(),v(4,xt,3,1,"li",88),i(5,"li"),E(6,"hr",89),e(),z()),l&2&&(s(4),m("ngForOf",I(1,lt)))}function Tt(l,a){l&1&&(i(0,"div",90)(1,"i",5),r(2,"android"),e()())}function St(l,a){if(l&1){let t=k();i(0,"p",100),p("click",function(){g(t);let n=c().$implicit,d=c(6);return _(d.apriDettaglio(n))}),r(1),e()}if(l&2){let t=c().$implicit;s(),u(" ",t.descrizione," ")}}function ht(l,a){if(l&1){let t=k();i(0,"div",93)(1,"div",94)(2,"input",95),p("change",function(){let n=g(t).$implicit,d=c(2).$implicit,x=c(4);return _(x.toggleDettaglioCompletato(n,d))}),e(),i(3,"div",96)(4,"div",97)(5,"strong"),r(6),e(),i(7,"span",20)(8,"i",5),r(9,"schedule"),e(),r(10),y(11,"date"),e(),i(12,"button",98),p("click",function(){let n=g(t).$implicit,d=c(2).$implicit,x=c(4);return _(x.eliminaDettaglio(n,d))}),i(13,"i",5),r(14,"delete_forever"),e()()(),v(15,St,2,1,"p",99),e()()()}if(l&2){let t=a.$implicit;s(2),m("checked",t.completato),s(3),w("completed",t.completato),s(),b(t.nome),s(4),u(" ",C(11,6,t.data_scadenza_prevista,"dd/MM/yyyy")," "),s(5),m("ngIf",t.descrizione)}}function bt(l,a){if(l&1&&(i(0,"div",91),v(1,ht,16,9,"div",92),e()),l&2){let t=c().$implicit,o=c(4);s(),m("ngForOf",t.task_dettaglio)("ngForTrackBy",o.trackByDettaglio)}}function wt(l,a){if(l&1){let t=k();i(0,"div",63)(1,"i",5),r(2,"info"),e(),r(3," Nessun dettaglio aggiunto. "),i(4,"a",101),p("click",function(){g(t);let n=c().$implicit,d=c(4);return _(d.apriModal("dettaglio",n))}),r(5,"Aggiungi il primo dettaglio"),e()()}}function yt(l,a){if(l&1){let t=k();i(0,"div",66)(1,"div",67),p("click",function(){let n=g(t).$implicit,d=c(4);return _(d.toggleSottoTaskEspansa(n.id))}),i(2,"div",68)(3,"button",69),p("click",function(n){let d=g(t).$implicit,x=c(4);return n.stopPropagation(),_(x.toggleSottoTaskEspansa(d.id))}),i(4,"i",5),r(5),e()(),i(6,"div",70)(7,"h4",71),r(8),e(),i(9,"div",72)(10,"span",73),r(11),e(),i(12,"span",73),r(13),e(),i(14,"span",20)(15,"i",5),r(16,"calendar_today"),e(),r(17),y(18,"date"),e(),v(19,kt,4,1,"span",74),e()()(),i(20,"div",75),p("click",function(n){return g(t),_(n.stopPropagation())}),i(21,"button",76),p("click",function(){let n=g(t).$implicit,d=c(4);return _(d.apriModal("modificaSottoTask",n))}),i(22,"i",5),r(23,"edit"),e()(),i(24,"div",77)(25,"button",78),p("click",function(n){let d=g(t).$implicit,x=c(4);return _(x.toggleDropdown(d.id,n))}),i(26,"i",5),r(27,"more_vert"),e()(),i(28,"ul",79),p("click",function(n){return g(t),_(n.stopPropagation())}),v(29,ft,7,2,"ng-container",80),i(30,"li")(31,"a",81),p("click",function(){let n=g(t).$implicit,d=c(4);return d.apriModal("dettaglio",n),_(d.closeDropdown())}),i(32,"i",5),r(33,"add"),e(),r(34," Aggiungi Dettaglio "),e()()()(),v(35,Tt,3,0,"div",82),e()(),i(36,"div",83),v(37,bt,2,2,"div",84)(38,wt,6,0,"div",85),e()()}if(l&2){let t=a.$implicit,o=c(4);w("expanded",o.isSottoTaskEspansa(t.id)),s(3),m("title",o.isSottoTaskEspansa(t.id)?"Riduci dettagli":"Espandi dettagli"),N("aria-expanded",o.isSottoTaskEspansa(t.id)),s(2),u(" ",o.isSottoTaskEspansa(t.id)?"expand_less":"expand_more"," "),s(3),u(" ",t.nome," "),s(2),P(o.getPrioritaBadgeClass(t.priorita)),s(),u(" P",t.priorita," "),s(),P(o.getStatoBadgeClass(t.stato)),s(),u(" ",o.getStatoTesto(t.stato)," "),s(4),u(" ",C(18,22,t.created_at,"dd/MM/yyyy")," "),s(2),m("ngIf",t.task_dettaglio&&t.task_dettaglio.length>0),s(9),w("show",o.isDropdownOpen(t.id)),s(),m("ngIf",o.puoiModificareSottoTask(t)),s(6),m("ngIf",!o.puoiModificareSottoTask(t)),s(),w("show",o.isSottoTaskEspansa(t.id)),s(),m("ngIf",t.task_dettaglio&&t.task_dettaglio.length>0),s(),m("ngIf",!t.task_dettaglio||t.task_dettaglio.length===0)}}function Ct(l,a){if(l&1&&(i(0,"div",64),v(1,yt,39,25,"div",65),e()),l&2){let t=c(3);s(),m("ngForOf",t.macroTask.sotto_tasks)("ngForTrackBy",t.trackBySottoTask)}}function Mt(l,a){if(l&1){let t=k();i(0,"div",2)(1,"div",3)(2,"h3",7)(3,"i",5),r(4,"layers"),e(),r(5," Sotto Tasks "),i(6,"span",58),r(7),e()(),i(8,"div",59)(9,"button",60),p("click",function(){g(t);let n=c(2);return _(n.toggleEspandiTutti())}),i(10,"i",5),r(11),e(),r(12),e(),i(13,"button",61),p("click",function(){g(t);let n=c(2);return _(n.apriModal("sottoTask"))}),i(14,"i",5),r(15,"add"),e(),r(16," Nuova Sotto Task "),e()()(),v(17,vt,7,0,"ng-template",null,0,R)(19,Ct,2,2,"div",62),e()}if(l&2){let t=F(18),o=c(2);s(7),b((o.macroTask.sotto_tasks==null?null:o.macroTask.sotto_tasks.length)||0),s(2),m("title",o.espandiTutti?"Riduci tutte":"Espandi tutte"),s(2),u(" ",o.espandiTutti?"unfold_less":"unfold_more"," "),s(),u(" ",o.espandiTutti?"Riduci Tutte":"Espandi Tutte"," "),s(7),m("ngIf",o.macroTask.sotto_tasks&&o.macroTask.sotto_tasks.length>0)("ngIfElse",t)}}function Et(l,a){if(l&1){let t=k();i(0,"div",24)(1,"div",25)(2,"div",2)(3,"h3",7),r(4,"Informazioni Principali"),e(),i(5,"div",26)(6,"div",27)(7,"label",28),r(8,"Nome Task *"),e(),i(9,"input",29),S("ngModelChange",function(n){g(t);let d=c();return T(d.macroTask.nome,n)||(d.macroTask.nome=n),_(n)}),e()(),i(10,"div",30)(11,"label",31),r(12,"Data Scadenza"),e(),i(13,"input",32),S("ngModelChange",function(n){g(t);let d=c();return T(d.macroTask.data_scadenza,n)||(d.macroTask.data_scadenza=n),_(n)}),e()(),i(14,"div",30)(15,"label",33),r(16,"Stato"),e(),E(17,"input",34),e()(),i(18,"div",30)(19,"label",35),r(20,"Cliente"),e(),i(21,"select",36),S("ngModelChange",function(n){g(t);let d=c();return T(d.macroTask.cliente_id,n)||(d.macroTask.cliente_id=n),_(n)}),i(22,"option",37),r(23,"Nessun cliente"),e(),v(24,pt,2,2,"option",38),e()(),i(25,"div",30)(26,"label",39),r(27,"Modulo *"),e(),i(28,"select",40),S("ngModelChange",function(n){g(t);let d=c();return T(d.macroTask.assegnazione_id,n)||(d.macroTask.assegnazione_id=n),_(n)}),i(29,"option",37),r(30,"Seleziona Modulo"),e(),i(31,"option",41),r(32,"Immagine"),e(),i(33,"option",42),r(34,"Digitalizzazione"),e(),i(35,"option",43),r(36,"Contabilit\xE0"),e(),i(37,"option",44),r(38,"Ottimizzazione"),e()()(),i(39,"div",30)(40,"label",45),r(41,"Note"),e(),i(42,"textarea",46),S("ngModelChange",function(n){g(t);let d=c();return T(d.macroTask.note,n)||(d.macroTask.note=n),_(n)}),e()(),v(43,ut,5,3,"div",47),e(),v(44,Mt,20,6,"div",48),e(),i(45,"div",49)(46,"div",50)(47,"h4"),r(48,"Riepilogo Task"),e(),i(49,"div",51)(50,"div",52)(51,"label"),r(52,"Stato:"),e(),i(53,"span",53),r(54),e()(),i(55,"div",52)(56,"label"),r(57,"Priorit\xE0:"),e(),i(58,"span",53),r(59),e()(),i(60,"div",52)(61,"label"),r(62,"Progresso:"),e(),i(63,"div",54)(64,"div",55)(65,"span",56),r(66),e()()()(),i(67,"div",52)(68,"label"),r(69,"Cliente:"),e(),i(70,"span"),r(71),e()(),i(72,"div",52)(73,"label"),r(74,"Modulo:"),e(),i(75,"span"),r(76),e()(),i(77,"div",52)(78,"label"),r(79,"Scadenza:"),e(),i(80,"span"),r(81),y(82,"date"),e()(),i(83,"div",52)(84,"label"),r(85,"Creato il:"),e(),i(86,"span"),r(87),y(88,"date"),e()(),i(89,"div",52)(90,"label"),r(91,"Aggiornato il:"),e(),i(92,"span"),r(93),y(94,"date"),e()()()()()()}if(l&2){let t=c();s(9),f("ngModel",t.macroTask.nome),s(4),f("ngModel",t.macroTask.data_scadenza),s(4),m("value",t.taskService.getStatoTesto(t.macroTask.stato)),s(4),f("ngModel",t.macroTask.cliente_id),s(),m("value",null),s(2),m("ngForOf",t.clienti),s(4),f("ngModel",t.macroTask.assegnazione_id),s(),m("value",null),s(13),f("ngModel",t.macroTask.note),s(),m("ngIf",!t.macroTask.id),s(),m("ngIf",t.macroTask.id),s(9),m("ngClass",t.taskService.getStatoBadgeClass(t.macroTask.stato)),s(),u(" ",t.taskService.getStatoTesto(t.macroTask.stato)," "),s(4),m("ngClass",t.taskService.getPrioritaBadgeClass(t.macroTask.priorita_globale)),s(),u(" P",t.macroTask.priorita_globale," "),s(5),A("width",t.macroTask.progresso,"%"),m("ngClass",t.taskService.getStatoBadgeClass(t.macroTask.stato)),s(2),u("",t.macroTask.progresso,"%"),s(5),b(t.getNomeCliente(t.macroTask.cliente_id)),s(5),b(t.taskService.getModuloName(t.macroTask.assegnazione_id||null)),s(4),w("text-danger",t.taskService.isScaduta(t.macroTask.data_scadenza))("text-warning",t.taskService.isScadenzaImminente(t.macroTask.data_scadenza)),s(),u(" ",C(82,28,t.macroTask.data_scadenza,"dd/MM/yyyy")," "),s(6),b(C(88,31,t.macroTask.created_at,"dd/MM/yyyy HH:mm")),s(6),b(C(94,34,t.macroTask.updated_at,"dd/MM/yyyy HH:mm"))}}function Vt(l,a){if(l&1){let t=k();i(0,"div",102),p("click",function(){g(t);let n=c();return _(n.chiudiModal("sottoTask"))}),e()}}function zt(l,a){if(l&1){let t=k();i(0,"div",103)(1,"div",104)(2,"div",105)(3,"div",106)(4,"h5",107)(5,"i",5),r(6,"layers"),e(),r(7," Nuova Sotto Task "),e(),i(8,"button",108),p("click",function(){g(t);let n=c();return _(n.chiudiModal("sottoTask"))}),e()(),i(9,"div",109)(10,"div",30)(11,"label",110),r(12,"Nome *"),e(),i(13,"input",111),S("ngModelChange",function(n){g(t);let d=c();return T(d.nuovaSottoTask.nome,n)||(d.nuovaSottoTask.nome=n),_(n)}),e()(),i(14,"div",30)(15,"label",112),r(16,"Priorit\xE0"),e(),i(17,"select",113),S("ngModelChange",function(n){g(t);let d=c();return T(d.nuovaSottoTask.priorita,n)||(d.nuovaSottoTask.priorita=n),_(n)}),i(18,"option",37),r(19,"1 - Minima"),e(),i(20,"option",37),r(21,"2 - Bassa"),e(),i(22,"option",37),r(23,"3 - Media"),e(),i(24,"option",37),r(25,"4 - Alta"),e(),i(26,"option",37),r(27,"5 - Critica"),e()()()(),i(28,"div",114)(29,"button",115),p("click",function(){g(t);let n=c();return _(n.chiudiModal("sottoTask"))}),r(30,"Annulla"),e(),i(31,"button",116),p("click",function(){g(t);let n=c();return _(n.creaSottoTask())}),r(32,"Crea"),e()()()()()}if(l&2){let t=c();s(13),f("ngModel",t.nuovaSottoTask.nome),s(4),f("ngModel",t.nuovaSottoTask.priorita),s(),m("value",1),s(2),m("value",2),s(2),m("value",3),s(2),m("value",4),s(2),m("value",5)}}function Pt(l,a){if(l&1){let t=k();i(0,"div",102),p("click",function(){g(t);let n=c();return _(n.chiudiModal("modificaSottoTask"))}),e()}}function It(l,a){if(l&1){let t=k();i(0,"div",103)(1,"div",104)(2,"div",105)(3,"div",106)(4,"h5",107)(5,"i",5),r(6,"edit"),e(),r(7," Modifica Sotto Task "),e(),i(8,"button",108),p("click",function(){g(t);let n=c();return _(n.chiudiModal("modificaSottoTask"))}),e()(),i(9,"div",109)(10,"div",30)(11,"label",117),r(12,"Nome *"),e(),i(13,"input",118),S("ngModelChange",function(n){g(t);let d=c();return T(d.sottoTaskModificata.nome,n)||(d.sottoTaskModificata.nome=n),_(n)}),e()(),i(14,"div",30)(15,"label",119),r(16,"Priorit\xE0"),e(),i(17,"select",120),S("ngModelChange",function(n){g(t);let d=c();return T(d.sottoTaskModificata.priorita,n)||(d.sottoTaskModificata.priorita=n),_(n)}),i(18,"option",121),r(19,"1 - Minima"),e(),i(20,"option",122),r(21,"2 - Bassa"),e(),i(22,"option",123),r(23,"3 - Media"),e(),i(24,"option",124),r(25,"4 - Alta"),e(),i(26,"option",125),r(27,"5 - Critica"),e()()(),i(28,"div",30)(29,"label",126),r(30,"Stato"),e(),i(31,"select",127),S("ngModelChange",function(n){g(t);let d=c();return T(d.sottoTaskModificata.stato,n)||(d.sottoTaskModificata.stato=n),_(n)}),i(32,"option",128),r(33,"Da Fare"),e(),i(34,"option",129),r(35,"In Lavorazione"),e(),i(36,"option",130),r(37,"Completato"),e()()()(),i(38,"div",114)(39,"button",115),p("click",function(){g(t);let n=c();return _(n.chiudiModal("modificaSottoTask"))}),r(40,"Annulla"),e(),i(41,"button",116),p("click",function(){g(t);let n=c();return _(n.salvaModificaSottoTask())}),r(42,"Salva Modifiche"),e()()()()()}if(l&2){let t=c();s(13),f("ngModel",t.sottoTaskModificata.nome),s(4),f("ngModel",t.sottoTaskModificata.priorita),s(14),f("ngModel",t.sottoTaskModificata.stato)}}function Dt(l,a){if(l&1){let t=k();i(0,"div",102),p("click",function(){g(t);let n=c();return _(n.chiudiModal("dettaglio"))}),e()}}function Ot(l,a){if(l&1){let t=k();i(0,"div",103)(1,"div",104)(2,"div",105)(3,"div",106)(4,"h5",107)(5,"i",5),r(6,"task"),e(),r(7," Nuovo Task di Dettaglio "),e(),i(8,"button",108),p("click",function(){g(t);let n=c();return _(n.chiudiModal("dettaglio"))}),e()(),i(9,"div",109)(10,"div",30)(11,"label",131),r(12,"Nome *"),e(),i(13,"input",132),S("ngModelChange",function(n){g(t);let d=c();return T(d.nuovoDettaglio.nome,n)||(d.nuovoDettaglio.nome=n),_(n)}),e()(),i(14,"div",30)(15,"label",133),r(16,"Descrizione"),e(),i(17,"textarea",134),S("ngModelChange",function(n){g(t);let d=c();return T(d.nuovoDettaglio.descrizione,n)||(d.nuovoDettaglio.descrizione=n),_(n)}),e()(),i(18,"div",30)(19,"label",135),r(20,"Data Scadenza Prevista"),e(),i(21,"input",136),S("ngModelChange",function(n){g(t);let d=c();return T(d.nuovoDettaglio.data_scadenza_prevista,n)||(d.nuovoDettaglio.data_scadenza_prevista=n),_(n)}),e()()(),i(22,"div",114)(23,"button",115),p("click",function(){g(t);let n=c();return _(n.chiudiModal("dettaglio"))}),r(24,"Annulla"),e(),i(25,"button",116),p("click",function(){g(t);let n=c();return _(n.creaTaskDettaglio())}),r(26,"Crea Dettaglio"),e()()()()()}if(l&2){let t=c();s(13),f("ngModel",t.nuovoDettaglio.nome),s(4),f("ngModel",t.nuovoDettaglio.descrizione),s(4),f("ngModel",t.nuovoDettaglio.data_scadenza_prevista)}}function Bt(l,a){if(l&1){let t=k();i(0,"div",102),p("click",function(){g(t);let n=c();return _(n.chiudiTemplateModal())}),e()}}function Wt(l,a){if(l&1&&(i(0,"li")(1,"strong"),r(2),e(),r(3),e()),l&2){let t=a.$implicit;s(2),b(t.nome),s(),u(" - ",t.descrizione," ")}}function Nt(l,a){if(l&1&&(i(0,"ul"),v(1,Wt,4,2,"li",88),e()),l&2){let t=c().$implicit;s(),m("ngForOf",t.task_dettaglio)}}function Ft(l,a){if(l&1&&(i(0,"div",146)(1,"strong"),r(2),e(),r(3),v(4,Nt,2,1,"ul",80),e()),l&2){let t=a.$implicit,o=a.index;s(2),L("",o+1,". ",t.nome),s(),u(" (Priorit\xE0: ",t.priorita,") "),s(),m("ngIf",t.task_dettaglio&&t.task_dettaglio.length>0)}}function At(l,a){if(l&1){let t=k();i(0,"div",103)(1,"div",104)(2,"div",105)(3,"div",106)(4,"h5",107)(5,"i",5),r(6,"content_copy"),e(),r(7," Salva come Template "),e(),i(8,"button",137),p("click",function(){g(t);let n=c();return _(n.chiudiTemplateModal())}),e()(),i(9,"div",109)(10,"div",30)(11,"label",138),r(12,"Nome Template *"),e(),i(13,"input",139),S("ngModelChange",function(n){g(t);let d=c();return T(d.nomeTemplate,n)||(d.nomeTemplate=n),_(n)}),e()(),i(14,"div",30)(15,"label",140),r(16,"Descrizione"),e(),i(17,"textarea",141),S("ngModelChange",function(n){g(t);let d=c();return T(d.descrizioneTemplate,n)||(d.descrizioneTemplate=n),_(n)}),e()(),i(18,"div",30)(19,"label",142),r(20,"Anteprima Struttura"),e(),i(21,"div",143),v(22,Ft,5,4,"div",144),e()()(),i(23,"div",114)(24,"button",115),p("click",function(){g(t);let n=c();return _(n.chiudiTemplateModal())}),r(25,"Annulla"),e(),i(26,"button",145),p("click",function(){g(t);let n=c();return _(n.confermaCreaTemplate())}),i(27,"i",5),r(28,"save"),e(),r(29),e()()()()()}if(l&2){let t=c();s(13),f("ngModel",t.nomeTemplate),s(4),f("ngModel",t.descrizioneTemplate),s(5),m("ngForOf",(t.macroTask==null?null:t.macroTask.sotto_tasks)||I(7,dt)),s(4),m("disabled",!t.nomeTemplate.trim()||t.loading),s(),w("fa-spin",t.loading),s(2),u(" ",t.loading?"Salvataggio...":"Crea Template"," ")}}function Lt(l,a){if(l&1){let t=k();i(0,"div",102),p("click",function(){g(t);let n=c();return _(n.chiudiModal("leggiDettaglio"))}),e()}}function Rt(l,a){if(l&1&&(i(0,"div",30)(1,"label",142),r(2,"Scadenza prevista"),e(),i(3,"div"),r(4),y(5,"date"),e()()),l&2){let t=c().ngIf;s(4),b(C(5,1,t.data_scadenza_prevista,"dd/MM/yyyy"))}}function jt(l,a){if(l&1&&(i(0,"div",30)(1,"label",142),r(2,"Descrizione completa"),e(),i(3,"div",148),r(4),e()()),l&2){let t=c().ngIf;s(4),b(t.descrizione)}}function Ht(l,a){if(l&1&&(V(0),i(1,"div",30)(2,"label",142),r(3,"Nome"),e(),i(4,"div"),r(5),e()(),v(6,Rt,6,4,"div",147)(7,jt,5,1,"div",147),z()),l&2){let t=a.ngIf;s(5),b(t.nome),s(),m("ngIf",t.data_scadenza_prevista),s(),m("ngIf",t.descrizione)}}function qt(l,a){if(l&1){let t=k();i(0,"div",103)(1,"div",104)(2,"div",105)(3,"div",106)(4,"h5",107)(5,"i",5),r(6,"description"),e(),r(7," Dettaglio "),e(),i(8,"button",108),p("click",function(){g(t);let n=c();return _(n.chiudiModal("leggiDettaglio"))}),e()(),i(9,"div",109),v(10,Ht,8,3,"ng-container",80),e(),i(11,"div",114)(12,"button",115),p("click",function(){g(t);let n=c();return _(n.chiudiModal("leggiDettaglio"))}),r(13,"Chiudi"),e()()()()()}if(l&2){let t=c();s(10),m("ngIf",t.selectedDettaglioView)}}var ot=class l{constructor(a,t,o,n){this.router=a;this.route=t;this.taskService=o;this.soggettiService=n}macroTask=null;clienti=[];loading=!1;error="";activeDropdownId=null;selectedDettaglioView=null;modals={sottoTask:!1,dettaglio:!1,modificaSottoTask:!1,leggiDettaglio:!1};sottoTaskStati=["da_fare","in_lavorazione","completato"];showTemplateModal=!1;nomeTemplate="";descrizioneTemplate="";nuovaSottoTask={nome:"",priorita:3,macro_task_id:""};nuovoDettaglio={nome:"",descrizione:"",data_scadenza_prevista:new Date().toISOString().split("T")[0],sotto_task_id:""};sottoTaskModificata={};sottoTaskDaModificare=null;selectedSottoTask=null;sottoTaskEspanse=new Set;espandiTutti=!1;ngOnInit(){return h(this,null,function*(){let a=this.route.snapshot.paramMap.get("id");a==="nuova"?this.inizializzaNuovaTask():a?yield this.caricaTask(a):this.inizializzaNuovaTask(),yield this.caricaDatiSupporto()})}inizializzaNuovaTask(){this.macroTask={id:"",nome:"",data_scadenza:new Date().toISOString().split("T")[0],cliente_id:"",assegnazione_id:null,note:"",stato:"da_fare",priorita_globale:1,progresso:0,created_at:"",updated_at:"",sotto_tasks:[],extra_data:{}}}caricaTask(a){return h(this,null,function*(){this.loading=!0;try{let t=yield this.taskService.getMacroTaskById(a);t.error?this.error="Errore: "+t.error.message:(this.macroTask=t.data,this.macroTask?.sotto_tasks&&this.macroTask.sotto_tasks.forEach(o=>{o.task_dettaglio&&o.task_dettaglio.length>0&&this.sottoTaskEspanse.add(o.id)}))}catch(t){this.error="Errore: "+t.message}finally{this.loading=!1}})}caricaDatiSupporto(){return h(this,null,function*(){try{let a=yield this.soggettiService.getSoggettiByTipo("cliente");this.clienti=a.data||[]}catch(a){console.error("Errore caricamento clienti:",a)}})}apriModal(a,t){if(this.modals[a]=!0,a==="sottoTask"){let o=this.macroTask?.id;o&&(this.nuovaSottoTask.macro_task_id=o)}a==="dettaglio"&&t&&(this.selectedSottoTask=t,this.nuovoDettaglio.sotto_task_id=t.id),a==="modificaSottoTask"&&t&&(this.sottoTaskDaModificare=t,this.sottoTaskModificata=D({},t))}chiudiModal(a){this.modals[a]=!1,a==="sottoTask"&&(this.nuovaSottoTask={nome:"",priorita:3,macro_task_id:""}),a==="dettaglio"&&(this.nuovoDettaglio={nome:"",descrizione:"",data_scadenza_prevista:new Date().toISOString().split("T")[0],sotto_task_id:""}),a==="modificaSottoTask"&&(this.sottoTaskDaModificare=null,this.sottoTaskModificata={}),a==="leggiDettaglio"&&(this.selectedDettaglioView=null)}salvaMacroTask(){return h(this,null,function*(){if(!(!this.macroTask||!this.validazioneTask())){this.loading=!0,this.error="";try{let t;if(this.macroTask.id){let a=this.macroTask,{cliente:o,sotto_tasks:n}=a,d=O(a,["cliente","sotto_tasks"]),x={nome:d.nome,data_scadenza:d.data_scadenza,note:d.note||"",stato:d.stato,priorita_globale:d.priorita_globale,progresso:d.progresso};d.cliente_id&&this.isValidUUID(d.cliente_id)&&(x.cliente_id=d.cliente_id),d.assegnazione_id&&(x.assegnazione_id=d.assegnazione_id),t=yield this.taskService.updateMacroTask(this.macroTask.id,x)}else{let o={nome:this.macroTask.nome,data_scadenza:this.macroTask.data_scadenza,note:this.macroTask.note||"",stato:"da_fare"};this.macroTask.cliente_id&&this.isValidUUID(this.macroTask.cliente_id)&&(o.cliente_id=this.macroTask.cliente_id),this.macroTask.assegnazione_id&&(o.assegnazione_id=this.macroTask.assegnazione_id),t=yield this.taskService.createMacroTask(o)}t.error?this.error="Errore: "+t.error.message:this.router.navigate(["/task"])}catch(t){this.error="Errore: "+t.message}finally{this.loading=!1}}})}isValidUUID(a){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}validazioneTask(){return this.macroTask.nome.trim()?this.macroTask.assegnazione_id?!0:(this.error="Seleziona un modulo per assegnare la task",!1):(this.error="Il nome della task \xE8 obbligatorio",!1)}creaSottoTask(){return h(this,null,function*(){if(!this.nuovaSottoTask.nome.trim()){this.error="Il nome della sotto-task \xE8 obbligatorio";return}try{let a=yield this.taskService.createSottoTask(this.nuovaSottoTask);a.error?this.error="Errore: "+a.error.message:yield this.aggiornaTask(),this.chiudiModal("sottoTask")}catch(a){this.error="Errore: "+a.message}})}creaTaskDettaglio(){return h(this,null,function*(){if(!this.nuovoDettaglio.nome.trim()){this.error="Il nome del dettaglio \xE8 obbligatorio";return}try{let a=yield this.taskService.createTaskDettaglio(this.nuovoDettaglio);a.error?this.error="Errore: "+a.error.message:yield this.aggiornaTask(),this.chiudiModal("dettaglio")}catch(a){this.error="Errore: "+a.message}})}salvaModificaSottoTask(){return h(this,null,function*(){if(!this.sottoTaskDaModificare||!this.sottoTaskModificata.nome?.trim()){this.error="Il nome della sotto-task \xE8 obbligatorio";return}try{let a=yield this.taskService.updateSottoTask(this.sottoTaskDaModificare.id,this.sottoTaskModificata);a.error?this.error="Errore: "+a.error.message:yield this.aggiornaTask(),this.chiudiModal("modificaSottoTask")}catch(a){this.error="Errore: "+a.message}})}toggleDettaglioCompletato(a,t){return h(this,null,function*(){try{(yield this.taskService.toggleTaskDettaglioCompletato(a.id,!a.completato)).error||(a.completato=!a.completato,a.data_completamento=a.completato?new Date().toISOString():null,yield this.aggiornaStatoSottoTaskAutomatico(t),yield this.aggiornaTask())}catch(o){this.error="Errore: "+o.message}})}aggiornaStatoSottoTaskAutomatico(a){return h(this,null,function*(){if(!a.task_dettaglio?.length)return;let t=a.task_dettaglio.every(d=>d.completato),o=a.task_dettaglio.every(d=>!d.completato),n=a.stato;t?n="completato":o?n="da_fare":n="in_lavorazione",n!==a.stato&&(yield this.taskService.updateSottoTask(a.id,{stato:n}))})}aggiornaTask(){return h(this,null,function*(){let a=this.macroTask?.id;a&&(yield this.caricaTask(a))})}toggleDropdown(a,t){t?.stopPropagation(),this.activeDropdownId=this.activeDropdownId===a?null:a}isDropdownOpen(a){return this.activeDropdownId===a}closeDropdown(){this.activeDropdownId=null}puoiModificareSottoTask(a){return!a.task_dettaglio||a.task_dettaglio.length===0}getNomeCliente(a){return this.clienti.find(t=>t.id===a)?.ragione_sociale||"Non assegnato"}trackBySottoTask(a,t){return t.id}trackByDettaglio(a,t){return t.id}eliminaMacroTask(){return h(this,null,function*(){let a=this.macroTask?.id;if(!(!a||!confirm("Sei sicuro di voler eliminare questa macro task e tutti i contenuti collegati?"))){this.loading=!0,this.error="";try{let o=yield this.taskService.deleteMacroTaskCascade(a);if(o.error){this.error="Errore eliminazione: "+o.error.message;return}this.router.navigate(["/task"])}catch(o){this.error="Errore: "+o.message}finally{this.loading=!1}}})}eliminaDettaglio(a,t){return h(this,null,function*(){if(confirm("Sei sicuro di eliminare questo dettaglio?"))try{let o=yield this.taskService.deleteTaskDettaglio(a.id);if(o.error){this.error="Errore: "+o.error.message;return}t.task_dettaglio&&(t.task_dettaglio=t.task_dettaglio.filter(d=>d.id!==a.id)),yield this.aggiornaStatoSottoTaskAutomatico(t);let n=this.macroTask?.id;n&&(yield this.caricaTask(n))}catch(o){this.error="Errore: "+o.message}})}cambiaStatoSottoTask(a,t){return h(this,null,function*(){if(!this.puoiModificareSottoTask(a)){this.error="Impossibile modificare lo stato: questa sotto-task ha dettagli e lo stato viene gestito automaticamente";return}try{let o=yield this.taskService.updateSottoTask(a.id,{stato:t});o.error?this.error="Errore: "+o.error.message:(a.stato=t,this.macroTask&&(yield this.caricaTask(this.macroTask.id)))}catch(o){this.error="Errore: "+o.message}})}getPrioritaBadgeClass(a){return this.taskService.getPrioritaBadgeClass(a)}getStatoBadgeClass(a){return this.taskService.getStatoBadgeClass(a)}getStatoTesto(a){return this.taskService.getStatoTesto(a)}getModuloName(a){return this.taskService.getModuloName(a.assegnazione_id||null)}isScaduta(a){return this.taskService.isScaduta(a)}isScadenzaImminente(a){return this.taskService.isScadenzaImminente(a)}salvaComeTemplate(){if(!this.macroTask){this.error="Nessuna task da salvare come template";return}this.nomeTemplate=this.macroTask.nome+" - Template",this.descrizioneTemplate=this.macroTask.note||"",this.showTemplateModal=!0}chiudiTemplateModal(){this.showTemplateModal=!1,this.nomeTemplate="",this.descrizioneTemplate=""}confermaCreaTemplate(){return h(this,null,function*(){if(!this.macroTask||!this.nomeTemplate.trim()){this.error="Il nome del template \xE8 obbligatorio";return}this.loading=!0;try{let a={sotto_tasks:[]};if(this.macroTask.sotto_tasks)for(let n of this.macroTask.sotto_tasks){let d={nome:n.nome,priorita:n.priorita,task_dettaglio:[]};if(n.task_dettaglio)for(let x of n.task_dettaglio){let rt=this.calcolaOffsetGiorni(x.data_scadenza_prevista,this.macroTask.created_at),st={nome:x.nome,descrizione:x.descrizione||"",data_scadenza_prevista_offset:rt};d.task_dettaglio.push(st)}a.sotto_tasks.push(d)}let t={nome:this.nomeTemplate,descrizione:this.descrizioneTemplate||null,modulo:this.macroTask.assegnazione_id||"immagine",priorita_globale:this.macroTask.priorita_globale,data_scadenza_default:30,struttura_template:a},o=yield this.taskService.createMacroTaskTemplate(t);o.error?this.error="Errore nel salvataggio del template: "+o.error.message:(this.chiudiTemplateModal(),alert("Template salvato con successo!"))}catch(a){this.error="Errore: "+a.message}finally{this.loading=!1}})}calcolaOffsetGiorni(a,t){let o=new Date(a),n=new Date(t),d=o.getTime()-n.getTime();return Math.ceil(d/(1e3*60*60*24))}apriDettaglio(a){this.selectedDettaglioView=a,this.modals.leggiDettaglio=!0}toggleSottoTaskEspansa(a){requestAnimationFrame(()=>{this.sottoTaskEspanse.has(a)?this.sottoTaskEspanse.delete(a):this.sottoTaskEspanse.add(a)})}isSottoTaskEspansa(a){return this.sottoTaskEspanse.has(a)}toggleEspandiTutti(){this.espandiTutti=!this.espandiTutti,requestAnimationFrame(()=>{this.espandiTutti&&this.macroTask?.sotto_tasks?this.macroTask.sotto_tasks.forEach(a=>{this.sottoTaskEspanse.add(a.id)}):this.sottoTaskEspanse.clear()})}static \u0275fac=function(t){return new(t||l)(M(K),M(J),M(nt),M(at))};static \u0275cmp=W({type:l,selectors:[["app-task-singola"]],hostBindings:function(t,o){t&1&&p("click",function(){return o.closeDropdown()},B)},decls:27,vars:16,consts:[["tplNessunaSottoTask",""],[1,"task-detail-container"],[1,"form-section"],[1,"section-header"],[1,"promethea-button","secondary",3,"click"],[1,"material-icons"],[1,"section-titles"],[1,"section-title"],[1,"material-icons",2,"font-size","var(--fs-lg)"],["class","actions-container",4,"ngIf"],["class","header-footer",4,"ngIf"],["class","status-message loading",4,"ngIf"],["class","status-message error",4,"ngIf"],["class","task-content marcotaskform",4,"ngIf"],["class","modal-backdrop show",3,"click",4,"ngIf"],["class","modal show d-block","tabindex","-1",4,"ngIf"],[1,"actions-container"],[1,"promethea-button","outline",3,"click","disabled"],[1,"promethea-button",3,"click","disabled"],[1,"header-footer"],[1,"text-muted"],[1,"status-message","loading"],["role","status",1,"loading-spinner"],[1,"status-message","error"],[1,"task-content","marcotaskform"],[1,"main-section"],[1,"grid-form"],[1,"form-field","full-width"],["for","nome",1,"form-label"],["type","text","id","nome","placeholder","Inserisci il nome della task",3,"ngModelChange","ngModel"],[1,"form-field"],["for","data_scadenza",1,"form-label"],["type","date","id","data_scadenza",3,"ngModelChange","ngModel"],["for","stato",1,"form-label"],["type","text","id","stato","disabled","",3,"value"],["for","cliente_id",1,"form-label"],["id","cliente_id",3,"ngModelChange","ngModel"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["for","assegnazione_id",1,"form-label"],["id","assegnazione_id","required","",3,"ngModelChange","ngModel"],["value","immagine"],["value","digitalizzazione"],["value","contabilita"],["value","ottimizzazione"],["for","note",1,"form-label"],["id","note","rows","4","placeholder","Aggiungi note o descrizione...",3,"ngModelChange","ngModel"],["class","form-actions",4,"ngIf"],["class","form-section",4,"ngIf"],[1,"form-section","riepilogo"],[1,"card","info-card"],[1,"info-grid"],[1,"info-item"],[1,"badge",3,"ngClass"],[1,"progress","flex-1"],[1,"progress-bar",3,"ngClass"],[1,"progress-text"],[1,"form-actions"],[1,"badge","primary"],[1,"sotto-task-global-actions"],[1,"promethea-button","outline",3,"click","title"],[1,"promethea-button","outline",3,"click"],["class","contenitore-sottotask",4,"ngIf","ngIfElse"],[1,"empty-state"],[1,"contenitore-sottotask"],["class","card sotto-task-card",3,"expanded",4,"ngFor","ngForOf","ngForTrackBy"],[1,"card","sotto-task-card"],[1,"sotto-task-header",3,"click"],[1,"sotto-task-info"],[1,"icon-btn","expand",3,"click","title"],[1,"sotto-task-content"],[1,"sotto-task-title"],[1,"sotto-task-meta"],[1,"badge"],["class","dettaglio-counter",4,"ngIf"],[1,"sotto-task-actions",3,"click"],["title","Modifica sotto-task",1,"icon-btn",3,"click"],[1,"dropdown"],["type","button","aria-label","Azioni sotto-task",1,"icon-btn",3,"click"],[1,"dropdown-menu",3,"click"],[4,"ngIf"],[1,"dropdown-item",3,"click"],["class","icon-btn","style","cursor: auto;","title","Stato gestito automaticamente dai dettagli",4,"ngIf"],[1,"dettaglio-container"],["class","dettaglio-list",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"dettaglio-counter"],[1,"dropdown-header"],[4,"ngFor","ngForOf"],[1,"dropdown-divider"],["title","Stato gestito automaticamente dai dettagli",1,"icon-btn",2,"cursor","auto"],[1,"dettaglio-list"],["class","dettaglio-item",4,"ngFor","ngForOf","ngForTrackBy"],[1,"dettaglio-item"],[1,"dettaglio-content"],["type","checkbox",3,"change","checked"],[1,"dettaglio-info"],[1,"dettaglio-header"],["title","Elimina dettaglio",1,"icon-btn","danger",3,"click"],["class","dettaglio-descrizione text-muted","title","Clicca per leggere tutto",3,"click",4,"ngIf"],["title","Clicca per leggere tutto",1,"dettaglio-descrizione","text-muted",3,"click"],[3,"click"],[1,"modal-backdrop","show",3,"click"],["tabindex","-1",1,"modal","show","d-block"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Chiudi",1,"icon-btn","close",3,"click"],[1,"modal-body"],["for","stNome",1,"form-label"],["id","stNome","type","text","placeholder","Inserisci nome sotto-task",3,"ngModelChange","ngModel"],["for","stPriorita",1,"form-label"],["id","stPriorita",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button",1,"promethea-button","secondary",3,"click"],["type","button",1,"promethea-button",3,"click"],["for","modificaNome",1,"form-label"],["type","text","id","modificaNome","placeholder","Inserisci il nome della sotto task",3,"ngModelChange","ngModel"],["for","modificaPriorita",1,"form-label"],["id","modificaPriorita",3,"ngModelChange","ngModel"],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],["for","modificaStato",1,"form-label"],["id","modificaStato",3,"ngModelChange","ngModel"],["value","da_fare"],["value","in_lavorazione"],["value","completato"],["for","dettaglioNome",1,"form-label"],["type","text","id","dettaglioNome","placeholder","Inserisci il nome del dettaglio",3,"ngModelChange","ngModel"],["for","dettaglioDescrizione",1,"form-label"],["id","dettaglioDescrizione","rows","3","placeholder","Aggiungi una descrizione...",3,"ngModelChange","ngModel"],["for","dettaglioScadenza",1,"form-label"],["type","date","id","dettaglioScadenza",3,"ngModelChange","ngModel"],["type","button",1,"icon-btn",3,"click"],["for","nomeTemplate",1,"form-label"],["type","text","id","nomeTemplate","placeholder","Inserisci un nome per il template",3,"ngModelChange","ngModel"],["for","descrizioneTemplate",1,"form-label"],["id","descrizioneTemplate","rows","3","placeholder","Aggiungi una descrizione...",3,"ngModelChange","ngModel"],[1,"form-label"],[1,"template-preview"],["class","sotto-task-preview",4,"ngFor","ngForOf"],["type","button",1,"promethea-button",3,"click","disabled"],[1,"sotto-task-preview"],["class","form-field",4,"ngIf"],[2,"white-space","pre-wrap"]],template:function(t,o){t&1&&(i(0,"div",1)(1,"div",2)(2,"div",3)(3,"button",4),p("click",function(){return o.router.navigate(["/task"])}),i(4,"i",5),r(5,"arrow_back"),e(),r(6," Torna alla Lista "),e(),i(7,"div",6)(8,"h1",7)(9,"i",8),r(10,"task"),e(),r(11),e()(),v(12,ct,13,6,"div",9),e(),v(13,mt,3,1,"div",10),e(),v(14,gt,4,0,"div",11)(15,_t,4,1,"div",12)(16,Et,95,37,"div",13)(17,Vt,1,0,"div",14)(18,zt,33,7,"div",15)(19,Pt,1,0,"div",14)(20,It,43,3,"div",15)(21,Dt,1,0,"div",14)(22,Ot,27,3,"div",15)(23,Bt,1,0,"div",14)(24,At,30,8,"div",15)(25,Lt,1,0,"div",14)(26,qt,14,1,"div",15),e()),t&2&&(s(11),u(" ",o.macroTask!=null&&o.macroTask.id?"Modifica Task":"Nuova Macro Task"," "),s(),m("ngIf",o.macroTask==null?null:o.macroTask.id),s(),m("ngIf",o.macroTask==null?null:o.macroTask.id),s(),m("ngIf",o.loading&&!o.macroTask),s(),m("ngIf",o.error),s(),m("ngIf",o.macroTask),s(),m("ngIf",o.modals.sottoTask),s(),m("ngIf",o.modals.sottoTask),s(),m("ngIf",o.modals.modificaSottoTask),s(),m("ngIf",o.modals.modificaSottoTask),s(),m("ngIf",o.modals.dettaglio),s(),m("ngIf",o.modals.dettaglio),s(),m("ngIf",o.showTemplateModal),s(),m("ngIf",o.showTemplateModal),s(),m("ngIf",o.modals.leggiDettaglio),s(),m("ngIf",o.modals.leggiDettaglio))},dependencies:[G,j,H,q,it,$,tt,Q,Z,X,et,Y,U],styles:[".task-detail-container[_ngcontent-%COMP%]{padding:var(--gutter-lg);background:var(--background);min-height:100vh}.task-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:minmax(0,1fr) minmax(260px,350px);gap:var(--gutter-lg);align-items:flex-start}.main-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gutter-md);min-width:0}.task-card[_ngcontent-%COMP%]{border-left:4px solid var(--primary);display:flex;flex-direction:column;height:100%}.task-card.scaduta[_ngcontent-%COMP%]{border-left-color:#ef4444;background:linear-gradient(135deg,var(--background) 0%,color-mix(in srgb,#ef4444 8%,transparent) 100%)}.task-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:var(--gutter-sm);margin-bottom:var(--gutter-sm);flex-wrap:wrap}.task-main-info[_ngcontent-%COMP%]{flex:1;min-width:0}.task-title[_ngcontent-%COMP%]{cursor:pointer;margin-bottom:var(--gutter-sm)}.task-meta-compact[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.meta-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);color:color-mix(in srgb,var(--text-color) 60%,transparent)}.task-header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);flex-shrink:0;margin-left:auto}.priority-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;min-width:5rem;height:var(--fs-md);padding:0 var(--gutter-sm);border-radius:6px;font-weight:700;border:1px solid var(--smoke-color-1);background:color-mix(in srgb,var(--text-color) 10%,transparent);text-transform:uppercase;letter-spacing:.5px}.progress-section[_ngcontent-%COMP%]{margin:var(--gutter-sm) 0}.progress-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm)}.progress-stats[_ngcontent-%COMP%]{flex-shrink:0}.scadenza-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);padding:var(--gutter-sm);background:var(--smoke-color-2);border-radius:8px;margin:var(--gutter-sm) 0;border:1px solid var(--smoke-color-1)}.scadenza-section.scaduta[_ngcontent-%COMP%]{background:color-mix(in srgb,#ef4444 12%,transparent);border-color:color-mix(in srgb,#ef4444 30%,transparent)}.scadenza-section.scadenza-imminente[_ngcontent-%COMP%]{background:color-mix(in srgb,#f59e0b 12%,transparent);border-color:color-mix(in srgb,#f59e0b 30%,transparent)}.sotto-tasks-counts[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:var(--gutter-sm);margin:var(--gutter-sm) 0}.count-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:var(--gutter-sm);background:var(--smoke-color-2);border-radius:8px;border:1px solid var(--smoke-color-1)}.count-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:var(--fs-md);height:var(--fs-md);padding:var(--gutter-sm);border-radius:50%;font-weight:700;color:#fff}.count-badge.da-fare[_ngcontent-%COMP%]{background:#6b7280}.count-badge.in-lavorazione[_ngcontent-%COMP%]{background:var(--secondary)}.count-badge.completate[_ngcontent-%COMP%]{background:#10b981}.count-label[_ngcontent-%COMP%]{margin-top:4px;text-align:center;color:color-mix(in srgb,var(--text-color) 70%,transparent);text-transform:uppercase;letter-spacing:.5px}.task-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:var(--gutter-sm);border-top:1px solid var(--smoke-color-1);margin-top:auto}.sotto-task-card[_ngcontent-%COMP%]{padding:var(--gutter-md);border-left:3px solid var(--primary);transition:all .3s cubic-bezier(.2,.9,.2,1);overflow:visible;position:relative}.sotto-task-card.expanded[_ngcontent-%COMP%]{box-shadow:0 8px 24px var(--shadow2);border-color:var(--primary)}.sotto-task-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:var(--gutter-sm);margin-bottom:var(--gutter-sm);flex-wrap:wrap;cursor:pointer}.sotto-task-info[_ngcontent-%COMP%]{flex:1 1 320px;min-width:0;display:flex;align-items:flex-start;gap:var(--gutter-sm)}.sotto-task-content[_ngcontent-%COMP%]{flex:1;min-width:0}.sotto-task-meta[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-sm);align-items:center;flex-wrap:wrap;margin-top:.25rem}.sotto-task-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);margin-left:auto;flex:1 1 260px;justify-content:flex-end;flex-wrap:wrap;min-width:0;max-width:100%;position:relative;z-index:2}.dettaglio-container[_ngcontent-%COMP%]{max-height:0;overflow:hidden;opacity:0;transition:max-height .5s cubic-bezier(.4,0,.2,1),opacity .3s ease .1s}.dettaglio-container.show[_ngcontent-%COMP%]{max-height:5000px;opacity:1;transition:max-height .8s cubic-bezier(.4,0,.2,1),opacity .4s ease .1s}.dettaglio-list[_ngcontent-%COMP%]{border-top:1px solid var(--smoke-color-1);padding-top:var(--gutter-sm);display:flex;flex-direction:column;gap:var(--gutter-sm)}.dettaglio-item[_ngcontent-%COMP%]{padding:var(--gutter-sm);background:var(--background);border-radius:10px;border:1px solid var(--smoke-color-1);transition:all .2s ease}.dettaglio-item[_ngcontent-%COMP%]:hover{border-color:var(--primary);background:var(--smoke-color-2)}.dettaglio-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr;align-items:start;column-gap:var(--gutter-sm);align-items:center;justify-content:center}.dettaglio-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:minmax(0,1fr) auto auto;align-items:center;gap:var(--gutter-sm)}.dettaglio-header[_ngcontent-%COMP%]   strong.completed[_ngcontent-%COMP%]{text-decoration:line-through;color:color-mix(in srgb,var(--text-color) 50%,transparent)}.dettaglio-counter[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;font-size:.75rem;color:color-mix(in srgb,var(--text-color) 60%,transparent);background:var(--smoke-color-2);padding:.125rem .5rem;border-radius:12px;border:1px solid var(--smoke-color-1)}.sotto-task-card[_ngcontent-%COMP%]:not(.expanded)   .dettaglio-counter[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--primary) 15%,transparent);color:var(--primary);border-color:color-mix(in srgb,var(--primary) 30%,transparent)}.form-section.riepilogo[_ngcontent-%COMP%]{padding:0;background:transparent;border:none;box-shadow:none;align-self:flex-start;position:sticky;top:var(--gutter-lg)}.contenitore-sottotask[_ngcontent-%COMP%]{gap:var(--gutter-md);display:flex;flex-direction:column}.sotto-task-global-actions[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-sm);align-items:center;margin-left:auto}.marcotaskform[_ngcontent-%COMP%]{margin-top:var(--gutter-lg)!important}.info-card[_ngcontent-%COMP%]{background:var(--background);border:1px solid var(--smoke-color-1);border-radius:16px;padding:var(--gutter-lg);box-shadow:0 4px 12px var(--shadow);position:sticky;top:var(--gutter-lg);z-index:10}.info-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--text-color);margin-bottom:var(--gutter-sm);font-weight:600;border-bottom:2px solid var(--primary);padding-bottom:var(--gutter-sm)}.info-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:var(--gutter-sm);padding:var(--gutter-sm) 0;border-bottom:1px solid color-mix(in srgb,var(--text-color) 15%,transparent)}.info-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.info-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:var(--text-color);margin:0}.info-item[_ngcontent-%COMP%]   span.scaduta[_ngcontent-%COMP%]{color:#e74c3c;font-weight:500}.info-item[_ngcontent-%COMP%]   span.imminente[_ngcontent-%COMP%]{color:#f39c12;font-weight:500}.form-section.riepilogo[_ngcontent-%COMP%]{padding:0;background:transparent;border:none;box-shadow:none;align-self:flex-start;position:sticky;top:var(--gutter-lg);z-index:10}.sotto-task-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);margin-left:auto;flex:1 1 260px;justify-content:flex-end;flex-wrap:wrap;min-width:0;max-width:100%}.sotto-task-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%], .sotto-task-actions[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]{flex:0 0 auto}.dropdown[_ngcontent-%COMP%]{position:relative;display:inline-block}.dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;z-index:1000;display:none;min-width:180px;padding:8px 0;margin:4px 0 0;background:var(--background);border:1px solid var(--smoke-color-1);border-radius:8px;box-shadow:0 4px 12px var(--shadow);list-style:none;z-index:10000}.dropdown-menu.show[_ngcontent-%COMP%]{display:block}.dropdown-header[_ngcontent-%COMP%]{padding:var(--gutter-sm);font-weight:800;background:color-mix(in srgb,var(--text-color) 10%,transparent);text-transform:uppercase;border-bottom:1px solid color-mix(in srgb,var(--text-color) 30%,transparent)}.dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;width:100%;padding:8px 16px;background:transparent;border:none;color:var(--text-color);text-align:left;text-decoration:none;cursor:pointer;transition:all .2s ease;font-size:.85em}.dropdown-item[_ngcontent-%COMP%]:hover{background:var(--smoke-color-2);color:var(--primary)}.dropdown-divider[_ngcontent-%COMP%]{height:1px;background:var(--smoke-color-1);margin:8px 0;border:none}@media (max-width: 1024px){.task-content[_ngcontent-%COMP%]{grid-template-columns:1fr}.form-section.riepilogo[_ngcontent-%COMP%]{position:static;order:-1}}@media (max-width: 768px){.sotto-task-header[_ngcontent-%COMP%], .task-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.sotto-task-actions[_ngcontent-%COMP%], .task-header-actions[_ngcontent-%COMP%]{margin-left:0;justify-content:flex-start}.dettaglio-header[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:var(--gutter-sm)}.sotto-tasks-counts[_ngcontent-%COMP%]{grid-template-columns:1fr}.sotto-task-global-actions[_ngcontent-%COMP%]{flex-direction:column;width:100%;margin-top:var(--gutter-sm)}}"]})};export{ot as TaskSingola};
