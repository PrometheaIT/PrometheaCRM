import{a as ve}from"./chunk-Y5JPG2CL.js";import{a as re,b as le,d as se,f as ce,h as me,n as de,o as pe,p as ue,q as ze,r as _e,u as ge}from"./chunk-Z6GIDEG7.js";import{b as fe}from"./chunk-H4JMM7IJ.js";import"./chunk-XDKKMB7K.js";import{b as ae}from"./chunk-WPZ527DH.js";import{c as Y,d as K,e as X,g as Z,h as ee,i as te,j as ie,m as ne,o as oe}from"./chunk-PJ4DYJTI.js";import{Aa as O,Ab as J,Bb as Q,Ga as G,La as x,Wa as d,X as z,Xa as i,Y as _,Ya as n,Za as $,bb as q,cb as U,db as b,gb as f,hb as m,ib as j,kb as C,mb as a,nb as v,ob as y,pb as k,qb as E,rb as I,sb as P,ua as s,wb as H,yb as R,zb as W}from"./chunk-R5VHGKSY.js";import"./chunk-X5YLR3NI.js";import{a as L,i as w}from"./chunk-ODN5LVDJ.js";var Ce=(l,t)=>({"user-message":l,"assistance-message":t});function Se(l,t){l&1&&(i(0,"div",22),$(1,"span",23),a(2," Ricerca in corso... "),n())}function be(l,t){if(l&1&&(i(0,"div",24),a(1),n()),l&2){let e=m(2);s(),v(e.searchError)}}function ye(l,t){if(l&1){let e=b();i(0,"div",27),f("click",function(){let r=z(e).$implicit,c=m(3);return _(c.onSelectProspect(r))}),i(1,"div",28)(2,"div",29)(3,"strong"),a(4),n()(),i(5,"div",30),a(6),n()(),i(7,"div",31),a(8,"\u2795"),n()()}if(l&2){let e=t.$implicit;s(4),v(e.ragione_sociale),s(2),k(" ",e.email||"\u2014"," \u2022 ",e.telefono||"\u2014"," ")}}function Ae(l,t){if(l&1&&(i(0,"div",25),x(1,ye,9,3,"div",26),R(2,"slice"),n()),l&2){let e=m(2);s(),d("ngForOf",J(2,1,e.searchResults,0,8))}}function Ee(l,t){if(l&1&&(i(0,"div",32)(1,"i",33),a(2,"check_circle"),n(),a(3," Selezionato: "),i(4,"strong"),a(5),n()()),l&2){let e=m(2);s(5),v(e.selectedProspect.ragione_sociale)}}function Ie(l,t){l&1&&(i(0,"div",34)(1,"i",33),a(2,"history"),n(),a(3," Modifica configurazione esistente: le variazioni saranno tracciate in storico. "),n())}function Pe(l,t){if(l&1){let e=b();i(0,"section",6)(1,"div",7)(2,"i",8),a(3,"person_search"),n(),i(4,"div",9)(5,"h2",10),a(6,"Seleziona il Prospect"),n()()(),i(7,"div",11)(8,"label",12),a(9,"Cerca Prospect"),n(),i(10,"div",13)(11,"input",14),P("ngModelChange",function(r){z(e);let c=m();return I(c.queryProspect,r)||(c.queryProspect=r),_(r)}),f("input",function(){z(e);let r=m();return _(r.onSearchProspect(r.queryProspect))}),n(),x(12,Se,3,0,"div",15)(13,be,2,1,"div",16)(14,Ae,3,5,"div",17),n(),x(15,Ee,6,1,"div",18)(16,Ie,4,0,"div",19),n(),i(17,"div",20)(18,"button",21),f("click",function(){z(e);let r=m();return _(r.avanti())}),a(19," Inizia Configurazione "),n()()()}if(l&2){let e=m();s(11),E("ngModel",e.queryProspect),s(),d("ngIf",e.searchLoading),s(),d("ngIf",e.searchError),s(),d("ngIf",e.searchResults.length),s(),d("ngIf",e.selectedProspect),s(),d("ngIf",e.isModificaConfigurazione),s(),C("blocked",e.searchResults.length),s(),d("disabled",!e.selectedProspect||e.searchLoading)}}function Me(l,t){if(l&1&&(i(0,"span",49),a(1),n()),l&2){let e=m().$implicit;s(),v(e.pacchetto)}}function we(l,t){if(l&1){let e=b();i(0,"div",43),f("click",function(){let r=z(e).$implicit,c=m(2);return _(c.toggleServizio("immagine_marketing",r))}),i(1,"div",44)(2,"h4"),a(3),n(),i(4,"div",45),a(5),n()(),i(6,"p",46),a(7),n(),x(8,Me,2,1,"span",47),i(9,"div",48)(10,"i",33),a(11,"check"),n()()()}if(l&2){let e=t.$implicit,o=m(2);C("selezionato",e.selezionato)("disabled",o.isServizioDisabled("immagine_marketing",e)),s(3),v(e.nome),s(2),v(o.formatPrezzoServizio(e)),s(2),v(e.descrizione),s(),d("ngIf",e.pacchetto),s(),C("attivo",e.selezionato)}}function Te(l,t){if(l&1){let e=b();i(0,"div",43),f("click",function(){let r=z(e).$implicit,c=m(2);return _(c.toggleServizio("immagine_marketing",r))}),i(1,"div",44)(2,"h4"),a(3),n(),i(4,"div",45),a(5),n()(),i(6,"p",46),a(7),n(),i(8,"div",48)(9,"i",33),a(10,"check"),n()()()}if(l&2){let e=t.$implicit,o=m(2);C("selezionato",e.selezionato),s(3),v(e.nome),s(2),v(o.formatPrezzoServizio(e)),s(2),v(e.descrizione),s(),C("attivo",e.selezionato)}}function Ve(l,t){if(l&1){let e=b();i(0,"section",6)(1,"div",7)(2,"i",8),a(3,"brush"),n(),i(4,"div",9)(5,"h2",10),a(6,"Immagine & Marketing"),n(),i(7,"p",35),a(8,"Configura i servizi di branding e comunicazione"),n()()(),i(9,"h3",36),a(10,"Social Media Manager"),n(),i(11,"div",37),x(12,we,12,10,"div",38),n(),i(13,"h3",36),a(14,"Servizi singoli"),n(),i(15,"div",37),x(16,Te,11,7,"div",39),n(),i(17,"div",40)(18,"strong"),a(19),n()(),i(20,"div",20)(21,"button",41),f("click",function(){z(e);let r=m();return _(r.indietro())}),a(22,"Indietro"),n(),i(23,"button",42),f("click",function(){z(e);let r=m();return _(r.avanti())}),a(24,"Continua"),n()()()}if(l&2){let e=m();s(12),d("ngForOf",e.getServiziPacchetto("immagine_marketing")),s(4),d("ngForOf",e.getServiziSingoli("immagine_marketing")),s(3),y("Totale modulo: ",e.moduli.immagine_marketing.totale," \u20AC")}}function ke(l,t){if(l&1&&(i(0,"span",49),a(1),n()),l&2){let e=m().$implicit;s(),v(e.pacchetto)}}function Oe(l,t){if(l&1){let e=b();i(0,"div",43),f("click",function(){let r=z(e).$implicit,c=m(2);return _(c.toggleServizio("digitalizzazione_automatismi",r))}),i(1,"div",44)(2,"h4"),a(3),n(),i(4,"div",45),a(5),n()(),i(6,"p",46),a(7),n(),x(8,ke,2,1,"span",47),i(9,"div",48)(10,"i",33),a(11,"check"),n()()()}if(l&2){let e=t.$implicit,o=m(2);C("selezionato",e.selezionato)("disabled",o.isServizioDisabled("digitalizzazione_automatismi",e)),s(3),v(e.nome),s(2),v(o.formatPrezzoServizio(e)),s(2),v(e.descrizione),s(),d("ngIf",e.pacchetto),s(),C("attivo",e.selezionato)}}function Ne(l,t){if(l&1){let e=b();i(0,"div",43),f("click",function(){let r=z(e).$implicit,c=m(2);return _(c.toggleServizio("digitalizzazione_automatismi",r))}),i(1,"div",44)(2,"h4"),a(3),n(),i(4,"div",45),a(5),n()(),i(6,"p",46),a(7),n(),i(8,"div",48)(9,"i",33),a(10,"check"),n()()()}if(l&2){let e=t.$implicit,o=m(2);C("selezionato",e.selezionato),s(3),v(e.nome),s(2),v(o.formatPrezzoServizio(e)),s(2),v(e.descrizione),s(),C("attivo",e.selezionato)}}function Fe(l,t){if(l&1){let e=b();i(0,"section",6)(1,"div",7)(2,"i",8),a(3,"memory"),n(),i(4,"div",9)(5,"h2",10),a(6,"Digitalizzazione & Automatismi"),n(),i(7,"p",35),a(8,"Configura i servizi digitali e di automazione"),n()()(),i(9,"h3",36),a(10,"Sito"),n(),i(11,"div",37),x(12,Oe,12,10,"div",38),n(),i(13,"h3",36),a(14,"Servizi singoli"),n(),i(15,"div",37),x(16,Ne,11,7,"div",39),n(),i(17,"div",40)(18,"strong"),a(19),n()(),i(20,"div",20)(21,"button",41),f("click",function(){z(e);let r=m();return _(r.indietro())}),a(22,"Indietro"),n(),i(23,"button",42),f("click",function(){z(e);let r=m();return _(r.avanti())}),a(24,"Continua"),n()()()}if(l&2){let e=m();s(12),d("ngForOf",e.getServiziPacchetto("digitalizzazione_automatismi")),s(4),d("ngForOf",e.getServiziSingoli("digitalizzazione_automatismi")),s(3),y("Totale modulo: ",e.moduli.digitalizzazione_automatismi.totale," \u20AC")}}function De(l,t){if(l&1){let e=b();i(0,"div",43),f("click",function(){let r=z(e).$implicit,c=m(3);return _(c.isServizioContabilitaAbilitato(r)&&c.toggleServizioContabilita(r))}),i(1,"div",44)(2,"h4",54),a(3),n(),i(4,"div",55),a(5),n()(),i(6,"p",46),a(7),n(),i(8,"div",48)(9,"i",33),a(10,"check"),n()()()}if(l&2){let e=t.$implicit,o=m(3);C("selezionato",e.selezionato)("disabled",!o.isServizioContabilitaAbilitato(e)),s(3),v(e.nome),s(2),y("",e.prezzo," \u20AC"),s(2),v(e.descrizione),s(),C("attivo",e.selezionato)}}function Re(l,t){if(l&1&&(i(0,"div")(1,"div",37),x(2,De,11,9,"div",78),n()()),l&2){let e=m(2);s(2),d("ngForOf",e.getServiziByCategoria("Costituzione"))}}function We(l,t){l&1&&(i(0,"span"),a(1," Fino a 90 registrazioni: 1.421\u20AC "),n())}function Be(l,t){l&1&&(i(0,"span"),a(1," Fino a 180 registrazioni: 1.811\u20AC "),n())}function Le(l,t){l&1&&(i(0,"span"),a(1," Fino a 360 registrazioni: 2.805\u20AC "),n())}function Ge(l,t){if(l&1&&(i(0,"span"),a(1),n()),l&2){let e=m(4);s(),k(" Oltre 360 registrazioni: 2.805\u20AC + (",e.configurazioniContabilita.contabilita.registrazioni-360," \xD7 2\u20AC) = ",e.configurazioniContabilita.contabilita.prezzoCalcolato,"\u20AC ")}}function $e(l,t){if(l&1&&(i(0,"div"),x(1,We,2,0,"span",56)(2,Be,2,0,"span",56)(3,Le,2,0,"span",56)(4,Ge,2,2,"span",56),n()),l&2){let e=m(3);s(),d("ngIf",e.configurazioniContabilita.contabilita.registrazioni<=90),s(),d("ngIf",e.configurazioniContabilita.contabilita.registrazioni>90&&e.configurazioniContabilita.contabilita.registrazioni<=180),s(),d("ngIf",e.configurazioniContabilita.contabilita.registrazioni>180&&e.configurazioniContabilita.contabilita.registrazioni<=360),s(),d("ngIf",e.configurazioniContabilita.contabilita.registrazioni>360)}}function qe(l,t){l&1&&(i(0,"span"),a(1," Fino a 600 registrazioni: 3.276\u20AC "),n())}function Ue(l,t){if(l&1&&(i(0,"span"),a(1),n()),l&2){let e=m(4);s(),k(" Oltre 600 registrazioni: 3.276\u20AC + (",e.configurazioniContabilita.contabilita.registrazioni-600," \xD7 3.38\u20AC) = ",e.configurazioniContabilita.contabilita.prezzoCalcolato,"\u20AC ")}}function je(l,t){if(l&1&&(i(0,"div"),x(1,qe,2,0,"span",56)(2,Ue,2,2,"span",56),n()),l&2){let e=m(3);s(),d("ngIf",e.configurazioniContabilita.contabilita.registrazioni<=600),s(),d("ngIf",e.configurazioniContabilita.contabilita.registrazioni>600)}}function He(l,t){l&1&&(i(0,"span"),a(1," Fino a 600 registrazioni: 2.644\u20AC "),n())}function Je(l,t){if(l&1&&(i(0,"span"),a(1),n()),l&2){let e=m(4);s(),k(" Oltre 600 registrazioni: 2.644\u20AC + (",e.configurazioniContabilita.contabilita.registrazioni-600," \xD7 3.38\u20AC) = ",e.configurazioniContabilita.contabilita.prezzoCalcolato,"\u20AC ")}}function Qe(l,t){if(l&1&&(i(0,"div"),x(1,He,2,0,"span",56)(2,Je,2,2,"span",56),n()),l&2){let e=m(3);s(),d("ngIf",e.configurazioniContabilita.contabilita.registrazioni<=600),s(),d("ngIf",e.configurazioniContabilita.contabilita.registrazioni>600)}}function Ye(l,t){if(l&1&&(i(0,"div",32)(1,"strong"),a(2,"Dettaglio calcolo:"),n(),x(3,$e,5,4,"div",56)(4,je,3,2,"div",56)(5,Qe,3,2,"div",56),n()),l&2){let e=m(2);s(3),d("ngIf",e.configurazioniContabilita.contabilita.tipo==="semplificata"),s(),d("ngIf",e.configurazioniContabilita.contabilita.tipo==="ordinaria"),s(),d("ngIf",e.configurazioniContabilita.contabilita.tipo==="mista")}}function Ke(l,t){if(l&1){let e=b();i(0,"div",43),f("click",function(){let r=z(e).$implicit,c=m(2);return _(c.toggleServizioContabilita(r))}),i(1,"div",44)(2,"h4"),a(3),n(),i(4,"div",45),a(5),n()(),i(6,"p",46),a(7),n(),i(8,"div",48)(9,"i",33),a(10,"check"),n()()()}if(l&2){let e=t.$implicit,o=m(2);C("selezionato",e.selezionato),s(3),v(e.nome),s(2),v(o.formatPrezzoServizio(e)),s(2),v(e.descrizione),s(),C("attivo",e.selezionato)}}function Xe(l,t){if(l&1){let e=b();i(0,"section",6)(1,"div",7)(2,"i",8),a(3,"calculate"),n(),i(4,"div",9)(5,"h2",10),a(6,"Contabilit\xE0 e Fiscalit\xE0"),n(),i(7,"p",35),a(8,"Configura i servizi contabili e fiscali in base alle tue esigenze"),n()()(),i(9,"div",50)(10,"div",51)(11,"h3",10),a(12,"Costituzione Azienda"),n(),i(13,"div",52)(14,"div",53),f("click",function(){z(e);let r=m();return _(r.toggleServizioContabilita(r.moduli.contabilita_fiscalita.servizi[0]))}),i(15,"div",54)(16,"div",44)(17,"h4",54),a(18,"Costituzione Azienda"),n(),i(19,"div",55),a(20,"Configurabile"),n()()(),i(21,"p",46),a(22,"Servizi di costituzione aziendale - Seleziona per attivare i servizi specifici"),n(),i(23,"div",48)(24,"i",33),a(25,"check"),n()()(),x(26,Re,3,1,"div",56),n()(),i(27,"div",51)(28,"h3",10),a(29,"Contabilit\xE0"),n(),i(30,"div",11)(31,"div",54)(32,"h4",54),a(33,"Configurazione Contabilit\xE0"),n(),i(34,"div",45),a(35),n()(),i(36,"div",57)(37,"div",58)(38,"label",12),a(39,"Tipo di Contabilit\xE0:"),n(),i(40,"select",59),P("ngModelChange",function(r){z(e);let c=m();return I(c.configurazioniContabilita.contabilita.tipo,r)||(c.configurazioniContabilita.contabilita.tipo=r),_(r)}),f("change",function(){z(e);let r=m();return _(r.calcolaPrezzoContabilita())}),i(41,"option",60),a(42,"Semplificata (fino a 90: 1421\u20AC, 90-180: 1811\u20AC, 180-360: 2805\u20AC, oltre 360: 2805\u20AC + 2\u20AC/registrazione) "),n(),i(43,"option",61),a(44,"Ordinaria (fino a 600: 3276\u20AC, oltre 600: 3276\u20AC + 3.38\u20AC/registrazione) "),n(),i(45,"option",62),a(46,"Mista (fino a 600: 2644\u20AC, oltre 600: 2644\u20AC + 3.38\u20AC/registrazione) "),n()()(),i(47,"div",58)(48,"label",12),a(49,"Numero Registrazioni Annuali:"),n(),i(50,"input",63),P("ngModelChange",function(r){z(e);let c=m();return I(c.configurazioniContabilita.contabilita.registrazioni,r)||(c.configurazioniContabilita.contabilita.registrazioni=r),_(r)}),f("change",function(){z(e);let r=m();return _(r.calcolaPrezzoContabilita())}),n()()(),x(51,Ye,6,3,"div",18),n()(),i(52,"div",51)(53,"h3",10),a(54,"Fatturazione"),n(),i(55,"div",11)(56,"div",54)(57,"h4",54),a(58,"Configurazione Fatturazione"),n(),i(59,"div",45),a(60),n()(),i(61,"div",57)(62,"div",58)(63,"label",12),a(64,"Tipo di Fatturazione:"),n(),i(65,"select",59),P("ngModelChange",function(r){z(e);let c=m();return I(c.configurazioniContabilita.fatturazione.tipo,r)||(c.configurazioniContabilita.fatturazione.tipo=r),_(r)}),f("change",function(){z(e);let r=m();return _(r.calcolaPrezzoFatturazione())}),i(66,"option",64),a(67,"Emissione da parte nostra (25\u20AC/fattura)"),n(),i(68,"option",65),a(69,"Piattaforma PassCom (4\u20AC/fattura)"),n()()(),i(70,"div",58)(71,"label",12),a(72,"Numero Fatture Annuali:"),n(),i(73,"input",66),P("ngModelChange",function(r){z(e);let c=m();return I(c.configurazioniContabilita.fatturazione.numeroFatture,r)||(c.configurazioniContabilita.fatturazione.numeroFatture=r),_(r)}),f("change",function(){z(e);let r=m();return _(r.calcolaPrezzoFatturazione())}),n()()()()(),i(74,"div",51)(75,"h3",10),a(76,"IVA"),n(),i(77,"div",11)(78,"div",54)(79,"h4",54),a(80,"Configurazione Servizi IVA"),n(),i(81,"div",45),a(82),n()(),i(83,"div",57)(84,"div",58)(85,"label",12),a(86,"Liquidazione IVA:"),n(),i(87,"select",59),P("ngModelChange",function(r){z(e);let c=m();return I(c.configurazioniContabilita.iva.liquidazione,r)||(c.configurazioniContabilita.iva.liquidazione=r),_(r)}),f("change",function(){z(e);let r=m();return _(r.calcolaPrezzoIVA())}),i(88,"option",67),a(89,"Trimestrale"),n(),i(90,"option",68),a(91,"Mensile"),n()()(),i(92,"div",58)(93,"label",12),a(94,"LIPE:"),n(),i(95,"select",59),P("ngModelChange",function(r){z(e);let c=m();return I(c.configurazioniContabilita.iva.lipe,r)||(c.configurazioniContabilita.iva.lipe=r),_(r)}),f("change",function(){z(e);let r=m();return _(r.calcolaPrezzoIVA())}),i(96,"option",67),a(97,"Trimestrale"),n(),i(98,"option",68),a(99,"Mensile"),n()()(),i(100,"div",58)(101,"label",12),a(102,"Volume d'Affari per Dichiarazione Annuale:"),n(),i(103,"select",59),P("ngModelChange",function(r){z(e);let c=m();return I(c.configurazioniContabilita.iva.volumeAffari,r)||(c.configurazioniContabilita.iva.volumeAffari=r),_(r)}),f("change",function(){z(e);let r=m();return _(r.calcolaPrezzoIVA())}),i(104,"option",69),a(105,"Fino a 75.000\u20AC"),n(),i(106,"option",70),a(107,"75.001-150.000\u20AC"),n(),i(108,"option",71),a(109,"150.001-300.000\u20AC"),n(),i(110,"option",72),a(111,"300.001-500.000\u20AC"),n(),i(112,"option",73),a(113,"500.001-750.000\u20AC"),n(),i(114,"option",74),a(115,"Oltre 750.000\u20AC"),n()()(),i(116,"div",75)(117,"label")(118,"input",76),P("ngModelChange",function(r){z(e);let c=m();return I(c.configurazioniContabilita.iva.vistoConformita,r)||(c.configurazioniContabilita.iva.vistoConformita=r),_(r)}),f("change",function(){z(e);let r=m();return _(r.calcolaPrezzoIVA())}),n(),a(119," Visto di Conformit\xE0 "),n()(),i(120,"div",75)(121,"label")(122,"input",76),P("ngModelChange",function(r){z(e);let c=m();return I(c.configurazioniContabilita.iva.modelloIVATR,r)||(c.configurazioniContabilita.iva.modelloIVATR=r),_(r)}),f("change",function(){z(e);let r=m();return _(r.calcolaPrezzoIVA())}),n(),a(123," Modello IVA TR "),n()(),i(124,"div",75)(125,"label")(126,"input",76),P("ngModelChange",function(r){z(e);let c=m();return I(c.configurazioniContabilita.iva.intrastat,r)||(c.configurazioniContabilita.iva.intrastat=r),_(r)}),f("change",function(){z(e);let r=m();return _(r.calcolaPrezzoIVA())}),n(),a(127," Intrastat "),n()()()()(),i(128,"div",51)(129,"h3",77),a(130,"Altri Servizi"),n(),i(131,"div",37),x(132,Ke,11,7,"div",39),n()()(),i(133,"div",40)(134,"strong"),a(135),n()(),i(136,"div",20)(137,"button",41),f("click",function(){z(e);let r=m();return _(r.indietro())}),a(138,"Indietro"),n(),i(139,"button",42),f("click",function(){z(e);let r=m();return _(r.avanti())}),a(140,"Continua"),n()()()}if(l&2){let e=m();s(14),C("active",e.configurazioniContabilita.costituzione.attivo),s(9),C("attivo",e.configurazioniContabilita.costituzione.attivo),s(3),d("ngIf",e.configurazioniContabilita.costituzione.attivo),s(9),y("",e.configurazioniContabilita.contabilita.prezzoCalcolato," \u20AC"),s(5),E("ngModel",e.configurazioniContabilita.contabilita.tipo),s(10),E("ngModel",e.configurazioniContabilita.contabilita.registrazioni),s(),d("ngIf",e.configurazioniContabilita.contabilita.prezzoCalcolato>0),s(9),y("",e.configurazioniContabilita.fatturazione.prezzoCalcolato," \u20AC"),s(5),E("ngModel",e.configurazioniContabilita.fatturazione.tipo),s(8),E("ngModel",e.configurazioniContabilita.fatturazione.numeroFatture),s(9),y("",e.configurazioniContabilita.iva.prezzoCalcolato," \u20AC"),s(5),E("ngModel",e.configurazioniContabilita.iva.liquidazione),s(8),E("ngModel",e.configurazioniContabilita.iva.lipe),s(8),E("ngModel",e.configurazioniContabilita.iva.volumeAffari),s(15),E("ngModel",e.configurazioniContabilita.iva.vistoConformita),s(4),E("ngModel",e.configurazioniContabilita.iva.modelloIVATR),s(4),E("ngModel",e.configurazioniContabilita.iva.intrastat),s(6),d("ngForOf",e.getServiziByCategoria("Altri Servizi")),s(3),y("Totale modulo: ",e.moduli.contabilita_fiscalita.totale," \u20AC")}}function Ze(l,t){if(l&1&&(i(0,"span",49),a(1),n()),l&2){let e=m().$implicit;s(),v(e.pacchetto)}}function et(l,t){if(l&1){let e=b();i(0,"div",80),f("click",function(){let r=z(e).$implicit,c=m(2);return _(c.toggleServizio("ottimizzazione_management",r))}),i(1,"div",44)(2,"h4"),a(3),n(),i(4,"div",45),a(5),n()(),i(6,"p",46),a(7),n(),x(8,Ze,2,1,"span",47),i(9,"div",48)(10,"i",33),a(11,"check"),n()()()}if(l&2){let e=t.$implicit,o=m(2);C("selezionato",e.selezionato)("disabled",o.isServizioDisabled("ottimizzazione_management",e)),d("hidden",!e.id.startsWith("consulenza_impresa_")),s(3),v(e.nome),s(2),v(o.formatPrezzoServizio(e)),s(2),v(e.descrizione),s(),d("ngIf",e.pacchetto),s(),C("attivo",e.selezionato)}}function tt(l,t){if(l&1&&(i(0,"span",49),a(1),n()),l&2){let e=m().$implicit;s(),v(e.pacchetto)}}function it(l,t){if(l&1){let e=b();i(0,"div",80),f("click",function(){let r=z(e).$implicit,c=m(2);return _(c.toggleServizio("ottimizzazione_management",r))}),i(1,"div",44)(2,"h4"),a(3),n(),i(4,"div",45),a(5),n()(),i(6,"p",46),a(7),n(),x(8,tt,2,1,"span",47),i(9,"div",48)(10,"i",33),a(11,"check"),n()()()}if(l&2){let e=t.$implicit,o=m(2);C("selezionato",e.selezionato)("disabled",o.isServizioDisabled("ottimizzazione_management",e)),d("hidden",!e.id.startsWith("formazione_commerciale_")),s(3),v(e.nome),s(2),v(o.formatPrezzoServizio(e)),s(2),v(e.descrizione),s(),d("ngIf",e.pacchetto),s(),C("attivo",e.selezionato)}}function nt(l,t){if(l&1){let e=b();i(0,"div",43),f("click",function(){let r=z(e).$implicit,c=m(2);return _(c.toggleServizio("ottimizzazione_management",r))}),i(1,"div",44)(2,"h4"),a(3),n(),i(4,"div",45),a(5),n()(),i(6,"p",46),a(7),n(),i(8,"div",48)(9,"i",33),a(10,"check"),n()()()}if(l&2){let e=t.$implicit,o=m(2);C("selezionato",e.selezionato),s(3),v(e.nome),s(2),v(o.formatPrezzoServizio(e)),s(2),v(e.descrizione),s(),C("attivo",e.selezionato)}}function ot(l,t){if(l&1){let e=b();i(0,"section",6)(1,"div",7)(2,"i",8),a(3,"tune"),n(),i(4,"div",9)(5,"h2",10),a(6,"Ottimizzazione e Management"),n(),i(7,"p",35),a(8,"Configura i servizi di ottimizzazione"),n()()(),i(9,"h3",36),a(10,"Pacchetti \u2014 Consulenze di Impresa"),n(),i(11,"div",37),x(12,et,12,11,"div",79),n(),i(13,"h3",36),a(14,"Pacchetti \u2014 Formazione Commerciale"),n(),i(15,"div",37),x(16,it,12,11,"div",79),n(),i(17,"h3",36),a(18,"Servizi singoli"),n(),i(19,"div",37),x(20,nt,11,7,"div",39),n(),i(21,"div",40)(22,"strong"),a(23),n()(),i(24,"div",20)(25,"button",41),f("click",function(){z(e);let r=m();return _(r.indietro())}),a(26,"Indietro"),n(),i(27,"button",42),f("click",function(){z(e);let r=m();return _(r.avanti())}),a(28,"Vedi Riepilogo"),n()()()}if(l&2){let e=m();s(12),d("ngForOf",e.getServiziPacchetto("ottimizzazione_management")),s(4),d("ngForOf",e.getServiziPacchetto("ottimizzazione_management")),s(4),d("ngForOf",e.getServiziSingoli("ottimizzazione_management")),s(3),y("Totale modulo: ",e.moduli.ottimizzazione_management.totale," \u20AC")}}function at(l,t){if(l&1&&(i(0,"div",32)(1,"i",33),a(2,"business"),n(),a(3," Prospect: "),i(4,"strong"),a(5),n()()),l&2){let e=m(2);s(5),v(e.selectedProspect.ragione_sociale)}}function rt(l,t){if(l&1&&(i(0,"div",96)(1,"div",97)(2,"span",98),a(3,"\u2713"),n(),i(4,"span",99),a(5),n()(),i(6,"div",100),a(7),n()()),l&2){let e=t.$implicit,o=m(3);s(5),v(e.nome),s(2),v(o.formatPrezzoServizio(e))}}function lt(l,t){if(l&1&&(i(0,"div",11)(1,"h2",54),a(2,"Immagine & Marketing"),n(),i(3,"div",57),x(4,rt,8,2,"div",94),n(),i(5,"div",95),a(6),n()()),l&2){let e=m(2);s(4),d("ngForOf",e.getServiziSelezionatiModulo("immagine_marketing")),s(2),y("Totale Modulo: ",e.moduli.immagine_marketing.totale," \u20AC")}}function st(l,t){if(l&1&&(i(0,"div",96)(1,"div",97)(2,"span",101),a(3,"\u2713"),n(),i(4,"span",99),a(5),n()(),i(6,"div",100),a(7),n()()),l&2){let e=t.$implicit,o=m(3);s(5),v(e.nome),s(2),v(o.formatPrezzoServizio(e))}}function ct(l,t){if(l&1&&(i(0,"div",11)(1,"h2",54),a(2,"Digitalizzazione & Automatismi"),n(),i(3,"div",57),x(4,st,8,2,"div",94),n(),i(5,"div",95),a(6),n()()),l&2){let e=m(2);s(4),d("ngForOf",e.getServiziSelezionatiModulo("digitalizzazione_automatismi")),s(2),y("Totale Modulo: ",e.formatTotaleModulo("digitalizzazione_automatismi"))}}function mt(l,t){if(l&1&&(i(0,"div",96)(1,"div",97)(2,"span",102),a(3,"\u2713"),n(),i(4,"span",99),a(5),n()(),i(6,"div",45),a(7),n()()),l&2){let e=t.$implicit,o=m(3);s(5),v(e.nome),s(2),v(o.formatPrezzoServizio(e))}}function dt(l,t){if(l&1&&(i(0,"div",11)(1,"h2",54),a(2,"Contabilit\xE0 e Fiscalit\xE0"),n(),i(3,"div",57),x(4,mt,8,2,"div",94),n(),i(5,"div",45),a(6),n()()),l&2){let e=m(2);s(4),d("ngForOf",e.getServiziSelezionatiModulo("contabilita_fiscalita")),s(2),y("Totale Modulo: ",e.moduli.contabilita_fiscalita.totale," \u20AC")}}function pt(l,t){if(l&1&&(i(0,"div",96)(1,"div",97)(2,"span",98),a(3,"\u2713"),n(),i(4,"span",99),a(5),n()(),i(6,"div",45),a(7),n()()),l&2){let e=t.$implicit,o=m(3);s(5),v(e.nome),s(2),v(o.formatPrezzoServizio(e))}}function ut(l,t){if(l&1&&(i(0,"div",11)(1,"h2",54),a(2,"Ottimizzazione e Management"),n(),i(3,"div",57),x(4,pt,8,2,"div",94),n(),i(5,"div",45),a(6),n()()),l&2){let e=m(2);s(4),d("ngForOf",e.getServiziSelezionatiModulo("ottimizzazione_management")),s(2),y("Totale Modulo: ",e.moduli.ottimizzazione_management.totale," \u20AC")}}function zt(l,t){if(l&1&&(q(0),i(1,"span",103),a(2),n(),i(3,"span",104),a(4),n(),i(5,"small",105),a(6),R(7,"number"),n(),U()),l&2){let e=m(2);s(2),v(e.formatCurrency(e.totaleScontato)),s(2),v(e.formatCurrency(e.totaleGenerale)),s(2),y(" (sconto ",W(7,3,e.scontoPercentuale,"1.2-2"),"%)")}}function _t(l,t){if(l&1&&(i(0,"span",106),a(1),n()),l&2){let e=m(2);s(),v(e.formatCurrency(e.totaleGenerale))}}function gt(l,t){if(l&1){let e=b();i(0,"button",107),f("click",function(){z(e);let r=m(2);return _(r.salvaConfigurazione())}),i(1,"i",33),a(2,"save"),n(),a(3," Salva Configurazione "),n()}}function ft(l,t){if(l&1&&(i(0,"span",117),a(1),n()),l&2){let e=m(3);s(),k(" ",e.scontoPercentuale,"% - Risparmio: ",e.formatCurrency(e.totaleGenerale-e.totaleScontato)," ")}}function vt(l,t){l&1&&(i(0,"span",105),a(1," In attesa di valutazione / da confermare "),n())}function ht(l,t){if(l&1){let e=b();i(0,"button",41),f("click",function(){z(e);let r=m(3);return _(r.apriChatSconto())}),i(1,"span",33),a(2,"support_agent"),n(),a(3," Richiedi Sconto "),n()}}function xt(l,t){if(l&1){let e=b();i(0,"button",87),f("click",function(){z(e);let r=m(3);return r.applySconto(0),_(r.salvaConfigurazione())}),i(1,"span",33),a(2,"close"),n(),a(3," Rimuovi Sconto "),n()}}function Ct(l,t){if(l&1&&(i(0,"span"),a(1),n()),l&2){let e=m(3);s(),v(e.formatCurrency(e.totaleScontato))}}function St(l,t){if(l&1&&(i(0,"span"),a(1),n()),l&2){let e=m(3);s(),v(e.formatCurrency(e.totaleGenerale))}}function bt(l,t){if(l&1&&(i(0,"div",58)(1,"label",12),a(2,"Totale non scontato"),n(),i(3,"div",118),a(4),n()()),l&2){let e=m(3);s(4),v(e.formatCurrency(e.totaleGenerale))}}function yt(l,t){if(l&1&&(i(0,"div",2)(1,"h3",10)(2,"span",33),a(3,"local_offer"),n(),a(4," Gestione Sconto "),n(),i(5,"div",57)(6,"div",58)(7,"label",12),a(8,"Sconto Applicato"),n(),i(9,"div",108),x(10,ft,2,2,"span",109)(11,vt,2,0,"span",110),n()(),i(12,"div",58)(13,"label",12),a(14,"Azioni"),n(),i(15,"div",111),x(16,ht,4,0,"button",112)(17,xt,4,0,"button",113),n()()(),i(18,"div",114)(19,"div",57)(20,"div",58)(21,"label",12),a(22,"Totale Preventivo"),n(),i(23,"div",115),x(24,Ct,2,1,"span",56)(25,St,2,1,"span",56),n()(),x(26,bt,5,1,"div",116),n()()()),l&2){let e=m(2);s(10),d("ngIf",e.scontoPercentuale>0),s(),d("ngIf",e.scontoPercentuale===0),s(5),d("ngIf",!e.mostraChatSconto),s(),d("ngIf",e.scontoPercentuale>0),s(7),d("ngIf",e.scontoPercentuale>0),s(),d("ngIf",e.scontoPercentuale===0),s(),d("ngIf",e.scontoPercentuale>0)}}function At(l,t){l&1&&(i(0,"span",33),a(1,"support_agent"),n())}function Et(l,t){l&1&&(i(0,"span",33),a(1,"person"),n())}function It(l,t){if(l&1&&(i(0,"div",129)(1,"div",130),x(2,At,2,0,"span",131)(3,Et,2,0,"span",131),n(),i(4,"div",132)(5,"div",49),a(6),n(),i(7,"div",105),a(8),R(9,"date"),n()()()),l&2){let e=t.$implicit;d("ngClass",H(8,Ce,e.autore==="utente",e.autore==="assistenza")),s(2),d("ngIf",e.autore==="assistenza"),s(),d("ngIf",e.autore==="utente"),s(3),v(e.testo),s(2),v(W(9,5,e.timestamp,"HH:mm"))}}function Pt(l,t){if(l&1){let e=b();i(0,"div",119)(1,"div",120)(2,"div",121)(3,"h3",122)(4,"span",33),a(5,"support_agent"),n(),a(6),n(),i(7,"button",123),f("click",function(){z(e);let r=m(2);return _(r.chiudiChatSconto())}),n()(),i(8,"div",124)(9,"div",125),x(10,It,10,11,"div",126),n(),i(11,"div",127)(12,"input",128),P("ngModelChange",function(r){z(e);let c=m(2);return I(c.messaggioChat,r)||(c.messaggioChat=r),_(r)}),f("keyup.enter",function(){z(e);let r=m(2);return _(r.inviaMessaggio())}),n(),i(13,"button",21),f("click",function(){z(e);let r=m(2);return _(r.inviaMessaggio())}),i(14,"span",33),a(15,"send"),n()()()()()()}if(l&2){let e=m(2);s(6),y(" Assistenza Preventivo \xB7 ",(e.selectedProspect==null?null:e.selectedProspect.ragione_sociale)||"Cliente"," "),s(4),d("ngForOf",e.messaggiAssistenza),s(2),E("ngModel",e.messaggioChat),s(),d("disabled",!e.messaggioChat.trim())}}function Mt(l,t){if(l&1){let e=b();i(0,"section",6)(1,"div",7)(2,"i",8),a(3,"receipt_long"),n(),i(4,"div",9)(5,"h2",10),a(6,"Riepilogo Configurazione"),n()()(),i(7,"div",11),x(8,at,6,1,"div",18),i(9,"div",37),x(10,lt,7,2,"div",81)(11,ct,7,2,"div",81)(12,dt,7,2,"div",81)(13,ut,7,2,"div",81),n(),i(14,"div",82)(15,"h3",83)(16,"span",84),a(17,"Totale:"),n(),x(18,zt,8,6,"ng-container",85)(19,_t,2,1,"ng-template",null,0,Q),n()()(),i(21,"div",86)(22,"button",87),f("click",function(){z(e);let r=m();return _(r.indietro())}),i(23,"span",33),a(24,"edit"),n(),a(25,"Modifica "),n(),i(26,"button",88),f("click",function(){z(e);let r=m();return _(r.apriChatSconto())}),i(27,"span",33),a(28,"support_agent"),n(),a(29,"Assistenza "),n(),i(30,"button",89),f("click",function(){z(e);let r=m();return _(r.visualizzaPreventivo())}),i(31,"span",33),a(32,"description"),n(),a(33," Visualizza Preventivo "),n(),x(34,gt,4,0,"button",90),i(35,"button",91),f("click",function(){z(e);let r=m();return _(r.procediPerFirme())}),i(36,"i",33),a(37,"assignment_turned_in"),n(),a(38),n()(),x(39,yt,27,7,"div",92)(40,Pt,16,4,"div",93),n()}if(l&2){let e=j(20),o=m();s(8),d("ngIf",o.selectedProspect),s(2),d("ngIf",o.getServiziSelezionatiModulo("immagine_marketing").length>0||o.moduli.immagine_marketing.totale>0),s(),d("ngIf",o.getServiziSelezionatiModulo("digitalizzazione_automatismi").length>0||o.moduli.digitalizzazione_automatismi.totale>0),s(),d("ngIf",o.getServiziSelezionatiModulo("contabilita_fiscalita").length>0||o.moduli.contabilita_fiscalita.totale>0),s(),d("ngIf",o.getServiziSelezionatiModulo("ottimizzazione_management").length>0||o.moduli.ottimizzazione_management.totale>0),s(5),d("ngIf",o.scontoPercentuale>0)("ngIfElse",e),s(16),d("ngIf",!o.isCliente),s(),d("disabled",!o.selectedProspect||o.totaleGenerale===0),s(3),y(" ",o.isProspect?"Procedi per le Firme":"Aggiorna Configurazione"," "),s(),d("ngIf",o.currentStep===6&&(o.mostraChatSconto||o.scontoPercentuale>0)),s(),d("ngIf",o.mostraChatSconto)}}function wt(l,t){if(l&1){let e=b();i(0,"div",96)(1,"div",97)(2,"strong"),a(3),n(),i(4,"div",139),a(5),n()(),i(6,"div",140)(7,"button",141),f("click",function(){let r=z(e).index,c=m(3);return _(c.rimuoviNominativo(r))}),i(8,"i",33),a(9,"delete"),n()()()()}if(l&2){let e=t.$implicit;s(3),v(e.nome),s(2),k(" ",e.telefono||"\u2014"," \u2022 ",e.email||"\u2014"," ")}}function Tt(l,t){if(l&1&&(i(0,"div",138)(1,"h3",10),a(2),n(),i(3,"div",57),x(4,wt,10,3,"div",94),n()()),l&2){let e=m(2);s(2),y("Nominativi Inseriti (",e.nominativi.length,")"),s(2),d("ngForOf",e.nominativi)}}function Vt(l,t){if(l&1){let e=b();i(0,"section",6)(1,"h2"),a(2,"Inserisci i Nominativi Ottenuti"),n(),i(3,"p",35),a(4,"Aggiungi i contatti ottenuti dalla trattativa. Saranno creati come nuovi prospect."),n(),i(5,"div",133)(6,"div",57)(7,"div",58)(8,"label",12),a(9,"Nome completo *"),n(),i(10,"input",134),P("ngModelChange",function(r){z(e);let c=m();return I(c.nuovoNominativo.nome,r)||(c.nuovoNominativo.nome=r),_(r)}),n()(),i(11,"div",58)(12,"label",12),a(13,"Telefono"),n(),i(14,"input",135),P("ngModelChange",function(r){z(e);let c=m();return I(c.nuovoNominativo.telefono,r)||(c.nuovoNominativo.telefono=r),_(r)}),n()(),i(15,"div",58)(16,"label",12),a(17,"Email"),n(),i(18,"input",136),P("ngModelChange",function(r){z(e);let c=m();return I(c.nuovoNominativo.email,r)||(c.nuovoNominativo.email=r),_(r)}),n()()(),i(19,"div",20)(20,"button",42),f("click",function(){z(e);let r=m();return _(r.aggiungiNominativo())}),i(21,"i",33),a(22,"add"),n(),a(23," Aggiungi Nominativo "),n()()(),x(24,Tt,5,2,"div",137),i(25,"div",20)(26,"button",41),f("click",function(){z(e);let r=m();return r.pendingFirmeProcess=!1,_(r.indietro())}),a(27,"Indietro"),n(),i(28,"button",21),f("click",function(){z(e);let r=m();return _(r.procediPerFirme())}),a(29,"Procedi"),n()()()}if(l&2){let e=m();s(10),E("ngModel",e.nuovoNominativo.nome),s(4),E("ngModel",e.nuovoNominativo.telefono),s(4),E("ngModel",e.nuovoNominativo.email),s(6),d("ngIf",e.nominativi.length>0),s(4),d("disabled",!e.selectedProspect)}}var he=class l{constructor(t,e,o,r,c){this.soggettiService=t;this.alchemizzatoreService=e;this.router=o;this.route=r;this.supabaseService=c}currentStep=1;totaleSteps=7;scontoPercentuale=0;mostraChatSconto=!1;messaggioChat="";messaggiAssistenza=[];richiedendoSconto=!1;baseAssistDelay=1400;assistJitter=900;pendingCifraRequest=null;queryProspect="";searchResults=[];searchLoading=!1;searchError=null;selectedProspect=null;nominativi=[];nuovoNominativo={nome:"",telefono:"",email:""};pendingFirmeProcess=!1;currentConfigurazioneId=null;previousConfigurazione=null;configurazioneCorrenteId=null;moduli={immagine_marketing:{nome:"Immagine & Marketing",servizi:[{id:"creazione_logo",nome:"Creazione del Logo",prezzo:300,selezionato:!1,descrizione:"Design professionale del logo aziendale"},{id:"creazione_brand",nome:"Creazione del Brand (include logo)",prezzo:800,selezionato:!1,descrizione:"Identit\xE0 visiva completa: logo, palette colori, typography"},{id:"social_2_post",nome:"Gestione Social Media (2 post/settimana)",prezzo:400,selezionato:!1,pacchetto:"base",descrizione:"2 post settimanali su Facebook e Instagram"},{id:"social_3_post",nome:"Gestione Social Media (3 post/settimana)",prezzo:600,selezionato:!1,pacchetto:"avanzato",descrizione:"3 post settimanali su Facebook, Instagram e LinkedIn"},{id:"social_5_post",nome:"Gestione Social Media (5 post/settimana)",prezzo:800,selezionato:!1,pacchetto:"premium",descrizione:"5 post settimanali su tutti i social + stories"},{id:"servizio_fotografico",nome:"Servizio Fotografico",prezzo:500,selezionato:!1,descrizione:"Servizio fotografico professionale per prodotti/azienda"}],totale:0},digitalizzazione_automatismi:{nome:"Digitalizzazione & Automatismi",servizi:[{id:"landing_page",nome:"Landing Page",prezzo:1e3,selezionato:!1,pacchetto:"base",descrizione:"Pagina di destinazione ottimizzata per conversioni"},{id:"sito_completo",nome:"Sito Web Completo",prezzo:2e3,selezionato:!1,pacchetto:"avanzato",descrizione:"Sito web responsive"},{id:"sito_pro",nome:"Sito Web Pro",prezzo:3500,selezionato:!1,pacchetto:"premium",descrizione:"Sito web avanzato con funzionalit\xE0 personalizzate"},{id:"software_personalizzato",nome:"Software Personalizzato",prezzo:0,selezionato:!1,descrizione:"Richiesta di valutazione per software su misura"},{id:"consulenza_digitale",nome:"Consulenza Digitale",prezzo:300,selezionato:!1,descrizione:"Consulenza per mailing list, automazioni e digital strategy"}],totale:0},contabilita_fiscalita:{nome:"Contabilit\xE0 e Fiscalit\xE0",servizi:[{id:"costituzione_principale",nome:"Costituzione Azienda",prezzo:0,selezionato:!1,categoria:"Costituzione",descrizione:"Servizi di costituzione aziendale - Seleziona per attivare i servizi specifici",tipo:"gruppo"},{id:"cost_assic_redazione",nome:"Assistenza redazione atto costitutivo e Statuto",prezzo:150,selezionato:!1,categoria:"Costituzione",descrizione:"Assistenza redazione atto costitutivo e Statuto (oltre costo notaio e spese accessorie notaio)",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_apertura_piva",nome:"Apertura partita IVA",prezzo:100,selezionato:!1,categoria:"Costituzione",descrizione:"Apertura partita IVA",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_cciaa_no_scia",nome:"Pratica CCIAA senza SCIA",prezzo:80,selezionato:!1,categoria:"Costituzione",descrizione:"Pratica CCIAA per comunicazione attivit\xE0 (senza SCIA) - oltre accessorie (30 Euro diritti CCIAA)",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_cciaa_con_scia",nome:"Pratica CCIAA con SCIA",prezzo:200,selezionato:!1,categoria:"Costituzione",descrizione:"Pratica CCIAA per comunicazione attivit\xE0 (con SCIA al Comune) - oltre accessorie (30 Euro diritti CCIAA)",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_cciaa_scia_plus",nome:"Pratica CCIAA con SCIA plus",prezzo:250,selezionato:!1,categoria:"Costituzione",descrizione:"Pratica CCIAA per comunicazione attivit\xE0 (con SCIA al Comune e plus) - oltre accessorie",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_inps_artigiani",nome:"INPS art/comm",prezzo:50,selezionato:!1,categoria:"Costituzione",descrizione:"INPS artigiani commercianti (soci lavoratori) - per ciascuno",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_inps_gest_separata",nome:"INPS gestione separata",prezzo:80,selezionato:!1,categoria:"Costituzione",descrizione:"INPS gestione separata (P.IVA individuale e amministratori) - per ciascuno",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_vidimazione_libri",nome:"Vidimazione libri sociali",prezzo:20,selezionato:!1,categoria:"Costituzione",descrizione:"Vidimazione libri sociali (oltre accessori) - per libro",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_registrazione_verbali",nome:"Registrazione verbali",prezzo:100,selezionato:!1,categoria:"Costituzione",descrizione:"Registrazione verbali - oltre accessori",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"contabilita_principale",nome:"Servizi di Contabilit\xE0",prezzo:0,selezionato:!1,categoria:"Contabilit\xE0",descrizione:"Seleziona il tipo di contabilit\xE0 e inserisci il numero di registrazioni annuali",tipo:"configurabile"},{id:"fatturazione_principale",nome:"Servizi di Fatturazione",prezzo:0,selezionato:!1,categoria:"Fatturazione",descrizione:"Configura i servizi di fatturazione in base alle tue esigenze",tipo:"configurabile"},{id:"iva_principale",nome:"Servizi IVA",prezzo:0,selezionato:!1,categoria:"IVA",descrizione:"Configura i servizi IVA in base alla tua periodicit\xE0",tipo:"configurabile"},{id:"redditi_principale",nome:"Dichiarazione Redditi",prezzo:0,selezionato:!1,categoria:"Redditi",descrizione:"Configura la dichiarazione redditi in base al tipo di soggetto e volume d'affari",tipo:"configurabile"},{id:"bilancio_principale",nome:"Bilancio",prezzo:0,selezionato:!1,categoria:"Bilancio",descrizione:"Configura il servizio di bilancio in base alle tue esigenze",tipo:"configurabile"},{id:"altro_cu_autonomi",nome:"CU autonomi (fino a 5 percipienti)",prezzo:180,selezionato:!1,categoria:"Altri Servizi",descrizione:"CU per autonomi - fino a 5 percipienti",tipo:"fisso"},{id:"altro_modello_770",nome:"Modello 770",prezzo:100,selezionato:!1,categoria:"Altri Servizi",descrizione:"Modello 770 - autonomi e capitali - una tantum/anno",tipo:"fisso"},{id:"altro_f24_12",nome:"F24 (fino a 12/anno)",prezzo:300,selezionato:!1,categoria:"Altri Servizi",descrizione:"F24 - fino a 12 pagamenti/anno",tipo:"fisso"},{id:"altro_imu_dichiarazione",nome:"Dichiarazione IMU/ILIA",prezzo:60,selezionato:!1,categoria:"Altri Servizi",descrizione:"Dichiarazione IMU/ILIA",tipo:"fisso"},{id:"altro_imu_verifica",nome:"Verifica Esatto/calcolo IMU",prezzo:40,selezionato:!1,categoria:"Altri Servizi",descrizione:"Verifica Esatto/calcolo IMU",tipo:"fisso"},{id:"altro_imu_pagamento",nome:"Pagamento IMU a scadenza",prezzo:25,selezionato:!1,categoria:"Altri Servizi",descrizione:"Pagamento IMU a scadenza",tipo:"fisso"},{id:"altro_avvisi_bonari",nome:"Autotutela avvisi bonari",prezzo:70,selezionato:!1,categoria:"Altri Servizi",descrizione:"Autotutela avvisi bonari",tipo:"fisso"},{id:"altro_locazioni",nome:"Supporto contratti locazione",prezzo:180,selezionato:!1,categoria:"Altri Servizi",descrizione:"Supporto nella predisposizione e registrazione contratti locazione",tipo:"fisso"},{id:"altro_lettere_intento",nome:"Invio lettere d'intento",prezzo:85,selezionato:!1,categoria:"Altri Servizi",descrizione:"Invio lettere d'intento - per ciascuna",tipo:"fisso"},{id:"altro_smart_card_rilascio",nome:"Rilascio Smart Card",prezzo:60,selezionato:!1,categoria:"Altri Servizi",descrizione:"Rilascio Smart Card - per ciascuna",tipo:"fisso"},{id:"altro_smart_card_conservazione",nome:"Conservazione Smart Card",prezzo:30,selezionato:!1,categoria:"Altri Servizi",descrizione:"Conservazione Smart Card - annuale",tipo:"fisso"},{id:"altro_titolare_effettivo",nome:"Invio pratica titolare effettivo",prezzo:130,selezionato:!1,categoria:"Altri Servizi",descrizione:"Invio pratica titolare effettivo - prezzo medio",tipo:"fisso"},{id:"altro_visure_online",nome:"Visura ordinaria",prezzo:20,selezionato:!1,categoria:"Altri Servizi",descrizione:"Visura ordinaria",tipo:"fisso"},{id:"altro_chiamate_consulenza",nome:"Chiamate per consulenza",prezzo:300,selezionato:!1,categoria:"Altri Servizi",descrizione:"Chiamate per consulenza - una tantum",tipo:"fisso"},{id:"altro_gestione_pec",nome:"Gestione PEC mensile",prezzo:16,selezionato:!1,categoria:"Altri Servizi",descrizione:"Gestione mensile PEC",tipo:"fisso"}],totale:0},ottimizzazione_management:{nome:"Ottimizzazione e Management",servizi:[{id:"consulenza_impresa_base",nome:"Consulenza di Impresa Base",prezzo:800,selezionato:!1,pacchetto:"base",descrizione:"Analisi iniziale e piano di miglioramento base"},{id:"consulenza_impresa_avanzata",nome:"Consulenza di Impresa Avanzata",prezzo:1500,selezionato:!1,pacchetto:"avanzato",descrizione:"Consulenza strategica con piano d'azione dettagliato"},{id:"consulenza_impresa_premium",nome:"Consulenza di Impresa Premium",prezzo:2500,selezionato:!1,pacchetto:"premium",descrizione:"Consulenza completa con supporto continuativo"},{id:"formazione_commerciale_base",nome:"Formazione Commerciale Base",prezzo:600,selezionato:!1,pacchetto:"base",descrizione:"Corso base di tecniche di vendita"},{id:"formazione_commerciale_avanzata",nome:"Formazione Commerciale Avanzata",prezzo:1200,selezionato:!1,pacchetto:"avanzato",descrizione:"Formazione avanzata con simulazioni pratiche"},{id:"formazione_commerciale_premium",nome:"Formazione Commerciale Premium",prezzo:2e3,selezionato:!1,pacchetto:"premium",descrizione:"Programma completo con coaching individuale"}],totale:0}};totaleGenerale=0;ngOnInit(){return w(this,null,function*(){let e=this.router.getCurrentNavigation()?.extras?.state||history?.state||{},o=e?.prospect,r=this.route.snapshot.queryParamMap,c=o?.id||r.get("prospectId"),p=Number(e?.goToStep||r.get("step"))||0;if(o?.id)this.selectedProspect=o;else if(c)try{let{data:g,error:S}=yield this.soggettiService.getSoggettoById(c);!S&&g&&(this.selectedProspect=g)}catch{}c&&(yield this.loadConfigurazioneEsistente(c),this.currentStep=p&&p>=1&&p<=this.totaleSteps?p:6);let u=this.route.snapshot.queryParamMap.get("focusConfig");u&&this.openConfigurazioneById(u)})}openConfigurazioneById(t){return w(this,null,function*(){if(t)try{let e=yield this.alchemizzatoreService.getConfigurazioneById(t),o=e.data;if(e.error||!o){console.warn("Configurazione non trovata:",e.error);return}this.configurazioneCorrenteId=o.id??null,this.currentConfigurazioneId=this.configurazioneCorrenteId;let r=o.dettagli??{};this.applyConfigurazioneDettagli(r),this.previousConfigurazione=this.deepClone(r),this.updateTotaleGeneraleFromDetails();let c=o.prospect_id??o.prospectId;if(c&&(!this.selectedProspect||this.selectedProspect.id!==c))try{let p=yield this.soggettiService.getSoggettoById(c);!p.error&&p.data&&(this.selectedProspect=p.data,this.queryProspect=this.selectedProspect?.ragione_sociale??"")}catch(p){console.warn("Impossibile caricare prospect per configurazione:",p)}this.currentStep=6}catch(e){console.error("Errore in openConfigurazioneById:",e)}})}loadConfigurazioneEsistente(t){return w(this,null,function*(){let{data:e,error:o}=yield this.alchemizzatoreService.getConfigurazioniByProspect(t);if(o||!Array.isArray(e)||e.length===0)return;let r=[...e].sort((p,u)=>new Date(u.updated_at||u.created_at||u.data_configurazione||0).getTime()-new Date(p.updated_at||p.created_at||p.data_configurazione||0).getTime())[0];this.configurazioneCorrenteId=r.id??null,this.currentConfigurazioneId=this.configurazioneCorrenteId;let c=r?.dettagli||{};this.applyConfigurazioneDettagli(c),this.previousConfigurazione=this.deepClone(c)})}applyConfigurazioneDettagli(t){if(!t)return;let e=["immagine_marketing","digitalizzazione_automatismi","contabilita_fiscalita","ottimizzazione_management"],o=0,r=!1;for(let p of e){let u=t[p];if(!u){this.moduli[p].servizi.forEach(h=>h.selezionato=!1),this.moduli[p].totale=0;continue}let g=Array.isArray(u.servizi_selezionati)?u.servizi_selezionati:Array.isArray(u.servizi)?u.servizi:[],S=new Set(g.map(h=>typeof h=="string"?h:h?.id).filter(Boolean));if(this.moduli[p].servizi.forEach(h=>{h.selezionato=S.has(h.id);let A=g.find(T=>typeof T=="string"?T===h.id:T?.id===h.id);A&&typeof A.prezzo<"u"&&(h.prezzo=Number(A.prezzo)||0)}),typeof u.totale<"u"&&u.totale!==null){let h=Number(u.totale)||0;this.moduli[p].totale=Math.round(h*100)/100,o+=this.moduli[p].totale,r=!0;continue}if(g.length>0){let h=g.reduce((A,T)=>A+(Number(T?.prezzo)||0),0);if(h>0){this.moduli[p].totale=Math.round(h*100)/100,o+=this.moduli[p].totale;continue}}let M=this.moduli[p].servizi.filter(h=>h.selezionato).reduce((h,A)=>h+(Number(A.prezzo)||0),0);this.moduli[p].totale=Math.round(M*100)/100,this.moduli[p].totale>0&&(o+=this.moduli[p].totale)}let c=t&&t.meta?t.meta:null;if(c){let p=Number(c.totaleOriginale??c.totaleGenerale??o)||0;this.totaleGenerale=Math.round(p*100)/100,this.scontoPercentuale=Number(c.scontoPercentuale??0)||0,o===0&&this.calcolaTotali()}else this.calcolaTotali();this.previousConfigurazione=this.deepClone(t)}avanti(){this.currentStep<this.totaleSteps&&this.currentStep++}indietro(){this.currentStep>1&&this.currentStep--}vaiAStep(t){t>=1&&t<=this.totaleSteps&&(this.currentStep=t)}onSearchProspect(t){return w(this,null,function*(){if(this.searchError=null,!t?.trim()){this.searchResults=[];return}this.searchLoading=!0;try{let[e,o]=yield Promise.all([this.soggettiService.searchSoggetti(t,"prospect"),this.soggettiService.searchSoggetti(t,"cliente")]),r=e.data??[],c=o.data??[],p=Array.from(new Map([...r,...c].map(u=>[u.id,u])).values());this.searchResults=p}catch(e){console.error("Errore durante la ricerca soggetti",e),this.searchError="Errore durante la ricerca"}finally{this.searchLoading=!1}})}get isModificaConfigurazione(){return!!(this.selectedProspect?.tipo==="cliente"&&this.configurazioneCorrenteId)}onSelectProspect(t){return w(this,null,function*(){if(this.searchResults=[],this.queryProspect=t.ragione_sociale??"",!t.tipo){let{data:e}=yield this.soggettiService.getSoggettoById(t.id);e&&(t=e)}if(this.selectedProspect=t,this.queryProspect=t.ragione_sociale??"",this.searchResults=[],t.tipo==="cliente"){let{data:e}=yield this.supabaseService.getUltimaConfigurazionePromethea(t.id);if(e){this.configurazioneCorrenteId=e.id??null,this.currentConfigurazioneId=this.configurazioneCorrenteId,this.applyConfigurazioneDettagli(e.dettagli),this.previousConfigurazione=this.deepClone(e.dettagli??{});return}}this.configurazioneCorrenteId=null,this.currentConfigurazioneId=null,this.previousConfigurazione=null,yield this.loadConfigurazioneEsistente(t.id)})}toggleServizio(t,e){let o=this.moduli[t],r=!e.selezionato;if(r&&t==="immagine_marketing"){if(e.id.startsWith("social_")&&o.servizi.forEach(c=>{c.id.startsWith("social_")&&c.id!==e.id&&(c.selezionato=!1)}),e.id==="creazione_brand"){let c=o.servizi.find(p=>p.id==="creazione_logo");c&&(c.selezionato=!1)}else if(e.id==="creazione_logo"){let c=o.servizi.find(p=>p.id==="creazione_brand");c&&(c.selezionato=!1)}}r&&e.pacchetto&&o.servizi.forEach(c=>{c.pacchetto===e.pacchetto&&c.id!==e.id&&(c.selezionato=!1)}),e.selezionato=r,this.calcolaTotali()}calcolaDifferenze(t,e){let o={},r=["immagine_marketing","digitalizzazione_automatismi","contabilita_fiscalita","ottimizzazione_management"],c=p=>p?(Array.isArray(p.servizi_selezionati)?p.servizi_selezionati:Array.isArray(p.servizi)?p.servizi:[]).map(g=>typeof g=="string"?g:g?.id).filter(g=>!!g):[];return r.forEach(p=>{let u=new Set(c(t?.[p])),g=new Set(c(e?.[p])),S=[...u].filter(h=>!g.has(h)),M=[...g].filter(h=>!u.has(h));(S.length||M.length)&&(o[p]={aggiunti:S,rimossi:M})}),o}isServizioDisabled(t,e){return e.pacchetto?this.moduli[t].servizi.filter(c=>c.pacchetto===e.pacchetto&&c.id!==e.id&&c.selezionato).length>0:!1}buildDettagliConfigurazione(){let t={};return Object.keys(this.moduli).forEach(e=>{let o=this.moduli[e],r=o.servizi.filter(c=>c.selezionato).map(c=>({id:c.id,nome:c.nome,prezzo:c.prezzo,pacchetto:c.pacchetto??null,descrizione:c.descrizione??null}));t[e]={nome:o.nome,totale:o.totale,servizi_selezionati:r}}),t.meta={totaleOriginale:this.totaleGenerale,totaleGenerale:this.totaleGenerale,scontoPercentuale:this.scontoPercentuale||0,totaleScontato:this.scontoPercentuale>0?this.totaleScontato:this.totaleGenerale,aggiornato_il:new Date().toISOString()},t}salvaConfigurazione(){return w(this,null,function*(){if(!window.confirm("Confermi il salvataggio della configurazione?"))return;let e=this.buildDettagliConfigurazione();if(!this.selectedProspect){console.warn("Nessun prospect selezionato: salvataggio annullato.");return}let o=Number(this.scontoPercentuale>0?this.totaleScontato:this.totaleGenerale);if(this.selectedProspect.tipo==="cliente"&&this.configurazioneCorrenteId&&this.previousConfigurazione)try{let c=this.calcolaDifferenze(e,this.previousConfigurazione);Object.keys(c).length>0&&(yield this.supabaseService.inserisciLogConfigurazione({configurazione_id:this.configurazioneCorrenteId,soggetto_id:this.selectedProspect.id,differenze:c,totale:o}))}catch(c){console.error("Errore durante l'inserimento log configurazione:",c)}let r={prospect_id:this.selectedProspect.id,data_configurazione:new Date().toISOString(),totale:o,dettagli:e};try{let{data:c,error:p}=yield this.alchemizzatoreService.salvaConfigurazione(r,this.configurazioneCorrenteId??void 0);if(p)throw console.error("Errore nel salvataggio configurazione:",p),alert("Errore durante il salvataggio della configurazione. Controlla la console."),p;if(c&&(this.configurazioneCorrenteId=c.id??this.configurazioneCorrenteId??null,this.currentConfigurazioneId=this.configurazioneCorrenteId,c.dettagli)){let u=c.dettagli,g=u.meta??{};if(this.applyConfigurazioneDettagli(u),this.scontoPercentuale=Number(g.scontoPercentuale??this.scontoPercentuale??0),this.updateTotaleGeneraleFromDetails(),this.totaleGenerale===0&&(typeof g.totaleOriginale<"u"||typeof c.totale<"u")){let S=Number(g.totaleOriginale??c.totale??0)||0;this.totaleGenerale=Math.round(S*100)/100}this.previousConfigurazione=this.deepClone(u)}alert("Configurazione salvata con successo.")}catch(c){throw console.error("salvaConfigurazione - errore finale:",c),c}})}resetConfigurazione(){this.currentStep=1,this.queryProspect="",Object.keys(this.moduli).forEach(t=>{let e=this.moduli[t];e.servizi.forEach(o=>{o.selezionato=!1}),e.totale=0}),this.totaleGenerale=0}getServiziSelezionatiModulo(t){return this.moduli[t].servizi.filter(o=>o.selezionato)}getTotaleModulo(t){return this.moduli[t].totale}getServiziPacchetto(t){return this.moduli[t].servizi.filter(e=>!!e.pacchetto)}getServiziSingoli(t){return this.moduli[t].servizi.filter(e=>!e.pacchetto)}getTuttiServiziSelezionati(){let t=[];return Object.keys(this.moduli).forEach(e=>{let o=this.moduli[e].servizi.filter(r=>r.selezionato);t.push(...o)}),t}procediPerFirme(){return w(this,null,function*(){if(!this.selectedProspect){alert("Seleziona prima un soggetto.");return}if(this.totaleGenerale===0){alert("Configura almeno un servizio.");return}let t=this.isProspect;if(t&&!this.pendingFirmeProcess){this.pendingFirmeProcess=!0,this.currentStep=7;return}let e=[{percorso:"assets/contratti/privacy-promethea.pdf",nomeBase:"Privacy"},{percorso:"assets/contratti/contratto-promethea.pdf",nomeBase:"Contratto Servizi Promethea"}];this.haServiziDigitaliSelezionati()&&e.push({percorso:"assets/contratti/allegato-digitale.pdf",nomeBase:"Allegato Digitale"}),this.haServiziContabiliSelezionati()&&e.push({percorso:"assets/contratti/allegato-contabile.pdf",nomeBase:"Allegato Contabile"});try{if(t&&!(yield this.convertiProspectInCliente())){alert("Errore nella conversione del prospect in cliente.");return}this.scaricaDocumenti(e),yield this.salvaConfigurazione(),t&&this.nominativi.length>0&&(yield this.creaProspectDaNominativi()),this.pendingFirmeProcess=!1,this.currentStep=t?6:this.currentStep,alert(t?"Operazione completata! Il prospect \xE8 ora cliente.":"Configurazione aggiornata con successo.")}catch(o){console.error("Errore nel processo:",o),alert("Errore durante l'operazione: "+(o?.message||"sconosciuto"))}})}convertiProspectInCliente(){return w(this,null,function*(){if(!this.selectedProspect||!this.isProspect)return!0;try{console.log("Conversione prospect in cliente:",this.selectedProspect.id);let t=yield this.soggettiService.convertiProspectInCliente(this.selectedProspect.id);return t.error?(console.error("Errore nella conversione:",t.error),!1):t.data?(this.selectedProspect=t.data,console.log("Prospect convertito in cliente con successo:",this.selectedProspect),!0):!1}catch(t){return console.error("Errore durante la conversione:",t),!1}})}aggiungiNominativo(){if(!this.nuovoNominativo.nome.trim()){alert("Il nome \xE8 obbligatorio");return}if(!this.nuovoNominativo.telefono.trim()&&!this.nuovoNominativo.email.trim()){alert("Inserire almeno il telefono o l'email");return}this.nominativi.push(L({},this.nuovoNominativo)),this.nuovoNominativo={nome:"",telefono:"",email:""}}rimuoviNominativo(t){this.nominativi.splice(t,1)}creaProspectDaNominativi(){return w(this,null,function*(){if(!(!this.nominativi||this.nominativi.length===0))for(let t of this.nominativi)try{let e={tipo:"prospect",ragioneSociale:t.nome,telefono:t.telefono||void 0,email:t.email||void 0,note:`Creato da configurazione Promethea - ${this.selectedProspect?.ragione_sociale}`,prodotto:"Promethea",referenzaDaId:this.selectedProspect?.id},o=yield this.soggettiService.createSoggetto(e);(!o||!o.success)&&(yield this.soggettiService.supabase.from("soggetti").insert([{tipo:e.tipo,ragione_sociale:e.ragioneSociale,telefono:e.telefono??null,email:e.email??null,note:e.note??null,prodotto:e.prodotto,referenza_da_id:e.referenzaDaId??null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]))}catch(e){console.error("Errore creazione prospect da nominativo:",e)}})}haServiziDigitaliSelezionati(){let t=this.moduli.digitalizzazione_automatismi.servizi.some(o=>o.selezionato),e=this.moduli.immagine_marketing.servizi.some(o=>o.selezionato&&o.id.startsWith("social_"));return t||e}haServiziContabiliSelezionati(){return this.moduli.contabilita_fiscalita.servizi.some(t=>t.selezionato)}scaricaDocumenti(t){let e=this.sanitizeFileName(this.selectedProspect.ragione_sociale);t.forEach((o,r)=>{setTimeout(()=>{let c=`${o.nomeBase} - ${e}.pdf`;this.scaricaPDF(o.percorso,c)},r*300)})}scaricaPDF(t,e){let o=document.createElement("a");o.href=t,o.download=e,o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}sanitizeFileName(t){return t.replace(/[<>:"/\\|?*]/g,"_").replace(/\s+/g," ").trim()}get isCliente(){return this.selectedProspect?.tipo==="cliente"}get isProspect(){return this.selectedProspect?.tipo==="prospect"}getCategorieContabilita(){let t=this.moduli.contabilita_fiscalita.servizi;return[...new Set(t.map(o=>o.categoria))].filter(o=>o!==void 0).sort()}getServiziByCategoria(t){return this.moduli.contabilita_fiscalita.servizi.filter(e=>e.categoria===t)}configurazioniContabilita={costituzione:{attivo:!1,serviziSelezionati:[]},contabilita:{tipo:"semplificata",registrazioni:90,prezzoCalcolato:0},fatturazione:{tipo:"emissione_noi",numeroFatture:40,prezzoCalcolato:0},iva:{liquidazione:"trimestrale",lipe:"trimestrale",volumeAffari:75e3,vistoConformita:!1,modelloIVATR:!1,intrastat:!1,prezzoCalcolato:0},redditi:{tipoSoggetto:"persone_fisiche",volumeAffari:75e3,numeroPersone:1,vistoConformita:!1,prezzoCalcolato:0},bilancio:{tipo:"attivita",importo:13e4,depositoBilancio:!1,nominaCariche:!1,prezzoCalcolato:0},altriServizi:{cuPercipienti:5,prezzoCU:180,modello770:!1,f24Numero:12,prezzoF24:300}};calcolaPrezzoContabilita(){let t=this.configurazioniContabilita.contabilita,e=t.registrazioni;switch(t.tipo){case"semplificata":e<=90?t.prezzoCalcolato=1421:e<=180?t.prezzoCalcolato=1811:e<=360?t.prezzoCalcolato=2805:t.prezzoCalcolato=2805+(e-360)*2;break;case"ordinaria":e<=600?t.prezzoCalcolato=3276:(e<=2e3,t.prezzoCalcolato=3276+(e-600)*3.38);break;case"mista":e<=600?t.prezzoCalcolato=2644:(e<=2e3,t.prezzoCalcolato=2644+(e-600)*3.38);break}t.prezzoCalcolato=Math.round(t.prezzoCalcolato*100)/100,this.calcolaTotali()}calcolaPrezzoFatturazione(){let t=this.configurazioniContabilita.fatturazione;t.tipo==="emissione_noi"?t.prezzoCalcolato=t.numeroFatture*25:t.prezzoCalcolato=t.numeroFatture*4,this.calcolaTotali()}calcolaPrezzoIVA(){let t=this.configurazioniContabilita.iva,e=0;t.liquidazione==="mensile"?e+=576:e+=280,t.lipe==="mensile"?e+=1038:e+=346,t.volumeAffari<=75e3?e+=277:t.volumeAffari<=15e4?e+=346:t.volumeAffari<=3e5?e+=439:t.volumeAffari<=5e5?e+=550:t.volumeAffari<=75e4?e+=732:e+=1208,t.vistoConformita&&(e+=287.5),t.modelloIVATR&&(e+=72),t.intrastat&&(e+=70),t.prezzoCalcolato=e,this.calcolaTotali()}calcolaPrezzoRedditi(){let t=this.configurazioniContabilita.redditi,e=0;t.tipoSoggetto==="persone_fisiche"?t.volumeAffari<=75e3?e=440:t.volumeAffari<=15e4?e=659:t.volumeAffari<=3e5?e=879:t.volumeAffari<=5e5?e=1096.5:t.volumeAffari<=75e4?e=1317:e=1645.5:t.volumeAffari<=3e5?e=916.5:t.volumeAffari<=5e5?e=1372.5:t.volumeAffari<=15e5?e=1830:t.volumeAffari<=3e6?e=2285:t.volumeAffari<=5e6?e=2744:t.volumeAffari<=75e5?e=3201.5:e=4e3,t.tipoSoggetto==="persone_fisiche"&&(e*=t.numeroPersone),t.vistoConformita&&(e+=287.5),t.prezzoCalcolato=e,this.calcolaTotali()}calcolaPrezzoBilancio(){let t=this.configurazioniContabilita.bilancio,e=0;t.tipo==="attivita"?t.importo<=13e4?e=453.5:t.importo<=5e5?e=765.5:t.importo<=13e5?e=1184:t.importo<=26e5?e=1739.5:t.importo<=575e4?e=2435:e=3e3:t.importo<=3e5?e=590:t.importo<=5e5?e=765.5:t.importo<=15e5?e=905:t.importo<=3e6?e=1218:t.importo<=5e6?e=1739.5:t.importo<=75e5?e=2435:e=3e3,t.depositoBilancio&&(e+=350),t.nominaCariche&&(e+=420),t.prezzoCalcolato=e,this.calcolaTotali()}calcolaPrezzoCU(){let t=this.configurazioniContabilita.altriServizi;t.cuPercipienti<=5?t.prezzoCU=180:t.cuPercipienti<=10?t.prezzoCU=330:t.cuPercipienti<=15?t.prezzoCU=480:t.cuPercipienti<=20?t.prezzoCU=630:t.prezzoCU=630+(t.cuPercipienti-20)*30,t.f24Numero<=12?t.prezzoF24=300:t.f24Numero<=24?t.prezzoF24=600:t.f24Numero<=36?t.prezzoF24=900:t.prezzoF24=900+(t.f24Numero-36)*25,this.calcolaTotali()}calcolaTotali(){Object.keys(this.moduli).forEach(t=>{let e=this.moduli[t];if(t==="contabilita_fiscalita"){let o=e.servizi.filter(u=>u.selezionato&&u.tipo==="fisso").reduce((u,g)=>u+g.prezzo,0),r=u=>!!e.servizi.find(g=>g.id===u&&g.selezionato),c=0;r("contabilita_principale")&&(c+=this.configurazioniContabilita.contabilita.prezzoCalcolato||0),r("fatturazione_principale")&&(c+=this.configurazioniContabilita.fatturazione.prezzoCalcolato||0),r("iva_principale")&&(c+=this.configurazioniContabilita.iva.prezzoCalcolato||0),r("redditi_principale")&&(c+=this.configurazioniContabilita.redditi.prezzoCalcolato||0),r("bilancio_principale")&&(c+=this.configurazioniContabilita.bilancio.prezzoCalcolato||0),!e.servizi.some(u=>u.selezionato)&&c===0?e.totale=0:e.totale=Math.round((o+c)*100)/100}else e.totale=e.servizi.filter(o=>o.selezionato).reduce((o,r)=>o+r.prezzo,0)}),this.totaleGenerale=Object.keys(this.moduli).reduce((t,e)=>t+this.moduli[e].totale,0),this.totaleGenerale=Math.round(this.totaleGenerale*100)/100}toggleServizioContabilita(t){t.tipo==="gruppo"?(t.selezionato=!t.selezionato,t.id==="costituzione_principale"&&(this.configurazioniContabilita.costituzione.attivo=t.selezionato)):t.selezionato=!t.selezionato,this.calcolaTotali()}isServizioContabilitaAbilitato(t){return t.dipendeDa?this.moduli.contabilita_fiscalita.servizi.find(o=>o.id===t.dipendeDa)?.selezionato||!1:!0}deepClone(t){return t==null?t:JSON.parse(JSON.stringify(t))}visualizzaPreventivo(){this.configurazioneCorrenteId?this.router.navigate(["/preventivo",this.configurazioneCorrenteId]):this.salvaConfigurazione().then(()=>{this.configurazioneCorrenteId&&this.router.navigate(["/preventivo",this.configurazioneCorrenteId])}).catch(t=>{console.error("Errore nel salvataggio della configurazione:",t),alert("Errore nel salvataggio. Impossibile generare il preventivo.")})}getResponseDelay(){return this.baseAssistDelay+Math.floor(Math.random()*this.assistJitter)}apriChatSconto(){this.mostraChatSconto=!0,this.messaggiAssistenza=[],this.richiedendoSconto=!1,this.addMessage(`Ciao! Sono l'assistenza Promethea. Dimmi quale sconto desideri richiedere per ${this.selectedProspect?.ragione_sociale||"il cliente"}.`,"assistenza"),setTimeout(()=>{document.getElementById("chat-input")?.focus()},120)}chiudiChatSconto(){this.mostraChatSconto=!1,this.messaggioChat=""}inviaMessaggio(){let t=this.messaggioChat?.trim();t&&(this.addMessage(t,"utente"),this.messaggioChat="",setTimeout(()=>this.handleAssistantReply(t),this.getResponseDelay()))}addMessage(t,e){this.messaggiAssistenza.push({testo:t,autore:e,timestamp:new Date}),setTimeout(()=>this.scrollChatToBottom(),30)}scrollChatToBottom(){let t=document.getElementById("chat-messages");if(t)try{t.scrollTo({top:t.scrollHeight,behavior:"smooth"})}catch{t.scrollTop=t.scrollHeight}}handleAssistantReply(t){return w(this,null,function*(){let e=(t||"").toLowerCase().trim();if(this.pendingCifraRequest){let c=/^\s*(s|si|yes|y)\b/i.test(e),p=/^\s*(n|no|not)\b/i.test(e);if(c){yield this.confirmPendingCifra(!0);return}if(p){yield this.confirmPendingCifra(!1);return}this.addMessage(`Rispondi "si" per confermare l'applicazione dello sconto o "no" per annullare.`,"assistenza");return}let o=/^\s*[0-9\.\,]+\s*%?\s*$/.test(e);if(e.includes("sconto")||e.includes("cifra")||e.includes("totale")||o||this.richiedendoSconto){this.processDiscountRequest(e);return}this.addMessage('Capito. Se vuoi applicare uno sconto scrivi "sconto 10%" o solo "10%". Posso aiutarti anche a verificare se \xE8 possibile approvarlo.',"assistenza")})}confirmPendingCifra(t){return w(this,null,function*(){if(!this.pendingCifraRequest)return;let e=this.pendingCifraRequest;if(this.pendingCifraRequest=null,!t){this.addMessage("Operazione annullata. Lo sconto non \xE8 stato applicato.","assistenza");return}this.scontoPercentuale=e.candidatePercent;try{yield this.salvaConfigurazione(),this.addMessage(`Sconto applicato: ${Number(this.scontoPercentuale.toFixed(4))}%. Totale salvato: ${this.formatCurrency(this.totaleScontato)}.`,"assistenza")}catch(o){console.error("Errore durante conferma e salvataggio sconto:",o),this.addMessage("Errore durante il salvataggio dello sconto. Riprova.","assistenza")}})}processDiscountRequest(t){let e=/(?:\bcifra\b|\btotale\b)\s*[:=]?\s*([0-9\.\,]+)/i,o=t.match(e);if(o){let u=o[1],g=this.parseItalianNumber(u);if(isNaN(g)){this.addMessage('Non ho capito la cifra richiesta. Inserisci un valore numerico (es. "cifra 5.000" o "totale 5000").',"assistenza");return}this.tryApplyCifra(g);return}let r=t.match(/([0-9\.\,]+)\s*%/);if(r){let u=Math.round(Number(this.parseItalianNumber(r[1]))*100)/100,g=Math.min(100,Math.max(0,Math.round(u))),S=18;g<=S?(this.scontoPercentuale=g,this.richiedendoSconto=!1,this.addMessage(`\u2705 OK \u2014 applicato sconto ${g}%. Totale: ${this.formatCurrency(this.totaleScontato)}`,"assistenza")):this.addMessage(`\u26A0\uFE0F Lo sconto richiesto (${g}%) supera il limite automatico del ${S}%. Vuoi inviare una richiesta di approvazione?`,"assistenza");return}let c=t.match(/\bsconto\b[^\d\-]*([0-9\.\,]+)/i);if(c){let u=c[1],g=this.parseItalianNumber(u);if(isNaN(g)){this.addMessage('Non ho capito il valore dopo "sconto". Usa "sconto 10%" oppure "sconto 5000" per indicare un totale finale.',"assistenza");return}if(g<=100){let S=Math.min(100,Math.max(0,Math.round(g))),M=18;S<=M?(this.scontoPercentuale=S,this.richiedendoSconto=!1,this.addMessage(`\u2705 OK \u2014 applicato sconto ${S}%. Totale: ${this.formatCurrency(this.totaleScontato)}`,"assistenza")):this.addMessage(`\u26A0\uFE0F Lo sconto richiesto (${S}%) supera il limite automatico del ${M}%. Vuoi inviare una richiesta di approvazione?`,"assistenza")}else this.tryApplyCifra(g);return}let p=t.match(/^\s*([0-9\.\,]+)\s*$/);if(p){let u=this.parseItalianNumber(p[1]);if(isNaN(u)){this.addMessage('Non ho capito il numero. Scrivi "10%" o "cifra 5000".',"assistenza");return}if(u<=100){let g=Math.min(100,Math.max(0,Math.round(u))),S=18;g<=S?(this.scontoPercentuale=g,this.richiedendoSconto=!1,this.addMessage(`\u2705 OK \u2014 applicato sconto ${g}%. Totale: ${this.formatCurrency(this.totaleScontato)}`,"assistenza")):this.addMessage(`\u26A0\uFE0F Lo sconto richiesto (${g}%) supera il limite automatico del ${S}%. Vuoi inviare una richiesta di approvazione?`,"assistenza")}else this.tryApplyCifra(u);return}this.richiedendoSconto?this.addMessage('Non ho capito. Scrivi "10%" o "cifra 5000".',"assistenza"):(this.richiedendoSconto=!0,this.addMessage('Dimmi quale sconto desideri: scrivi una percentuale (es. "10%" o "10") oppure una cifra finale (es. "cifra 5000" o "5000"). Posso verificare se rientra nel limite automatico del 18%.',"assistenza"))}tryApplyCifra(t){if(!this.totaleGenerale||this.totaleGenerale<=0){this.addMessage("Impossibile calcolare lo sconto: il totale di partenza \xE8 zero.","assistenza");return}if(t=Math.round(t*100)/100,t>=this.totaleGenerale){this.addMessage(`La cifra richiesta (${this.formatCurrency(t)}) \xE8 uguale o superiore al totale attuale (${this.formatCurrency(this.totaleGenerale)}). Nessuno sconto necessario.`,"assistenza");return}if(t<=0){this.addMessage("La cifra richiesta non \xE8 valida. Inserisci un valore maggiore di 0.","assistenza");return}let e=(this.totaleGenerale-t)/this.totaleGenerale*100,o=18;if(e>o){let V=Math.round(this.totaleGenerale*(1-o/100)*100)/100;this.addMessage(`\u274C Non posso applicare la cifra richiesta: servirebbe uno sconto del ${Number(e.toFixed(2))}%, oltre il limite automatico del ${o}%. Il massimo applicabile automaticamente \xE8 ${o}% (totale minimo: ${this.formatCurrency(V)}). Vuoi inviare una richiesta di approvazione?`,"assistenza");return}let r=.005,c=(1-(t+r)/this.totaleGenerale)*100,p=(1-(t-r)/this.totaleGenerale)*100,u=Math.min(c,p),g=Math.max(c,p),S=Math.max(0,u),M=Math.min(o,g),h=V=>Math.round(this.totaleGenerale*(1-V/100)*100)/100,A=Number(e.toFixed(8)),T=h(A);if(T===t&&A<=o){this.pendingCifraRequest={desiredTotal:t,candidatePercent:A,producedTotal:T},this.richiedendoSconto=!1,this.addMessage(`\u2705 Posso applicare la cifra richiesta. Questo corrisponde a uno sconto del ${Number(e.toFixed(4))}% (applicabile: ${Number(A.toFixed(4))}%). Totale risultante: ${this.formatCurrency(T)}. Vuoi procedere? Rispondi "si" per applicare o "no" per annullare.`,"assistenza");return}let N=null;if(M>=S){let xe=Math.max((M-S)/2e3,1e-5);for(let D=S;D<=M;D+=xe)if(h(D)===t){N=Number(D.toFixed(8));break}}if(N!==null){let V=h(N);this.pendingCifraRequest={desiredTotal:t,candidatePercent:N,producedTotal:V},this.richiedendoSconto=!1,this.addMessage(`\u2705 Posso applicare la cifra richiesta. Questo corrisponde a uno sconto del ${Number(N.toFixed(4))}%. Totale risultante: ${this.formatCurrency(V)}. Vuoi procedere? Rispondi "si" per applicare o "no" per annullare.`,"assistenza");return}let F=Math.max(0,Math.min(o,e));F=Number(F.toFixed(6));let B=h(F);this.pendingCifraRequest={desiredTotal:t,candidatePercent:F,producedTotal:B},this.richiedendoSconto=!1,this.addMessage(`\u26A0\uFE0F Non \xE8 possibile ottenere esattamente ${this.formatCurrency(t)} dopo arrotondamenti. Posso applicare lo sconto pi\xF9 vicino: ${Number(F.toFixed(4))}% \u2192 Totale risultante: ${this.formatCurrency(B)}. Vuoi procedere? Rispondi "si" per applicare o "no" per annullare.`,"assistenza")}parseItalianNumber(t){if(!t||typeof t!="string")return NaN;let e=t.trim().replace(/\s+/g,"");e.indexOf(".")!==-1&&e.indexOf(",")!==-1?e=e.replace(/\./g,"").replace(",","."):e.indexOf(",")!==-1&&e.indexOf(".")===-1?e=e.replace(",","."):e=e.replace(/[^\d\.]/g,"");let o=parseFloat(e);return isFinite(o)?o:NaN}get totaleScontato(){let t=this.totaleGenerale*this.scontoPercentuale/100;return Math.round((this.totaleGenerale-t)*100)/100}formatCurrency(t){return`\u20AC ${Number(t||0).toLocaleString("it-IT",{minimumFractionDigits:2,maximumFractionDigits:2})}`}applySconto(t){this.scontoPercentuale=Math.max(0,Math.min(100,Math.round(Number(t)*100)/100))}confermaApplicaSconto(){return w(this,null,function*(){try{yield this.salvaConfigurazione(),this.addMessage(`Sconto del ${this.scontoPercentuale}% applicato e salvato. Totale finale: ${this.formatCurrency(this.totaleScontato)}`,"assistenza"),this.mostraChatSconto=!1}catch(t){console.error("Errore salvataggio sconto:",t),this.addMessage("Errore nel salvataggio dello sconto. Riprova.","assistenza")}})}rimuoviSconto(){this.scontoPercentuale=0}formatPrezzoServizio(t){let e=Number(t?.prezzo??0);return t?.id==="software_personalizzato"&&e===0?"Valutazione Interna":`\u20AC ${e.toLocaleString("it-IT",{minimumFractionDigits:2,maximumFractionDigits:2})}`}formatTotaleModulo(t){let e=this.moduli?.[t];if(!e)return"\u2014";let o=e.servizi.filter(h=>h.selezionato).reduce((h,A)=>h+(Number(A.prezzo)||0),0),r=this.previousConfigurazione??null,c=0,p=[];if(r&&r[t]){let h=r[t];p=Array.isArray(h.servizi_selezionati)?h.servizi_selezionati:Array.isArray(h.servizi)?h.servizi:[],typeof h.totale<"u"&&h.totale!==null?c=Number(h.totale)||0:p.length>0&&(c=p.reduce((A,T)=>A+(Number(T?.prezzo)||0),0))}let u=Number(e.totale)||0,g=Math.max(o,c,u);return[...e.servizi.filter(h=>h.selezionato),...p].some(h=>h?.id==="software_personalizzato"&&(Number(h?.prezzo)||0)===0)?"Valutazione Interna":`\u20AC ${g.toLocaleString("it-IT",{minimumFractionDigits:2,maximumFractionDigits:2})}`}getNumericTotaleModulo(t){let e=this.moduli?.[t];if(!e)return 0;let o=e.servizi.filter(u=>u.selezionato).reduce((u,g)=>u+(Number(g.prezzo)||0),0),r=this.previousConfigurazione??null,c=0;if(r&&r[t]){let u=r[t],g=Array.isArray(u.servizi_selezionati)?u.servizi_selezionati:Array.isArray(u.servizi)?u.servizi:[];typeof u.totale<"u"&&u.totale!==null?c=Number(u.totale)||0:g.length>0&&(c=g.reduce((S,M)=>S+(Number(M?.prezzo)||0),0))}let p=Number(e.totale)||0;return Math.round(Math.max(o,c,p)*100)/100}updateTotaleGeneraleFromDetails(){let e=["immagine_marketing","digitalizzazione_automatismi","contabilita_fiscalita","ottimizzazione_management"].reduce((o,r)=>o+this.getNumericTotaleModulo(r),0);this.totaleGenerale=Math.round(e*100)/100}static \u0275fac=function(e){return new(e||l)(O(fe),O(ve),O(oe),O(ne),O(ae))};static \u0275cmp=G({type:l,selectors:[["app-alchemizzatore"]],decls:22,vars:19,consts:[["noSconto",""],[1,"alchemizzatore-container"],[1,"form-section"],[1,"progress-steps"],[1,"step",3,"click"],["class","form-section form-section",4,"ngIf"],[1,"form-section","form-section"],[1,"section-header"],[1,"material-icons","header-icon"],[1,"section-titles"],[1,"section-title"],[1,"card"],[1,"form-label"],[1,"search-input-container"],["type","text","placeholder","Cerca per ragione sociale, P.IVA o referente...",3,"ngModelChange","input","ngModel"],["class","status-message loading",4,"ngIf"],["class","status-message error",4,"ngIf"],["class","search-results","role","listbox",4,"ngIf"],["class","status-message info",4,"ngIf"],["class","status-message warning",4,"ngIf"],[1,"actions-container"],[1,"promethea-button",3,"click","disabled"],[1,"status-message","loading"],[1,"loading-spinner"],[1,"status-message","error"],["role","listbox",1,"search-results"],["class","search-result-item","role","option",3,"click",4,"ngFor","ngForOf"],["role","option",1,"search-result-item",3,"click"],[1,"result-text"],[1,"result-title"],[1,"result-subtitle"],[1,"result-icon"],[1,"status-message","info"],[1,"material-icons"],[1,"status-message","warning"],[1,"sottotitolo"],[1,"section-title","sotto"],[1,"grid-responsive"],["class","card ",3,"selezionato","disabled","click",4,"ngFor","ngForOf"],["class","card ",3,"selezionato","click",4,"ngFor","ngForOf"],[1,"card","totale-modulo"],[1,"promethea-button","secondary",3,"click"],[1,"promethea-button",3,"click"],[1,"card",3,"click"],["aria-hidden","false",1,"card-title"],[1,"card-number"],[1,"servizio-descrizione"],["class","chip",4,"ngIf"],[1,"checkmark"],[1,"chip"],[1,"categorie-contabilita"],[1,"categoria-contabilita"],[1,"configurazione-gruppo"],[1,"card","card-clickable",3,"click"],[1,"card-title"],[1,"card-number","card-number"],[4,"ngIf"],[1,"grid-form"],[1,"form-field"],[1,"table-inline-select",3,"ngModelChange","change","ngModel"],["value","semplificata"],["value","ordinaria"],["value","mista"],["type","number","min","1","max","10000",1,"table-inline-input",3,"ngModelChange","change","ngModel"],["value","emissione_noi"],["value","piattaforma_passcom"],["type","number","min","1","max","1000",1,"table-inline-input",3,"ngModelChange","change","ngModel"],["value","trimestrale"],["value","mensile"],["value","75000"],["value","150000"],["value","300000"],["value","500000"],["value","750000"],["value","1000000"],[1,"form-field","checkbox"],["type","checkbox",3,"ngModelChange","change","ngModel"],[1,"categoria-title"],["class","card",3,"selezionato","disabled","click",4,"ngFor","ngForOf"],["class","card ",3,"hidden","selezionato","disabled","click",4,"ngFor","ngForOf"],[1,"card",3,"click","hidden"],["class","card",4,"ngIf"],[1,"card","text-center"],["role","status","aria-live","polite",1,"totale-generale-wrapper"],[1,"label","totale-normale"],[4,"ngIf","ngIfElse"],[1,"actions-container",2,"margin","var(--gutter-lg)","justify-content","center"],[1,"promethea-button","ghost",3,"click"],["title","Assistenza",1,"promethea-button","ghost",3,"click"],[1,"promethea-button","outline",3,"click"],["class","promethea-button success",3,"click",4,"ngIf"],[1,"promethea-button","success",3,"click","disabled"],["class","form-section",4,"ngIf"],["class","modal-backdrop",4,"ngIf"],["class","servizio-riepilogo",4,"ngFor","ngForOf"],[1,"card-number","totale"],[1,"servizio-riepilogo"],[1,"servizio-left"],[1,"badge","badge-primary"],[1,"card-servizio"],[1,"card-number","servizio"],[1,"badge","badge-secondary"],[1,"badge","badge-info"],["title","Totale scontato",1,"totale-scontato"],["title","Totale originale non scontato",1,"totale-originale"],[1,"text-muted"],[1,"totale-normale"],[1,"promethea-button","success",3,"click"],[1,"sconto-display"],["class","sconto-value",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"actions"],["class","promethea-button secondary",3,"click",4,"ngIf"],["class","promethea-button ghost",3,"click",4,"ngIf"],[1,"totale-riepilogo"],[1,"totale-value"],["class","form-field",4,"ngIf"],[1,"sconto-value"],[1,"totale-value","text-muted"],[1,"modal-backdrop"],[1,"modal"],[1,"modal-header"],[1,"modal-title"],[1,"icon-btn","close",3,"click"],[1,"modal-body",2,"display","flex","flex-direction","column","height","calc(100% - 120px)"],["id","modal-body",1,"modal-body",2,"flex","1","overflow-y","auto","margin-bottom","var(--gutter-md)"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"form-field",2,"display","flex","gap","var(--gutter-sm)"],["id","form-field","type","text","placeholder","Scrivi il tuo messaggio...",1,"table-inline-input",2,"flex","1",3,"ngModelChange","keyup.enter","ngModel"],[3,"ngClass"],[1,"badge"],["class","material-icons",4,"ngIf"],[1,"message-content"],[1,"card",2,"margin-top","var(--gutter-lg)"],["type","text","placeholder","Nome e cognome",1,"form-input",3,"ngModelChange","ngModel"],["type","tel","placeholder","Telefono",1,"form-input",3,"ngModelChange","ngModel"],["type","email","placeholder","Email",1,"form-input",3,"ngModelChange","ngModel"],["class","card","style","margin-top: var(--gutter-md);",4,"ngIf"],[1,"card",2,"margin-top","var(--gutter-md)"],[1,"text-muted",2,"margin-left","0.6rem"],[1,"actions-container",2,"justify-content","flex-end"],[1,"action-btn","delete",3,"click"]],template:function(e,o){e&1&&(i(0,"div",1)(1,"div",2)(2,"div",3)(3,"button",4),f("click",function(){return o.vaiAStep(1)}),a(4,"1"),n(),i(5,"button",4),f("click",function(){return o.vaiAStep(2)}),a(6,"2"),n(),i(7,"button",4),f("click",function(){return o.vaiAStep(3)}),a(8,"3"),n(),i(9,"button",4),f("click",function(){return o.vaiAStep(4)}),a(10,"4"),n(),i(11,"button",4),f("click",function(){return o.vaiAStep(5)}),a(12,"5"),n(),i(13,"button",4),f("click",function(){return o.vaiAStep(6)}),a(14,"6"),n()()(),x(15,Pe,20,9,"section",5)(16,Ve,25,3,"section",5)(17,Fe,25,3,"section",5)(18,Xe,141,21,"section",5)(19,ot,29,4,"section",5)(20,Mt,41,12,"section",5)(21,Vt,30,5,"section",5),n()),e&2&&(s(3),C("active",o.currentStep===1),s(2),C("active",o.currentStep===2),s(2),C("active",o.currentStep===3),s(2),C("active",o.currentStep===4),s(2),C("active",o.currentStep===5),s(2),C("active",o.currentStep===6),s(2),d("ngIf",o.currentStep===1),s(),d("ngIf",o.currentStep===2),s(),d("ngIf",o.currentStep===3),s(),d("ngIf",o.currentStep===4),s(),d("ngIf",o.currentStep===5),s(),d("ngIf",o.currentStep===6),s(),d("ngIf",o.currentStep===7))},dependencies:[ie,Y,K,X,ge,pe,ue,le,me,re,de,se,_e,ze,ce,te,ee,Z],styles:[".alchemizzatore-container[_ngcontent-%COMP%]{padding:var(--gutter-lg)}.trattativa-section[_ngcontent-%COMP%]{margin:var(--gutter-lg) 0}.section-title.sotto[_ngcontent-%COMP%]{margin-top:var(--gutter-lg);margin-bottom:var(--gutter-md)}.servizio-descrizione[_ngcontent-%COMP%]{color:color-mix(in srgb,var(--text-color) 70%,transparent);font-size:var(--fs-sm);margin:0 0 var(--gutter-sm) 0;line-height:1.4}.checkmark[_ngcontent-%COMP%]{position:absolute;top:var(--gutter-md);right:var(--gutter-md);width:24px;height:24px;border:2px solid var(--smoke-color-1);border-radius:50%;display:grid;place-items:center;color:transparent;transition:all .2s ease;background:transparent}.checkmark.attivo[_ngcontent-%COMP%]{background:var(--primary);border-color:var(--primary);color:#fff}.totale-modulo[_ngcontent-%COMP%]{font-weight:700;text-align:right;color:var(--primary);border-top:1px solid var(--smoke-color-1);padding-top:var(--gutter-sm);margin-top:var(--gutter-sm);font-size:var(--fs-md)}.promethea-button.success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669)}.actions-container[_ngcontent-%COMP%]{margin-top:var(--gutter-sm)}.card-number[_ngcontent-%COMP%]{font-size:var(--fs-md)}.card-number.servizio[_ngcontent-%COMP%]{color:var(--text-color);font-size:var(--fs-sm)}.card-number.totale[_ngcontent-%COMP%]{margin-top:var(--gutter-md);text-align:right}.categoria-contabilita[_ngcontent-%COMP%]{padding:var(--gutter-lg) 0;margin-bottom:var(--gutter-lg)}.grid-responsive[_ngcontent-%COMP%]{margin-top:var(--gutter-sm)}.servizi-elenco[_ngcontent-%COMP%]{margin-bottom:var(--gutter-sm);display:flex;flex-direction:column;gap:.5rem}.servizio-riepilogo[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:var(--gutter-sm);padding:var(--gutter-sm) 0;border-bottom:1px dashed color-mix(in srgb,var(--text-color) 80%,transparent)}.servizio-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.6rem;min-width:0}.servizio-nome[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:var(--text-color);font-weight:600}.servizio-price[_ngcontent-%COMP%]{color:var(--primary);font-weight:700;margin-left:1rem;white-space:nowrap}@media (min-width: 1100px){.grid-responsive[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}.user-message[_ngcontent-%COMP%]{flex-direction:row-reverse}.assistance-message[_ngcontent-%COMP%]{flex-direction:row}.user-message[_ngcontent-%COMP%]   .message-avatar[_ngcontent-%COMP%]{background:var(--primary);color:#fff}.assistance-message[_ngcontent-%COMP%]   .message-avatar[_ngcontent-%COMP%]{background:var(--smoke-color-1);color:var(--text-color)}.message-content[_ngcontent-%COMP%]{max-width:70%;display:flex;flex-direction:column;gap:.25rem}.user-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{align-items:flex-end}.assistance-message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{align-items:flex-start}.user-message[_ngcontent-%COMP%]   .message-text[_ngcontent-%COMP%]{background:var(--primary);color:#fff;border-bottom-right-radius:4px}.assistance-message[_ngcontent-%COMP%]   .message-text[_ngcontent-%COMP%]{background:var(--smoke-color-1);color:var(--text-color);border-bottom-left-radius:4px}.sconto-display[_ngcontent-%COMP%]{padding:var(--gutter-sm);border-radius:8px;background:color-mix(in srgb,var(--success) 10%,transparent);border:1px solid color-mix(in srgb,var(--success) 30%,transparent)}.sconto-value[_ngcontent-%COMP%]{color:var(--success);font-weight:600}.totale-value.scontato[_ngcontent-%COMP%]{font-size:var(--fs-md)}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--smoke-color-1);border-radius:3px}.chat-messages[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.totale-generale-wrapper[_ngcontent-%COMP%]{display:flex;align-items:baseline;justify-content:center;gap:.6rem;flex-wrap:wrap}.totale-generale-wrapper[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{margin-right:.25rem;color:var(--text-muted);font-weight:600}.totale-scontato[_ngcontent-%COMP%]{color:var(--primary);font-weight:800;font-size:1.25rem}.totale-originale[_ngcontent-%COMP%]{text-decoration:line-through;color:var(--text-muted);opacity:.85;margin-left:.4rem}.totale-normale[_ngcontent-%COMP%]{font-weight:700;font-size:var(--fs-lg)}@media (max-width:640px){.totale-generale-wrapper[_ngcontent-%COMP%]{flex-direction:column;gap:.2rem;text-align:center}.totale-originale[_ngcontent-%COMP%]{margin-left:0}}.card.text-center[_ngcontent-%COMP%]{margin-top:var(--gutter-lg)}"]})};export{he as Alchemizzatore};
