import{b as f}from"./chunk-Q4FMGKSF.js";import{o as g}from"./chunk-NOCF4HQD.js";import{N as u,S as p}from"./chunk-PE6PP35I.js";import{a as s,b as c,i as o}from"./chunk-ODN5LVDJ.js";var m=class n{supabaseService=p(f);router=p(g);salvaConfigurazione(e,a){return o(this,null,function*(){let r=new Date().toISOString();if(a){let{data:d,error:l}=yield this.supabaseService.supabase.from("configurazioni_promethea").update(c(s({},e),{updated_at:r})).eq("id",a).select().single();return{data:d,error:l}}let{data:i,error:t}=yield this.supabaseService.supabase.from("configurazioni_promethea").insert([c(s({},e),{created_at:r,updated_at:r})]).select().single();return{data:i,error:t}})}getConfigurazioniByProspect(e){return o(this,null,function*(){let{data:a,error:r}=yield this.supabaseService.supabase.from("configurazioni_promethea").select("*").eq("prospect_id",e).order("created_at",{ascending:!1});return{data:a,error:r}})}getConfigurazioneById(e){return o(this,null,function*(){let{data:a,error:r}=yield this.supabaseService.supabase.from("configurazioni_promethea").select("*").eq("id",e).single();return{data:a,error:r}})}vaiAConfigurazionePromethea(e,a){this.router.navigate(["/alchemizzatore"],{queryParams:{prospectId:e.id,step:6},state:{prospect:e,goToStep:6,from:a}})}verificaConfigurazioniPromethea(e){return o(this,null,function*(){if(!e.length)return new Map;let{data:a,error:r}=yield this.supabaseService.supabase.from("configurazioni_promethea").select("prospect_id").in("prospect_id",e);if(r)return console.error("Errore verifica configurazioni Promethea:",r),new Map;let i=new Map;return e.forEach(t=>i.set(t,!1)),a&&a.forEach(t=>{t.prospect_id&&i.set(t.prospect_id,!0)}),i})}calcolaPrezzoServizio(e,a){switch(e){case"contab_sempl_90":return 1421;case"contab_sempl_180":return 1811;default:return 0}}static \u0275fac=function(a){return new(a||n)};static \u0275prov=u({token:n,factory:n.\u0275fac,providedIn:"root"})};export{m as a};
