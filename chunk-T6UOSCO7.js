import{a as A}from"./chunk-VZ4X25J2.js";import"./chunk-K3JKJW2Z.js";import{p as F,q as N,v as $}from"./chunk-DITEEB7V.js";import"./chunk-7SDV3Z56.js";import{r as O}from"./chunk-G7C3XVRV.js";import{Ab as m,Ga as d,Jb as y,Lb as a,Ma as k,Mb as E,Nb as h,Sa as T,X as c,Y as p,ea as b,hb as g,hc as M,ib as x,jb as w,kb as S,lb as D,mb as C,nb as i,ob as t,pb as V,wb as _,zb as v}from"./chunk-S7YZFXYO.js";import"./chunk-X5YLR3NI.js";import{a as u,b as f,i as I}from"./chunk-ODN5LVDJ.js";var L=(l,n)=>n.id;function q(l,n){if(l&1){let e=_();i(0,"button",19),v("click",function(){let r=c(e).$implicit,s=m();return p(s.selectModule(r))}),i(1,"span",20),a(2,"folder"),t(),a(3),t()}if(l&2){let e=n.$implicit,o=m();y("active",o.selectedModule()===e),d(3),h(" ",e," ")}}function B(l,n){l&1&&(i(0,"div",12),V(1,"div",21),i(2,"span"),a(3,"Caricamento..."),t()())}function P(l,n){if(l&1){let e=_();i(0,"div",22),v("click",function(){let r=c(e).$implicit,s=m();return p(s.selectIntervista(r))}),i(1,"div",23)(2,"span",24),a(3),t(),i(4,"span",25),a(5),t()(),i(6,"div",26)(7,"span",27),a(8,"category"),t(),i(9,"span",28),a(10),t()()()}if(l&2){let e,o=n.$implicit,r=m();y("active",((e=r.selectedIntervista())==null?null:e.id)===o.id),d(3),E(o.nome),d(2),E(o.domande.length),d(5),E(o.modulo)}}function R(l,n){l&1&&(i(0,"div",14)(1,"span",29),a(2,"assignment"),t(),i(3,"p"),a(4,"Nessuna intervista per questo modulo"),t()())}function G(l,n){if(l&1&&(i(0,"div",38)(1,"div",40)(2,"span",4),a(3,"info"),t(),a(4," Descrizione "),t(),i(5,"p",44),a(6),t()()),l&2){let e=m(2);d(6),h(" ",e.selectedIntervista().descrizione," ")}}function H(l,n){l&1&&(i(0,"span",49),a(1,"Obbligatoria"),t())}function J(l,n){if(l&1&&(i(0,"span",58),a(1),t()),l&2){let e=n.$implicit;d(),E(e)}}function K(l,n){if(l&1&&(i(0,"div",54)(1,"div",56)(2,"span",4),a(3,"list"),t(),a(4," Opzioni disponibili "),t(),i(5,"div",57),S(6,J,2,1,"span",58,w),t()()),l&2){let e=m().$implicit;d(6),D(e.opzioni)}}function Q(l,n){if(l&1&&(i(0,"div",55)(1,"span",27),a(2,"text_fields"),t(),i(3,"span",59),a(4),t()()),l&2){let e=m().$implicit;d(4),h(" Massimo ",e.max_caratteri," caratteri ")}}function U(l,n){if(l&1){let e=_();i(0,"div",42)(1,"div",45)(2,"div",46)(3,"span",47),a(4),t(),i(5,"span",48),a(6),t(),g(7,H,2,0,"span",49),t(),i(8,"div",50)(9,"button",51),v("click",function(){let r=c(e).$implicit,s=m(2);return p(s.editDomanda(r))}),i(10,"span",4),a(11,"edit"),t()(),i(12,"button",52),v("click",function(){let r=c(e).$implicit,s=m(2);return p(s.deleteDomanda(r))}),i(13,"span",4),a(14,"delete"),t()()()(),i(15,"p",53),a(16),t(),g(17,K,8,0,"div",54),g(18,Q,5,1,"div",55),t()}if(l&2){let e=n.$implicit,o=m(2);d(4),h("#",e.ordine),d(2),E(o.getTipoDisplay(e.tipo)),d(),x(e.obbligatoria?7:-1),d(9),h(" ",e.testo," "),d(),x(e.opzioni&&e.opzioni.length>0?17:-1),d(),x(e.max_caratteri?18:-1)}}function W(l,n){if(l&1){let e=_();i(0,"div",43)(1,"span",60),a(2,"quiz"),t(),i(3,"h3",61),a(4,"Nessuna domanda creata"),t(),i(5,"p",62),a(6," Inizia creando la prima domanda per la tua intervista "),t(),i(7,"button",37),v("click",function(){c(e);let r=m(2);return p(r.addDomanda())}),i(8,"span",4),a(9,"add_circle"),t(),a(10," Crea la prima domanda "),t()()}}function X(l,n){if(l&1){let e=_();i(0,"div",16)(1,"div",30)(2,"div",3)(3,"span",4),a(4,"description"),t()(),i(5,"div",31)(6,"h1",32),a(7),t(),i(8,"div",33)(9,"span",34),a(10),t(),i(11,"span",35)(12,"span",36),a(13,"format_list_numbered"),t(),a(14),t()()(),i(15,"button",37),v("click",function(){c(e);let r=m();return p(r.addDomanda())}),i(16,"span",4),a(17,"add_circle"),t(),a(18," Nuova Domanda "),t()(),g(19,G,7,1,"div",38),i(20,"div",39)(21,"div",40)(22,"span",4),a(23,"question_answer"),t(),a(24," Domande dell'Intervista "),t(),i(25,"div",41),S(26,U,19,6,"div",42,L,!1,W,11,0,"div",43),t()()()}if(l&2){let e=m();d(7),h(" ",e.selectedIntervista().nome," "),d(3),E(e.selectedIntervista().modulo),d(4),h(" ",e.selectedIntervista().domande.length," domande "),d(5),x(e.selectedIntervista().descrizione?19:-1),d(7),D(e.selectedIntervista().domande)}}function Y(l,n){if(l&1){let e=_();i(0,"div",17)(1,"span",60),a(2,"assignment"),t(),i(3,"h2",61),a(4,"Nessuna intervista selezionata"),t(),i(5,"p",63),a(6," Seleziona un'intervista dalla sidebar oppure creane una nuova per iniziare "),t(),i(7,"button",37),v("click",function(){c(e);let r=m();return p(r.creaNuovaIntervista())}),i(8,"span",4),a(9,"add"),t(),a(10," Crea Nuova Intervista "),t()()}}function Z(l,n){if(l&1){let e=_();i(0,"div",89),a(1),i(2,"button",90),v("click",function(){let r=c(e).$implicit,s=m(3);return p(s.removeOpzione(r))}),i(3,"span",91),a(4,"close"),t()()()}if(l&2){let e=n.$implicit;d(),h(" ",e," ")}}function ee(l,n){if(l&1){let e=_();i(0,"div",71)(1,"label",56)(2,"span",4),a(3,"checklist"),t(),a(4," Opzioni di risposta "),t(),i(5,"div",85)(6,"input",86),v("input",function(r){c(e);let s=m(2);return p(s.onNuovaOpzioneChange(r.target.value))})("keyup.enter",function(){c(e);let r=m(2);return p(r.addOpzione())}),t(),i(7,"button",87),v("click",function(){c(e);let r=m(2);return p(r.addOpzione())}),i(8,"span",4),a(9,"add"),t(),a(10," Aggiungi "),t()(),i(11,"div",88),S(12,Z,5,1,"div",89,w),t()()}if(l&2){let e=m(2);d(6),C("value",e.nuovaOpzioneInput()),d(6),D(e.editingDomanda().opzioni)}}function te(l,n){if(l&1){let e=_();i(0,"div",73)(1,"label",56)(2,"span",4),a(3,"text_fields"),t(),a(4," Massimo caratteri "),t(),i(5,"input",92),v("input",function(r){c(e);let s=m(2);return p(s.updateMaxCaratteriDomanda(+r.target.value))}),t()()}if(l&2){let e=m(2);d(5),C("value",e.editingDomanda().max_caratteri||"")}}function ie(l,n){if(l&1){let e=_();i(0,"div",18)(1,"div",64)(2,"div",65)(3,"h3",66)(4,"span",67),a(5,"edit"),t(),a(6," Modifica Domanda "),t(),i(7,"button",68),v("click",function(){c(e);let r=m();return p(r.cancelEdit())}),t()(),i(8,"div",69)(9,"div",70)(10,"div",71)(11,"label",56)(12,"span",4),a(13,"title"),t(),a(14," Testo della domanda "),t(),i(15,"textarea",72),v("input",function(r){c(e);let s=m();return p(s.updateTestoDomanda(r.target.value))}),t()(),i(16,"div",73)(17,"label",56)(18,"span",4),a(19,"category"),t(),a(20," Tipo di domanda "),t(),i(21,"select",74),v("change",function(r){c(e);let s=m();return p(s.updateTipoDomanda(r.target.value))}),i(22,"option",75),a(23,"Testo breve"),t(),i(24,"option",76),a(25,"Testo lungo"),t(),i(26,"option",77),a(27,"Selezione singola"),t(),i(28,"option",78),a(29,"Selezione multipla"),t()()(),i(30,"div",73)(31,"label",56)(32,"span",4),a(33,"sort"),t(),a(34," Ordine di visualizzazione "),t(),i(35,"input",79),v("input",function(r){c(e);let s=m();return p(s.updateOrdineDomanda(+r.target.value))}),t()(),i(36,"div",71)(37,"label",80)(38,"input",81),v("change",function(r){c(e);let s=m();return p(s.updateObbligatoriaDomanda(r.target.checked))}),t(),i(39,"span",20),a(40,"flag"),t(),a(41," Domanda obbligatoria "),t()(),g(42,ee,14,1,"div",71),g(43,te,6,1,"div",73),t()(),i(44,"div",82)(45,"button",83),v("click",function(){c(e);let r=m();return p(r.cancelEdit())}),i(46,"span",4),a(47,"close"),t(),a(48," Annulla "),t(),i(49,"button",84),v("click",function(){c(e);let r=m();return p(r.saveDomanda())}),i(50,"span",4),a(51,"save"),t(),a(52," Salva Modifiche "),t()()()()}if(l&2){let e=m();d(15),C("value",e.editingDomanda().testo),d(6),C("value",e.editingDomanda().tipo),d(14),C("value",e.editingDomanda().ordine),d(3),C("checked",e.editingDomanda().obbligatoria),d(4),x(e.editingDomanda().tipo==="select"||e.editingDomanda().tipo==="multiselect"?42:-1),d(),x(e.editingDomanda().tipo==="text"?43:-1)}}var j=class l{constructor(n){this.intervisteService=n}interviste=b([]);selectedModule=b("Digitalizzazione");selectedIntervista=b(null);editingDomanda=b(null);isEditing=b(!1);nuovaOpzioneInput=b("");isLoading=b(!1);intervisteFiltrate=M(()=>this.interviste().filter(n=>n.modulo===this.selectedModule()));modules=["Digitalizzazione","Immagine","Contabile/Fiscale","Ottimizzazione"];ngOnInit(){return I(this,null,function*(){yield this.caricaInterviste()})}caricaInterviste(){return I(this,null,function*(){this.isLoading.set(!0);let n=yield this.intervisteService.getInterviste();if(n.data){this.interviste.set(n.data);let e=this.intervisteFiltrate()[0];e&&this.selectedIntervista.set(e)}this.isLoading.set(!1)})}selectModule(n){return I(this,null,function*(){this.selectedModule.set(n);let e=this.intervisteFiltrate()[0];this.selectedIntervista.set(e||null)})}selectIntervista(n){this.selectedIntervista.set(n),this.isEditing.set(!1)}addDomanda(){let n=this.selectedIntervista();if(!n)return;let e={id:"dom_"+Date.now(),testo:"Nuova domanda",tipo:"text",obbligatoria:!1,ordine:n.domande.length+1,max_caratteri:255},o=this.interviste().map(r=>r.id===n.id?f(u({},r),{domande:[...r.domande,e]}):r);this.interviste.set(o),this.selectedIntervista.set(o.find(r=>r.id===n.id)||null),this.editDomanda(e)}editDomanda(n){this.editingDomanda.set(u({},n)),this.isEditing.set(!0)}saveDomanda(){return I(this,null,function*(){let n=this.editingDomanda(),e=this.selectedIntervista();if(n&&e){let o=e.domande.map(s=>s.id===n.id?u({},n):s),r=yield this.intervisteService.updateIntervista(e.id,{domande:o});if(r.data){let s=this.interviste().map(z=>z.id===e.id?r.data:z);this.interviste.set(s),this.selectedIntervista.set(r.data)}else r.error&&(console.error("Errore nel salvataggio:",r.error),alert("Errore nel salvataggio della domanda"));this.cancelEdit()}})}deleteDomanda(n){return I(this,null,function*(){let e=this.selectedIntervista();if(e&&confirm("Sei sicuro di voler eliminare questa domanda?")){let o=e.domande.filter(s=>s.id!==n.id),r=yield this.intervisteService.updateIntervista(e.id,{domande:o});if(r.data){let s=this.interviste().map(z=>z.id===e.id?r.data:z);this.interviste.set(s),this.selectedIntervista.set(r.data)}else r.error&&(console.error("Errore nell'eliminazione:",r.error),alert("Errore nell'eliminazione della domanda"))}})}cancelEdit(){this.editingDomanda.set(null),this.isEditing.set(!1),this.nuovaOpzioneInput.set("")}addOpzione(){let n=this.editingDomanda(),e=this.nuovaOpzioneInput();if(n&&e.trim()!==""){let o=n.opzioni||[];this.editingDomanda.set(f(u({},n),{opzioni:[...o,e.trim()]})),this.nuovaOpzioneInput.set("")}}removeOpzione(n){let e=this.editingDomanda();e?.opzioni&&this.editingDomanda.set(f(u({},e),{opzioni:e.opzioni.filter(o=>o!==n)}))}onTipoChange(){let n=this.editingDomanda();if(!n)return;let e=u({},n);e.tipo==="select"||e.tipo==="multiselect"?(e.opzioni||(e.opzioni=["S\xEC","No"]),e.max_caratteri=void 0):(e.opzioni=void 0,e.tipo==="text"?e.max_caratteri=255:e.max_caratteri=void 0),this.editingDomanda.set(e)}updateTestoDomanda(n){let e=this.editingDomanda();e&&this.editingDomanda.set(f(u({},e),{testo:n}))}updateTipoDomanda(n){let e=this.editingDomanda();e&&(this.editingDomanda.set(f(u({},e),{tipo:n})),this.onTipoChange())}updateOrdineDomanda(n){let e=this.editingDomanda();e&&this.editingDomanda.set(f(u({},e),{ordine:n}))}updateObbligatoriaDomanda(n){let e=this.editingDomanda();e&&this.editingDomanda.set(f(u({},e),{obbligatoria:n}))}updateMaxCaratteriDomanda(n){let e=this.editingDomanda();e&&this.editingDomanda.set(f(u({},e),{max_caratteri:n}))}onNuovaOpzioneChange(n){this.nuovaOpzioneInput.set(n)}creaNuovaIntervista(){return I(this,null,function*(){let n=prompt("Inserisci il nome della nuova intervista:");if(!n)return;let e={nome:n,modulo:this.selectedModule(),descrizione:"",domande:[]},o=yield this.intervisteService.createIntervista(e);o.data?(this.interviste.update(r=>[...r,o.data]),this.selectedIntervista.set(o.data)):o.error&&(console.error("Errore nella creazione:",o.error),alert("Errore nella creazione della nuova intervista"))})}getTipoDisplay(n){return{text:"Testo breve",textarea:"Testo lungo",select:"Selezione singola",multiselect:"Selezione multipla"}[n]||n}static \u0275fac=function(e){return new(e||l)(k(A))};static \u0275cmp=T({type:l,selectors:[["app-interviste"]],decls:31,vars:4,consts:[[1,"interviste-container",2,"display","flex","height","100vh","background","var(--background)"],[1,"sidebar",2,"width","var(--grandezzasidebar)","background","var(--sidebar-background)","border-right","1px solid var(--smoke-color-1)","padding","var(--gutter-lg)","overflow-y","auto","border-radius","20px"],[1,"section-header",2,"margin-bottom","var(--gutter-lg)"],[1,"header-icon"],[1,"material-icons"],[1,"section-titles"],[1,"section-title",2,"font-size","var(--fs-md)"],[1,"module-list",2,"display","flex","flex-direction","column","gap","var(--gutter-sm)","margin-bottom","var(--gutter-xl)"],[1,"promethea-button","ghost",2,"justify-content","flex-start","text-align","left",3,"active"],[1,"section-header",2,"margin-bottom","var(--gutter-lg)","font-size","var(--fs-md)"],["title","Nuova Intervista",1,"action-btn","add",2,"margin-left","auto",3,"click"],[1,"interview-list",2,"display","flex","flex-direction","column","gap","var(--gutter-sm)"],[1,"status-message","loading",2,"justify-content","center"],[1,"card","clickable",2,"padding","var(--gutter-md)","cursor","pointer",3,"active"],[1,"empty-state"],[1,"form-section",2,"flex","1","padding","var(--gutter-lg)","overflow-y","auto"],[1,"interview-details"],[1,"empty-state",2,"text-align","center","padding","var(--gutter-xl)","height","100%","display","flex","flex-direction","column","justify-content","center","align-items","center"],[1,"modal-backdrop"],[1,"promethea-button","ghost",2,"justify-content","flex-start","text-align","left",3,"click"],[1,"material-icons",2,"font-size","var(--fs-md)"],[1,"loading-spinner"],[1,"card","clickable",2,"padding","var(--gutter-md)","cursor","pointer",3,"click"],[1,"card-title",2,"margin","0","flex-direction","row","justify-content","space-between","align-items","center"],[2,"font-weight","600","font-size","var(--fs-sm)"],[1,"badge","badge-info",2,"font-size","0.7rem"],[2,"display","flex","align-items","center","gap","var(--gutter-sm)","margin-top","var(--gutter-sm)"],[1,"material-icons",2,"font-size","var(--fs-sm)","opacity","0.7"],[1,"text-muted",2,"font-size","0.8rem"],[1,"material-icons",2,"font-size","var(--fs-lg)","opacity","0.5","margin-bottom","var(--gutter-sm)"],[1,"section-header",2,"margin-bottom","var(--gutter-xl)"],[1,"section-titles",2,"flex","1"],[1,"section-title",2,"margin","0","border","none","padding","0","font-size","var(--fs-lg)"],[2,"display","flex","align-items","center","gap","var(--gutter-md)","margin-top","var(--gutter-sm)"],[1,"product-badge"],[1,"text-muted",2,"display","flex","align-items","center","gap","var(--gutter-sm)"],[1,"material-icons",2,"font-size","var(--fs-sm)"],[1,"promethea-button",3,"click"],[1,"form-section",2,"margin-bottom","var(--gutter-xl)"],[1,"form-section"],[1,"section-title"],[1,"domande-list",2,"display","flex","flex-direction","column","gap","var(--gutter-lg)"],[1,"card",2,"padding","var(--gutter-lg)","position","relative"],[1,"empty-state",2,"text-align","center","padding","var(--gutter-xl)"],[1,"text-muted",2,"margin","0","line-height","1.6","padding","0 var(--gutter-sm)"],[2,"display","flex","justify-content","between","align-items","flex-start","margin-bottom","var(--gutter-md)","gap","var(--gutter-md)"],[2,"display","flex","align-items","center","gap","var(--gutter-sm)","flex-wrap","wrap"],[1,"badge","badge-primary"],[1,"badge","badge-secondary"],[1,"badge","badge-danger"],[1,"table-actions"],["title","Modifica domanda",1,"action-btn","edit",3,"click"],["title","Elimina domanda",1,"action-btn","delete",3,"click"],[2,"margin","0 0 var(--gutter-md) 0","font-weight","500","line-height","1.5"],[2,"margin-bottom","var(--gutter-md)"],[2,"display","flex","align-items","center","gap","var(--gutter-sm)"],[1,"form-label"],[2,"display","flex","flex-wrap","wrap","gap","var(--gutter-sm)"],[1,"chip"],[1,"text-muted",2,"font-size","var(--fs-sm)"],[1,"material-icons",2,"font-size","var(--fs-xl)","opacity","0.3","margin-bottom","var(--gutter-lg)"],[2,"color","var(--text-color)","opacity","0.7","margin-bottom","var(--gutter-md)"],[1,"text-muted",2,"margin-bottom","var(--gutter-lg)"],[1,"text-muted",2,"margin-bottom","var(--gutter-lg)","max-width","400px"],[1,"modal"],[1,"modal-header"],[1,"modal-title"],[1,"material-icons",2,"margin-right","var(--gutter-sm)"],["title","Chiudi",1,"icon-btn","close",3,"click"],[1,"modal-body"],[1,"grid-form"],[1,"form-field","form-field-col-span"],["rows","4","placeholder","Inserisci il testo della domanda...",2,"min-height","120px",3,"input","value"],[1,"form-field"],[3,"change","value"],["value","text"],["value","textarea"],["value","select"],["value","multiselect"],["type","number","min","1",1,"count-input",3,"input","value"],[1,"checkbox-label"],["type","checkbox",3,"change","checked"],[1,"modal-footer"],["type","button",1,"promethea-button","ghost",3,"click"],["type","button",1,"promethea-button",3,"click"],[1,"opzioni-input",2,"display","flex","gap","var(--gutter-sm)","margin-bottom","var(--gutter-md)"],["type","text","placeholder","Inserisci una nuova opzione...",1,"flex-1",3,"input","keyup.enter","value"],["type","button",1,"promethea-button",2,"white-space","nowrap",3,"click"],[1,"opzioni-list",2,"display","flex","flex-wrap","wrap","gap","var(--gutter-sm)"],[1,"chip",2,"display","flex","align-items","center","gap","var(--gutter-sm)","padding","var(--gutter-sm) var(--gutter-md)"],["type","button","title","Rimuovi opzione",1,"action-btn","delete",2,"width","20px","height","20px","padding","0",3,"click"],[1,"material-icons",2,"font-size","14px"],["type","number","min","1","max","1000",1,"count-input",3,"input","value"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),a(5,"view_module"),t()(),i(6,"div",5)(7,"h3",6),a(8,"Moduli"),t()()(),i(9,"div",7),S(10,q,4,3,"button",8,w),t(),i(12,"div",9)(13,"div",3)(14,"span",4),a(15,"assignment"),t()(),i(16,"div",5)(17,"h3",6),a(18,"Interviste"),t()(),i(19,"button",10),v("click",function(){return o.creaNuovaIntervista()}),i(20,"span",4),a(21,"add"),t()()(),i(22,"div",11),g(23,B,4,0,"div",12),S(24,P,11,5,"div",13,L,!1,R,5,0,"div",14),t()(),i(27,"div",15),g(28,X,29,5,"div",16)(29,Y,11,0,"div",17),g(30,ie,53,6,"div",18),t()()),e&2&&(d(10),D(o.modules),d(13),x(o.isLoading()?23:-1),d(),D(o.intervisteFiltrate()),d(4),x(o.selectedIntervista()?28:29),d(2),x(o.isEditing()&&o.editingDomanda()?30:-1))},dependencies:[O,$,F,N],encapsulation:2})};export{j as Interviste};
