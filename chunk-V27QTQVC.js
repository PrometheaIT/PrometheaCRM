import{e as z,g as R,k as U}from"./chunk-3DLJ4ULO.js";import{Aa as x,Bb as j,Ga as S,La as g,Mb as H,Na as w,Va as I,Wa as T,X as p,Xa as _,Y as m,Ya as o,Za as a,_a as v,cb as P,db as A,eb as b,fb as h,ib as s,ja as f,jb as l,kb as O,lb as V,mb as D,nb as B,ob as y,pb as M,qb as C,sa as k,sb as L,ua as u,ub as c,za as E}from"./chunk-6W5NKFNP.js";var Q=["[dropdown-items]"],N=["trigger"],Y=[[["","dropdown-items",""]]];function $(r,t){if(r&1){let e=h();o(0,"button",9),s("click",function(i){p(e);let d=l(3);return m(d.emitAction("promethea",i))}),v(1,"img",18),o(2,"span"),c(3,"Configurazione Promethea"),a()()}}function W(r,t){if(r&1){let e=h();o(0,"button",9),s("click",function(i){p(e);let d=l(3);return m(d.emitAction("yuvi",i))}),v(1,"img",19),o(2,"span"),c(3,"Trattativa YUVI"),a()()}}function X(r,t){if(r&1){let e=h();o(0,"button",9),s("click",function(i){p(e);let d=l(3);return m(d.emitAction("info-tecniche",i))}),o(1,"span",4),c(2,"build"),a(),o(3,"span"),c(4,"Informazioni tecniche"),a()()}}function G(r,t){if(r&1){let e=h();P(0),o(1,"button",9),s("click",function(i){p(e);let d=l(2);return m(d.emitAction("send-intro-email",i))}),o(2,"span",4),c(3,"email"),a(),o(4,"span"),c(5,"Invia presentazione Promethea"),a()(),g(6,$,4,0,"button",10)(7,W,4,0,"button",10)(8,X,5,0,"button",10),v(9,"hr",11),o(10,"button",12),s("click",function(i){p(e);let d=l(2);return i.stopPropagation(),m(d.openProductPicker(d.row))}),o(11,"span",13)(12,"span",4),c(13,"inventory_2"),a()(),o(14,"span",14)(15,"span",15),c(16,"Aggiungi prodotto"),a(),o(17,"small",16),c(18,"Scegli e assegna un prodotto al cliente"),a()()(),o(19,"button",9),s("click",function(i){p(e);let d=l(2);return m(d.emitAction("edit",i))}),o(20,"span",4),c(21,"edit"),a(),o(22,"span"),c(23,"Modifica"),a()(),o(24,"button",9),s("click",function(i){p(e);let d=l(2);return m(d.emitAction("esito",i))}),o(25,"span",4),c(26,"add"),a(),o(27,"span"),c(28,"Aggiungi esito"),a()(),o(29,"button",17),s("click",function(i){p(e);let d=l(2);return m(d.emitAction("delete",i))}),o(30,"span",4),c(31,"delete"),a(),o(32,"span"),c(33,"Elimina"),a()(),A()}if(r&2){let e=l(2);u(6),_("ngIf",e.row==null?null:e.row.hasConfigPromethea),u(),_("ngIf",e.row==null?null:e.row.hasTrattativaYuvi),u(),_("ngIf",e.primaryIcons==null?null:e.primaryIcons.infoTecniche),u(21),_("disabled",e.row==null?null:e.row.deleting)}}function J(r,t){if(r&1&&(V(0),g(1,G,34,4,"ng-container",8)),r&2){let e=l();u(),_("ngIf",!e.hasProjectedMenu)}}function K(r,t){if(r&1){let e=h();o(0,"div",20),s("click",function(){p(e);let i=l();return m(i.close())}),a()}}function Z(r,t){r&1&&b(0)}function ee(r,t){if(r&1){let e=h();o(0,"div",21)(1,"div",22)(2,"button",23),s("click",function(){p(e);let i=l();return m(i.close())}),o(3,"span",4),c(4,"close"),a()()(),o(5,"div",24),g(6,Z,1,0,"ng-container",25),a()()}if(r&2){l();let e=C(6);u(6),_("ngTemplateOutlet",e)}}function te(r,t){r&1&&b(0)}function ne(r,t){if(r&1){let e=h();o(0,"div",26),s("click",function(i){return p(e),m(i.stopPropagation())}),g(1,te,1,0,"ng-container",25),a()}if(r&2){l();let e=C(6);u(),_("ngTemplateOutlet",e)}}var F=class r{constructor(t,e){this.el=t;this.renderer=e}mode="modal";row;primaryIcons={};trigger;opened=new w;closed=new w;action=new w;projectedMenu;_hasProjectedMenu=!1;get hasProjectedMenu(){return this._hasProjectedMenu||!!this.projectedMenu}open=!1;detachedBackdrop;detachedModal;outsideUnlisten;detachedInlineMenu;repositionUnlisten;toggle(t){t&&t.stopPropagation(),this.open?this._close():this._open()}_open(){this.open=!0,setTimeout(()=>{this.updateProjectedPresence(),this.mode==="modal"?(this.attachToBody(),document.body.classList.add("dropdown-open")):this.attachInlineMenuToBody(),this.listenOutside(),this.opened.emit()},0)}_close(){this.open=!1,this.removeOutsideListener(),this.mode==="modal"?(this.detachFromBody(),document.body.classList.remove("dropdown-open")):(this.detachInlineMenuFromBody(),this.repositionUnlisten&&(this.repositionUnlisten(),this.repositionUnlisten=void 0)),this.closed.emit()}close(){this._close()}openProductPicker(t){this.action.emit("add-product"),this._close()}emitAction(t,e){e&&e.stopPropagation(),this.action.emit(t),this._close()}listenOutside(){this.removeOutsideListener(),this.outsideUnlisten=this.renderer.listen("document","click",t=>{let e=t.target;(this.mode==="modal"?!this.el.nativeElement.contains(e)&&!this.detachedModal?.contains(e):!this.el.nativeElement.contains(e)&&!this.detachedInlineMenu?.contains(e))&&this._close()})}removeOutsideListener(){this.outsideUnlisten&&(this.outsideUnlisten(),this.outsideUnlisten=void 0)}attachToBody(){try{let t=this.el.nativeElement;if(this.mode!=="modal")return;let e=t.querySelector(".modal"),n=t.querySelector(".dropdown-backdrop");n&&!this.detachedBackdrop&&(this.detachedBackdrop=n,this.renderer.appendChild(document.body,n),this.renderer.setStyle(n,"z-index","2200")),e&&!this.detachedModal&&(this.detachedModal=e,this.renderer.appendChild(document.body,e),this.renderer.setStyle(e,"position","fixed"),this.renderer.setStyle(e,"z-index","2201"),this.renderer.setStyle(e,"left","50%"),this.renderer.setStyle(e,"top","50%"),this.renderer.setStyle(e,"transform","translate(-50%, -50%)"))}catch(t){console.warn("[action-dropdown] attachToBody failed",t)}}detachFromBody(){try{this.detachedModal&&this.detachedModal.parentElement===document.body&&(this.renderer.removeChild(document.body,this.detachedModal),this.detachedModal=void 0),this.detachedBackdrop&&this.detachedBackdrop.parentElement===document.body&&(this.renderer.removeChild(document.body,this.detachedBackdrop),this.detachedBackdrop=void 0)}catch{}}onScrollClose(){this.open&&this._close()}ngOnDestroy(){this.removeOutsideListener(),this.detachFromBody(),this.detachInlineMenuFromBody(),document.body.classList.remove("dropdown-open")}attachInlineMenuToBody(){try{let e=this.el.nativeElement.querySelector(".dropdown-menu");if(!e||this.detachedInlineMenu)return;this.detachedInlineMenu=e,this.renderer.appendChild(document.body,e),this.renderer.setStyle(e,"position","absolute"),this.renderer.setStyle(e,"z-index","2201"),this.positionInlineMenu()}catch(t){console.warn("[action-dropdown] attachInlineMenuToBody failed",t)}}positionInlineMenu(){if(!(!this.detachedInlineMenu||!this.trigger))try{let e=this.trigger.nativeElement.getBoundingClientRect(),n=this.detachedInlineMenu,i=e.left+window.scrollX,d=e.bottom+window.scrollY+6;this.renderer.setStyle(n,"left",`${Math.max(8,i)}px`),this.renderer.setStyle(n,"top",`${d}px`),this.renderer.setStyle(n,"min-width",`${Math.max(160,e.width+8)}px`)}catch{}}detachInlineMenuFromBody(){try{if(this.detachedInlineMenu&&this.detachedInlineMenu.parentElement===document.body){let t=this.el.nativeElement;this.renderer.appendChild(t,this.detachedInlineMenu),this.renderer.removeStyle(this.detachedInlineMenu,"position"),this.renderer.removeStyle(this.detachedInlineMenu,"left"),this.renderer.removeStyle(this.detachedInlineMenu,"top"),this.renderer.removeStyle(this.detachedInlineMenu,"z-index"),this.detachedInlineMenu=void 0}}catch{}}ngAfterContentInit(){try{this.updateProjectedPresence()}catch{}}updateProjectedPresence(){try{let t=this.el.nativeElement,e=!!t.querySelector("[dropdown-items]");this._hasProjectedMenu=e,e?this.renderer.addClass(t,"has-projected-menu"):this.renderer.removeClass(t,"has-projected-menu")}catch{}}static \u0275fac=function(e){return new(e||r)(x(f),x(E))};static \u0275cmp=S({type:r,selectors:[["app-action-dropdown"]],contentQueries:function(e,n,i){if(e&1&&D(i,Q,5,f),e&2){let d;y(d=M())&&(n.projectedMenu=d.first)}},viewQuery:function(e,n){if(e&1&&B(N,7,f),e&2){let i;y(i=M())&&(n.trigger=i.first)}},hostBindings:function(e,n){e&1&&s("scroll",function(){return n.onScrollClose()},k)},inputs:{mode:"mode",row:"row",primaryIcons:"primaryIcons"},outputs:{opened:"opened",closed:"closed",action:"action"},ngContentSelectors:Q,decls:10,vars:10,consts:[["trigger",""],["menuContent",""],[1,"actions-dropdown",3,"aria-expanded"],["title","Altre azioni","aria-haspopup","dialog",1,"action-btn",3,"click"],[1,"material-icons"],["class","dropdown-backdrop","aria-hidden","true",3,"click",4,"ngIf"],["class","modal","role","dialog","aria-modal","true","tabindex","-1",4,"ngIf"],["class","dropdown-menu","role","menu","aria-hidden","false",3,"click",4,"ngIf"],[4,"ngIf"],[1,"dropdown-item",3,"click"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"divider"],["title","Aggiungi prodotto","aria-label","Aggiungi prodotto",1,"dropdown-item",3,"click"],["aria-hidden","true",1,"item-icon"],[1,"item-content"],[1,"item-title"],[1,"text-muted","item-sub"],[1,"dropdown-item","danger",3,"click","disabled"],["src","assets/Logo.png","alt","Promethea",1,"icon-img"],["src","assets/yuvi.png","alt","YUVI",1,"icon-img"],["aria-hidden","true",1,"dropdown-backdrop",3,"click"],["role","dialog","aria-modal","true","tabindex","-1",1,"modal"],[1,"modal-header"],["aria-label","Chiudi",1,"modal-close",3,"click"],[1,"modal-body"],[4,"ngTemplateOutlet"],["role","menu","aria-hidden","false",1,"dropdown-menu",3,"click"]],template:function(e,n){if(e&1){let i=h();O(Y),o(0,"div",2)(1,"button",3,0),s("click",function(q){return p(i),m(n.toggle(q))}),o(3,"span",4),c(4,"more_vert"),a()(),g(5,J,2,1,"ng-template",null,1,H)(7,K,1,0,"div",5)(8,ee,7,1,"div",6)(9,ne,2,1,"div",7),a()}e&2&&(L("open",n.open)("inline-mode",n.mode==="menu"),I("aria-expanded",j(n.open)),u(),T("aria-expanded",n.open),u(6),_("ngIf",n.open&&n.mode==="modal"),u(),_("ngIf",n.open&&n.mode==="modal"),u(),_("ngIf",n.mode==="menu"&&n.open))},dependencies:[U,z,R],styles:[".actions-dropdown[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center}.dropdown-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000047;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);z-index:1200}.actions-dropdown[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]{position:fixed!important;top:50%!important;left:50%!important;transform:translate(-50%,-50%)!important;width:min(92vw,480px);max-height:84vh;overflow-y:auto;z-index:1201;background:var(--background, #fff);border-radius:12px;box-shadow:0 24px 60px #0a141e47;border:1px solid var(--smoke-color-1, #ececec)}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:.25rem}.modal-close[_ngcontent-%COMP%]{background:transparent;border:none;cursor:pointer;padding:.25rem;color:var(--text-color)}.modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:0;padding:.25rem .5rem .6rem}.dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm,.5rem);padding:.6rem .8rem;background:transparent;border:none;width:100%;text-align:left;cursor:pointer;color:var(--text-color);font-weight:500}.dropdown-item[_ngcontent-%COMP%]:hover{background:color-mix(in srgb,var(--smoke-color-1) 12%,transparent)}.dropdown-item[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:1.1rem;width:24px;color:var(--muted-color)}.item-sub[_ngcontent-%COMP%]{margin:var(--gutter-sm)}.icon-img[_ngcontent-%COMP%]{width:18px;height:18px;object-fit:contain}.divider[_ngcontent-%COMP%]{border:none;height:1px;background:var(--smoke-color-1);margin:.25rem 0}.dropdown-item.danger[_ngcontent-%COMP%]{color:var(--danger, #b00020)}@media (max-width: 640px){.actions-dropdown[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]{width:min(96vw,420px);border-radius:10px}.dropdown-item[_ngcontent-%COMP%]{padding:.85rem 1rem;font-size:1rem}}.actions-dropdown[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]{position:fixed!important;top:50%!important;left:50%!important;transform:translate(-50%,-50%)!important;z-index:2201!important}.dropdown-backdrop[_ngcontent-%COMP%]{position:fixed!important;inset:0!important;z-index:2200!important}"]})};export{F as a};
