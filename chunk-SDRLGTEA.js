import{a as q,b as H,c as M,d as L,e as K,g as Y,h as J,j as X,k as Q,l as W,m as Z,n as ee,o as te,p as ie,q as ne,r as oe,s as re,t as ae,v as le}from"./chunk-EXOBR4AO.js";import{a as B}from"./chunk-Y2XJCRVM.js";import{b as U,c as $}from"./chunk-3ZXX2K2L.js";import{d as k,e as V,h as j,k as D,n as G,t as R}from"./chunk-3DLJ4ULO.js";import{Aa as C,Ga as O,Ja as A,Jb as N,Kb as w,La as h,X as u,Xa as p,Y as f,Ya as i,Za as e,_a as m,fb as b,ib as v,jb as s,rb as F,ua as l,ub as n,vb as I,wb as g,xb as z}from"./chunk-6W5NKFNP.js";import"./chunk-X5YLR3NI.js";import{a as E,b as y,i as S}from"./chunk-ODN5LVDJ.js";function de(r,o){if(r&1&&(i(0,"span",14),n(1),e()),r&2){let t=s();l(),g("Cliente: ",t.clienteId)}}function se(r,o){r&1&&(i(0,"span",15),n(1,"Visualizzazione Admin - Tutti i moduli"),e())}function pe(r,o){if(r&1&&(i(0,"div",16),n(1),e()),r&2){let t=s();l(),g(" ",t.error," ")}}function ue(r,o){if(r&1){let t=b();i(0,"div",67)(1,"div",68)(2,"div",23)(3,"label",24),n(4,"Obiettivo:"),e(),m(5,"input",69),e(),i(6,"div",23)(7,"label",24),n(8,"Target:"),e(),m(9,"input",70),e(),i(10,"div",23)(11,"label",24),n(12,"Scadenza:"),e(),m(13,"input",71),e(),i(14,"div",23)(15,"button",72),v("click",function(){let c=u(t).index,d=s(3);return f(d.removeObjective(c))}),i(16,"span",19),n(17,"delete"),e()()()()()}if(r&2){let t=o.index;p("formGroupName",t)}}function fe(r,o){if(r&1){let t=b();i(0,"div",73)(1,"div",74)(2,"div",23)(3,"label",24),n(4,"Nome:"),e(),m(5,"input",75),e(),i(6,"div",23)(7,"label",24),n(8,"Codice:"),e(),m(9,"input",76),e(),i(10,"div",23)(11,"label",24),n(12,"Priorit\xE0:"),e(),m(13,"input",77),e(),i(14,"div",23)(15,"button",78),v("click",function(){let c=u(t).index,d=s(3);return f(d.removeColor(c))}),i(16,"span",19),n(17,"delete"),e()()()()()}if(r&2){let t=o.index;p("formGroupName",t)}}function ve(r,o){if(r&1){let t=b();i(0,"div",79)(1,"div",80)(2,"div",23)(3,"label",24),n(4,"Nome Font:"),e(),m(5,"input",81),e(),i(6,"div",23)(7,"label",24),n(8,"Priorit\xE0:"),e(),m(9,"input",77),e(),i(10,"div",23)(11,"button",82),v("click",function(){let c=u(t).index,d=s(3);return f(d.removeFont(c))}),i(12,"span",19),n(13,"delete"),e()()()()()}if(r&2){let t=o.index;p("formGroupName",t)}}function ge(r,o){if(r&1){let t=b();i(0,"div",33)(1,"div",1)(2,"h4",5)(3,"span",19),n(4,"share"),e(),n(5," Social Media "),e(),i(6,"div",22)(7,"div",23)(8,"label",24),n(9,"Tipo Profilo:"),e(),m(10,"input",34),e(),i(11,"div",23)(12,"label",24),n(13,"Piattaforma:"),e(),m(14,"input",35),e(),i(15,"div",36)(16,"label",24),n(17,"Buyer Personas:"),e(),m(18,"textarea",37),e(),i(19,"div",36)(20,"label",24),n(21,"Obiettivi Intervista:"),e(),m(22,"textarea",38),e(),i(23,"div",36)(24,"label",24),n(25,"Strategia Contenuti:"),e(),m(26,"textarea",39),e()()(),i(27,"div",1)(28,"h4",5)(29,"span",19),n(30,"flag"),e(),n(31," Tabella Obiettivi "),e(),i(32,"div",40),h(33,ue,18,1,"div",41),i(34,"button",42),v("click",function(){u(t);let c=s(2);return f(c.addObjective())}),i(35,"span",19),n(36,"add"),e(),n(37," Aggiungi Obiettivo "),e()()(),i(38,"div",1)(39,"h4",5)(40,"span",19),n(41,"palette"),e(),n(42," Servizi Creativi "),e(),i(43,"div",43)(44,"div",23)(45,"label",24),n(46,"Software:"),e(),m(47,"input",44),e(),i(48,"div",23)(49,"label",24),n(50,"Formato File:"),e(),m(51,"input",45),e(),i(52,"div",36)(53,"label",24),n(54,"Percorso Salvataggio:"),e(),m(55,"input",46),e()()(),i(56,"div",1)(57,"h4",5)(58,"span",19),n(59,"aspect_ratio"),e(),n(60," Dimensioni "),e(),i(61,"div",47)(62,"div",23)(63,"label",24),n(64,"Larghezza:"),e(),m(65,"input",48),e(),i(66,"div",23)(67,"label",24),n(68,"Unit\xE0:"),e(),i(69,"select",49)(70,"option",50),n(71,"px"),e(),i(72,"option",51),n(73,"cm"),e(),i(74,"option",52),n(75,"in"),e(),i(76,"option",53),n(77,"%"),e()()(),i(78,"div",23)(79,"label",24),n(80,"Altezza:"),e(),m(81,"input",54),e(),i(82,"div",23)(83,"label",24),n(84,"Unit\xE0:"),e(),i(85,"select",55)(86,"option",50),n(87,"px"),e(),i(88,"option",51),n(89,"cm"),e(),i(90,"option",52),n(91,"in"),e(),i(92,"option",53),n(93,"%"),e()()(),i(94,"div",23)(95,"label",24),n(96,"Risoluzione:"),e(),m(97,"input",56),e(),i(98,"div",23)(99,"label",24),n(100,"Unit\xE0:"),e(),i(101,"select",57)(102,"option",58),n(103,"PPI"),e(),i(104,"option",59),n(105,"DPI"),e()()()()(),i(106,"div",1)(107,"h4",5)(108,"span",19),n(109,"color_lens"),e(),n(110," Colori "),e(),i(111,"div",60),h(112,fe,18,1,"div",61),i(113,"button",42),v("click",function(){u(t);let c=s(2);return f(c.addColor())}),i(114,"span",19),n(115,"add"),e(),n(116," Aggiungi Colore "),e()()(),i(117,"div",1)(118,"h4",5)(119,"span",19),n(120,"record_voice_over"),e(),n(121," Tone of Voice "),e(),i(122,"div",62)(123,"div",36)(124,"label",24),n(125,"Preso dall'intervista:"),e(),m(126,"textarea",63),e(),i(127,"div",23)(128,"label",24),n(129,"Stile:"),e(),m(130,"input",64),e()()(),i(131,"div",1)(132,"h4",5)(133,"span",19),n(134,"text_fields"),e(),n(135," Fonts "),e(),i(136,"div",65),h(137,ve,14,1,"div",66),i(138,"button",42),v("click",function(){u(t);let c=s(2);return f(c.addFont())}),i(139,"span",19),n(140,"add"),e(),n(141," Aggiungi Font "),e()()()()}if(r&2){let t=s(2);l(33),p("ngForOf",t.objectivesArray.controls),l(79),p("ngForOf",t.colorsArray.controls),l(25),p("ngForOf",t.fontsArray.controls)}}function _e(r,o){r&1&&(i(0,"div",1)(1,"h4",83),n(2,"Dominio"),e(),i(3,"div",84)(4,"div",23)(5,"label",24),n(6,"Nome Dominio:"),e(),m(7,"input",85),e(),i(8,"div",23)(9,"label",24),n(10,"Username:"),e(),m(11,"input",86),e(),i(12,"div",23)(13,"label",24),n(14,"Password:"),e(),m(15,"input",87),e()(),i(16,"h4",83),n(17,"Hosting"),e(),i(18,"div",88)(19,"div",23)(20,"label",24),n(21,"Provider:"),e(),m(22,"input",89),e(),i(23,"div",23)(24,"label",24),n(25,"Piano:"),e(),m(26,"input",90),e(),i(27,"div",23)(28,"label",24),n(29,"Username:"),e(),m(30,"input",86),e(),i(31,"div",23)(32,"label",24),n(33,"Password:"),e(),m(34,"input",87),e()(),i(35,"h4",83),n(36,"Database"),e(),i(37,"div",91)(38,"div",23)(39,"label",24),n(40,"Tipo Database:"),e(),m(41,"input",92),e(),i(42,"div",23)(43,"label",24),n(44,"Versione:"),e(),m(45,"input",93),e(),i(46,"div",23)(47,"label",24),n(48,"Email:"),e(),m(49,"input",94),e(),i(50,"div",23)(51,"label",24),n(52,"Password:"),e(),m(53,"input",87),e()(),i(54,"h4",83),n(55,"Server"),e(),i(56,"div",95)(57,"div",23)(58,"label",24),n(59,"Tipo Server:"),e(),m(60,"input",92),e(),i(61,"div",23)(62,"label",24),n(63,"Email:"),e(),m(64,"input",94),e(),i(65,"div",23)(66,"label",24),n(67,"Password:"),e(),m(68,"input",87),e()(),i(69,"h4",83),n(70,"Repository"),e(),i(71,"div",96)(72,"div",23)(73,"label",24),n(74,"Sistema di Versionamento:"),e(),m(75,"input",97),e(),i(76,"div",23)(77,"label",24),n(78,"Pubblicato:"),e(),m(79,"input",98),e(),i(80,"div",23)(81,"label",24),n(82,"Data Pubblicazione:"),e(),m(83,"input",99),e(),i(84,"div",23)(85,"label",24),n(86,"Sviluppatore:"),e(),m(87,"input",100),e()()())}function he(r,o){r&1&&(i(0,"div",33)(1,"div",1)(2,"h4",5)(3,"span",19),n(4,"account_balance"),e(),n(5," Contabilit\xE0 "),e(),i(6,"div",22)(7,"div",23)(8,"label",24),n(9,"Autonomia Cliente (1-5):"),e(),m(10,"input",101),i(11,"div",102),n(12,"Valuta da 1 (bassa) a 5 (alta)"),e()(),i(13,"div",23)(14,"label",24),n(15,"Livello Digitalizzazione (1-5):"),e(),m(16,"input",103),i(17,"div",102),n(18,"Valuta da 1 (basso) a 5 (alto)"),e()(),i(19,"div",23)(20,"label",24),n(21,"Responsabile Interno:"),e(),m(22,"input",104),e(),i(23,"div",23)(24,"label",24),n(25,"Complessit\xE0 Strutturale (1-5):"),e(),m(26,"input",105),i(27,"div",102),n(28,"Valuta da 1 (semplice) a 5 (complessa)"),e()(),i(29,"div",36)(30,"label",24),n(31,"Software Utilizzato:"),e(),m(32,"input",106),e()()()())}function xe(r,o){r&1&&(i(0,"div",33)(1,"div",1)(2,"h4",5)(3,"span",19),n(4,"school"),e(),n(5," Formazione "),e(),i(6,"div",107)(7,"div",36)(8,"label",24),n(9,"Obiettivo Formazione:"),e(),m(10,"textarea",108),e(),i(11,"div",23)(12,"label",24),n(13,"Totale Dipendenti:"),e(),m(14,"input",109),e(),i(15,"div",23)(16,"label",24),n(17,"Dipendenti da Formare:"),e(),m(18,"input",110),e(),i(19,"div",23)(20,"label",24),n(21,"Ore Totali:"),e(),m(22,"input",111),e(),i(23,"div",23)(24,"label",24),n(25,"Ore Rimanenti:"),e(),m(26,"input",112),e(),i(27,"div",23)(28,"label",24),n(29,"Responsabile:"),e(),m(30,"input",104),e()()()())}function be(r,o){if(r&1){let t=b();i(0,"div",17)(1,"div",18)(2,"h3",5)(3,"span",19),n(4),e(),n(5),e(),i(6,"button",20),v("click",function(){u(t);let c=s();return f(c.cancelEdit())}),e()(),i(7,"form",21),v("ngSubmit",function(){u(t);let c=s();return f(c.onSave())}),i(8,"div",1)(9,"h4",5)(10,"span",19),n(11,"info"),e(),n(12," Informazioni Base "),e(),i(13,"div",22)(14,"div",23)(15,"label",24)(16,"span",19),n(17,"badge"),e(),n(18," Numero Progetto* "),e(),m(19,"input",25),e(),i(20,"div",23)(21,"label",24)(22,"span",19),n(23,"title"),e(),n(24," Nome Progetto* "),e(),m(25,"input",26),e()()(),h(26,ge,142,3,"div",27)(27,_e,88,0,"div",28)(28,he,33,0,"div",27)(29,xe,31,0,"div",27),i(30,"div",29)(31,"div",30)(32,"button",31),v("click",function(){u(t);let c=s();return f(c.cancelEdit())}),i(33,"span",19),n(34,"cancel"),e(),n(35," Annulla "),e(),i(36,"button",32)(37,"span",19),n(38),e(),n(39),e()()()()()}if(r&2){let t=s();l(4),I(t.currentInfo?"edit":"add"),l(),z(" ",t.currentInfo?"Modifica":"Nuova"," Informazione Tecnica - ",t.getModuleName(t.currentEditingModule)," "),l(2),p("formGroup",t.technicalForm),l(19),p("ngIf",t.currentEditingModule==="immagine"),l(),p("ngIf",t.currentEditingModule==="digital"),l(),p("ngIf",t.currentEditingModule==="accounting"),l(),p("ngIf",t.currentEditingModule==="optimization"),l(7),p("disabled",!t.technicalForm.valid),l(2),I(t.currentInfo?"save":"add"),l(),g(" ",t.currentInfo?"Aggiorna":"Salva"," ")}}function Ee(r,o){r&1&&(i(0,"div",113),m(1,"div",114),i(2,"p"),n(3,"Caricamento informazioni tecniche..."),e()())}function ye(r,o){r&1&&(i(0,"p",121),n(1,"Nessuna configurazione trovata per questo cliente."),e())}function Se(r,o){r&1&&(i(0,"p",121),n(1," Nessun modulo attivo per questo cliente nella configurazione Promethea. "),e())}function Ie(r,o){if(r&1&&(i(0,"div",118)(1,"div",119),n(2,"\u{1F4CA}"),e(),h(3,ye,2,0,"p",120)(4,Se,2,0,"p",120),e()),r&2){let t=s(2);l(3),p("ngIf",!t.clienteConfig),l(),p("ngIf",t.clienteConfig&&t.modules.length===0)}}function Ce(r,o){if(r&1){let t=b();i(0,"div",118)(1,"div",119),n(2,"\u{1F4DD}"),e(),i(3,"p",121),n(4,"Nessuna informazione tecnica disponibile per questo modulo."),e(),i(5,"button",126),v("click",function(){u(t);let c=s().$implicit,d=s(2);return f(d.addNew(c))}),i(6,"span",19),n(7,"add"),e(),n(8," Crea la prima informazione "),e()()}}function ze(r,o){if(r&1&&(i(0,"div",138),n(1),e()),r&2){let t=s(2).$implicit;l(),I(t.profileType)}}function Te(r,o){if(r&1&&(i(0,"div",138),n(1),e()),r&2){let t=s(2).$implicit;l(),I(t.platform)}}function Fe(r,o){if(r&1&&(i(0,"p",121),n(1),N(2,"truncate"),e()),r&2){let t=s(2).$implicit;l(),I(w(2,1,t.buyerPersonas,100))}}function Ne(r,o){if(r&1&&(i(0,"div",136),h(1,ze,2,1,"div",137)(2,Te,2,1,"div",137)(3,Fe,3,4,"p",120),e()),r&2){let t=s().$implicit;l(),p("ngIf",t.profileType),l(),p("ngIf",t.platform),l(),p("ngIf",t.buyerPersonas)}}function we(r,o){if(r&1&&(i(0,"div",138),n(1),e()),r&2){let t=s(2).$implicit;l(),g("Dominio: ",t.domain.name)}}function Me(r,o){if(r&1&&(i(0,"div",138),n(1),e()),r&2){let t=s(2).$implicit;l(),g("Hosting: ",t.hosting.provider)}}function Pe(r,o){if(r&1&&(i(0,"div",138),n(1),e()),r&2){let t=s(2).$implicit;l(),g("DB: ",t.database.type)}}function Oe(r,o){if(r&1&&(i(0,"div",136),h(1,we,2,1,"div",137)(2,Me,2,1,"div",137)(3,Pe,2,1,"div",137),e()),r&2){let t=s().$implicit;l(),p("ngIf",t.domain==null?null:t.domain.name),l(),p("ngIf",t.hosting==null?null:t.hosting.provider),l(),p("ngIf",t.database==null?null:t.database.type)}}function Ae(r,o){if(r&1&&(i(0,"div",136)(1,"div",139)(2,"label"),n(3),e(),i(4,"div",140),m(5,"div",141),e()(),i(6,"div",139)(7,"label"),n(8),e(),i(9,"div",140),m(10,"div",141),e()(),i(11,"p")(12,"strong"),n(13,"Responsabile:"),e(),n(14),e(),i(15,"p")(16,"strong"),n(17,"Software:"),e(),n(18),e()()),r&2){let t=s().$implicit;l(3),g("Autonomia: ",t.clientAutonomy,"/5"),l(2),F("width",t.clientAutonomy/5*100+"%"),l(3),g("Digitalizzazione: ",t.digitalizationLevel,"/5"),l(2),F("width",t.digitalizationLevel/5*100+"%"),l(4),g(" ",t.internalManager),l(4),g(" ",t.softwareUsed)}}function ke(r,o){if(r&1&&(i(0,"div",136)(1,"p")(2,"strong"),n(3,"Obiettivo:"),e(),n(4),e(),i(5,"div",142)(6,"div",143)(7,"div",144),n(8),e(),i(9,"div",145),n(10,"Dipendenti"),e()(),i(11,"div",143)(12,"div",144),n(13),e(),i(14,"div",145),n(15,"Ore"),e()()()()),r&2){let t=s().$implicit;l(4),g(" ",t.training.objective),l(4),z("",t.training.employeesToTrain,"/",t.training.totalEmployees),l(5),z("",t.training.remainingHours,"/",t.training.totalHours)}}function Ve(r,o){if(r&1){let t=b();i(0,"div",127),v("click",function(){let c=u(t),d=c.$implicit,_=c.index,x=s().$implicit,T=s(2);return f(T.editInfo(d,_,x))}),i(1,"div",128)(2,"h4",83),n(3),e(),i(4,"div",129)(5,"button",130),v("click",function(c){let d=u(t),_=d.$implicit,x=d.index,T=s().$implicit,ce=s(2);return c.stopPropagation(),f(ce.editInfo(_,x,T))}),i(6,"span",19),n(7,"edit"),e()(),i(8,"button",131),v("click",function(c){let d=u(t).$implicit,_=s().$implicit,x=s(2);return c.stopPropagation(),f(x.onDelete(d.id,_))}),i(9,"span",19),n(10,"delete"),e()()()(),i(11,"div",132)(12,"p")(13,"strong"),n(14,"Progetto:"),e(),n(15),e(),i(16,"div",133),h(17,Ne,4,3,"div",134)(18,Oe,4,3,"div",134)(19,Ae,19,8,"div",134)(20,ke,16,5,"div",134),e()(),i(21,"div",135)(22,"small",121)(23,"span",19),n(24,"update"),e(),n(25),N(26,"date"),e()()()}if(r&2){let t=o.$implicit,a=s().$implicit;l(3),g(" ",t.projectName||"Informazione Tecnica"," "),l(12),z(" ",t.projectNumber," - ",t.projectName),l(2),p("ngIf",a==="immagine"),l(),p("ngIf",a==="digital"),l(),p("ngIf",a==="accounting"),l(),p("ngIf",a==="optimization"&&t.training),l(5),g(" Aggiornato il: ",w(26,8,t.updated_at,"dd/MM/yyyy")," ")}}function je(r,o){if(r&1){let t=b();i(0,"div",122)(1,"div",2)(2,"h3",5)(3,"span",19),n(4),e(),n(5),e(),i(6,"button",123),v("click",function(){let c=u(t).$implicit,d=s(2);return f(d.addNew(c))}),i(7,"span",19),n(8,"add"),e(),n(9," Nuova Informazione "),e()(),i(10,"div",124),h(11,Ce,9,0,"div",116)(12,Ve,27,11,"div",125),e()()}if(r&2){let t=o.$implicit,a=s(2);l(4),I(a.getModuleIcon(t)),l(),g(" ",a.getModuleName(t)," "),l(),p("disabled",a.showForm),l(5),p("ngIf",a.getTechnicalInfoByModule(t).length===0),l(),p("ngForOf",a.getTechnicalInfoByModule(t))}}function De(r,o){if(r&1&&(i(0,"div",115),h(1,Ie,5,2,"div",116)(2,je,13,5,"div",117),e()),r&2){let t=s();l(),p("ngIf",t.modules.length===0),l(),p("ngForOf",t.modules)}}var P=class r{transform(o,t=100){return o?o.length>t?o.substring(0,t)+"...":o:""}static \u0275fac=function(t){return new(t||r)};static \u0275pipe=A({name:"truncate",type:r,pure:!0})},me=class r{constructor(o,t,a,c,d){this.fb=o;this.route=t;this.supabaseService=a;this.authService=c;this.userService=d;this.technicalForm=this.createForm("immagine")}modules=[];isAdmin=!1;clienteId=null;currentEditingModule=null;clienteConfig=null;currentModule=null;technicalInfo={};loading=!1;error="";editingIndex=-1;showForm=!1;currentInfo=null;technicalForm;ngOnInit(){return S(this,null,function*(){this.route.queryParams.subscribe(o=>S(this,null,function*(){this.clienteId=o.clienteId||null,console.log("Cliente ID:",this.clienteId),yield this.loadUserData(),yield this.loadTechnicalInformation()}))})}extractModulesFromConfig(){if(!this.clienteConfig||typeof this.clienteConfig!="object")return[];let o={immagine_marketing:"immagine",digitalizzazione_automatismi:"digital",contabilita_fiscalita:"accounting",ottimizzazione_management:"optimization"},t=[];return Object.entries(o).forEach(([a,c])=>{let d=this.clienteConfig[a];if(!d||typeof d!="object")return;let _=Number(d.totale??d.totale_modulo??0),x=Array.isArray(d.servizi_selezionati)?d.servizi_selezionati:Array.isArray(d.servizi)?d.servizi:[];(Number.isFinite(_)&&_>0||x.length>0)&&t.push(c)}),t}loadUserData(){return S(this,null,function*(){try{let o=this.authService.user();if(!o){this.error="Utente non autenticato";return}this.isAdmin=yield this.userService.isAdmin();let t=[];if(this.isAdmin?t=["immagine","digital","accounting","optimization"]:t=(yield this.supabaseService.getAppUserById(o.id)).data?.moduli||[],this.clienteId){let d=yield this.supabaseService.getConfigurazioniPromethea(this.clienteId);d?.data&&d.data.length>0?this.clienteConfig=d.data[0].dettagli:this.clienteConfig=null}let a={immagine_marketing:"immagine",digitalizzazione_automatismi:"digital",contabilita_fiscalita:"accounting",ottimizzazione_management:"optimization"},c=this.extractModulesFromConfig();this.isAdmin?this.modules=c.length?c:t:this.modules=c.length?t.filter(d=>c.includes(d)):t,this.modules.forEach(d=>{this.technicalInfo[d]=[]}),this.clienteConfig&&typeof this.clienteConfig=="object"&&Object.keys(this.clienteConfig).forEach(d=>{let _=this.clienteConfig[d];if(_&&_.totale_modulo>0&&Array.isArray(_.servizi_selezionati)&&_.servizi_selezionati.length>0){let x=a[d];x&&c.push(x)}}),this.isAdmin?this.modules=c.length>0?c:t:c.length>0?this.modules=t.filter(d=>c.includes(d)):this.modules=t,this.modules.forEach(d=>{this.technicalInfo[d]=[]})}catch(o){console.error("Errore caricamento dati utente:",o),this.error="Errore nel caricamento dei dati utente"}})}filterModulesByConfig(o){return this.clienteConfig?o.filter(t=>{let a=this.getConfigKeyForModule(t);if(!a)return!0;let c=this.clienteConfig[a];return c&&c.totale_modulo>0&&c.servizi_selezionati.length>0}):o}getConfigKeyForModule(o){return{immagine:"immagine_marketing",accounting:"contabilita_fiscalita",optimization:"ottimizzazione_management",digital:"digitalizzazione_automatismi"}[o]||null}loadTechnicalInformation(){return S(this,null,function*(){if(!this.clienteId){this.error="Nessun cliente selezionato";return}this.loading=!0,this.error="";try{for(let o of this.modules){let t=yield this.supabaseService.getInformazioniTecniche(this.clienteId,o);t.data?this.technicalInfo[o]=t.data.map(a=>y(E({id:a.id},a.dati),{created_at:a.created_at,updated_at:a.updated_at})):this.technicalInfo[o]=[]}}catch(o){console.error("Errore caricamento informazioni tecniche:",o),this.error="Errore nel caricamento delle informazioni tecniche"}finally{this.loading=!1}})}createForm(o){let t=this.fb.group({projectNumber:["",M.required],projectName:["",M.required],module:[o]});switch(o){case"immagine":return this.fb.group(y(E({},t.controls),{profileType:[""],buyerPersonas:[""],interviewObjectives:[""],platform:[""],contentStrategy:[""],objectivesTable:this.fb.array([]),graphicInfo:this.fb.group({projectName:[""],software:[""],fileFormat:[""],savePath:[""]}),dimensions:this.fb.group({width:[0],height:[0],resolution:[0],widthUnit:["px"],heightUnit:["px"],resolutionUnit:["ppi"]}),usage:["digital"],elementType:["static"],colors:this.fb.array([]),toneOfVoice:this.fb.group({fromInterview:[""],style:[""]}),fonts:this.fb.array([])}));case"digital":return this.fb.group(y(E({},t.controls),{domain:this.fb.group({name:[""],username:[""],password:[""]}),hosting:this.fb.group({provider:[""],username:[""],password:[""],plan:[""]}),database:this.fb.group({type:[""],email:[""],password:[""],version:[""]}),server:this.fb.group({type:[""],email:[""],password:[""]}),repository:this.fb.group({sistema_versionamento:[""],pubblicato:[!1],data_pubblicazione:[""],sviluppatore:[""]})}));case"accounting":return this.fb.group(y(E({},t.controls),{clientAutonomy:[0],digitalizationLevel:[0],internalManager:[""],structuralComplexity:[0],softwareUsed:[""],deadlines:this.fb.array([]),sectorInfo:this.fb.array([])}));case"optimization":return this.fb.group(y(E({},t.controls),{training:this.fb.group({objective:[""],totalEmployees:[0],employeesToTrain:[0],totalHours:[0],remainingHours:[0],internalManager:[""]}),financial:this.fb.group({currentRatio:this.createFinancialMetric(),debtToEquity:this.createFinancialMetric(),roe:this.createFinancialMetric(),revenueGrowth:this.createFinancialMetric()})}));default:return t}}createFinancialMetric(){return this.fb.group({value:[0],calculation:this.fb.group({numerator:[0],denominator:[0]})})}getModuleName(o){return{immagine:"Immagine e Marketing",digital:"Digitalizzazione",accounting:"Contabilit\xE0",optimization:"Ottimizzazione"}[o]||o}addNew(o){this.currentEditingModule=o,this.editingIndex=-1,this.currentInfo=null,this.technicalForm=this.createForm(o),this.showForm=!0}editInfo(o,t,a){this.currentEditingModule=a,this.editingIndex=t,this.currentInfo=o,this.technicalForm=this.createForm(a),this.patchFormValue(o),this.showForm=!0}patchFormValue(o){if(this.technicalForm.patchValue(o),o.colors&&this.technicalForm.get("colors")){let t=this.technicalForm.get("colors");t.clear(),o.colors.forEach(a=>{t.push(this.fb.group({name:[a.name],code:[a.code],priority:[a.priority]}))})}if(o.fonts&&this.technicalForm.get("fonts")){let t=this.technicalForm.get("fonts");t.clear(),o.fonts.forEach(a=>{t.push(this.fb.group({name:[a.name],priority:[a.priority]}))})}if(o.objectivesTable&&this.technicalForm.get("objectivesTable")){let t=this.technicalForm.get("objectivesTable");t.clear(),o.objectivesTable.forEach(a=>{t.push(this.fb.group({objective:[a.objective],target:[a.target],deadline:[a.deadline]}))})}if(o.deadlines&&this.technicalForm.get("deadlines")){let t=this.technicalForm.get("deadlines");t.clear(),o.deadlines.forEach(a=>{t.push(this.fb.group({name:[a.name],scadenza:[a.scadenza],tipologia:[a.tipologia],importo:[a.importo]}))})}if(o.sectorInfo&&this.technicalForm.get("sectorInfo")){let t=this.technicalForm.get("sectorInfo");t.clear(),o.sectorInfo.forEach(a=>{t.push(this.fb.group({nome:[a.nome],descrizione:[a.descrizione],categorie:[a.categorie]}))})}}onSave(){return S(this,null,function*(){if(this.technicalForm.valid&&this.currentEditingModule&&this.clienteId)try{let o=y(E({},this.technicalForm.value),{updatedAt:new Date,createdAt:this.currentInfo?.createdAt||new Date}),t={cliente_id:this.clienteId,modulo:this.currentEditingModule,dati:o};this.currentInfo?.id&&(t.id=this.currentInfo.id);let a=yield this.supabaseService.upsertInformazioniTecniche(t);if(a.error){console.error("Errore salvataggio:",a.error),this.error="Errore durante il salvataggio";return}let c=y(E({id:a.data.id},o),{created_at:a.data.created_at,updated_at:a.data.updated_at});this.currentInfo?.id?this.technicalInfo[this.currentEditingModule][this.editingIndex]=c:this.technicalInfo[this.currentEditingModule].push(c),this.cancelEdit(),console.log("Dati salvati con successo:",c)}catch(o){console.error("Errore durante il salvataggio:",o),this.error="Errore durante il salvataggio"}else console.log("Form non valido o dati mancanti")})}onDelete(o,t){return S(this,null,function*(){if(confirm("Sei sicuro di voler eliminare queste informazioni?"))try{let a=yield this.supabaseService.deleteInformazioniTecniche(o);if(a.error){console.error("Errore eliminazione:",a.error),this.error="Errore durante l'eliminazione";return}this.technicalInfo[t]=this.technicalInfo[t].filter(c=>c.id!==o)}catch(a){console.error("Errore durante l'eliminazione:",a),this.error="Errore durante l'eliminazione"}})}cancelEdit(){this.showForm=!1,this.editingIndex=-1,this.currentInfo=null,this.currentEditingModule=null,this.technicalForm=this.createForm("immagine")}getTechnicalInfoByModule(o){return this.technicalInfo[o]||[]}addColor(){this.technicalForm.get("colors").push(this.fb.group({name:[""],code:[""],priority:[1]}))}removeColor(o){this.technicalForm.get("colors").removeAt(o)}get colorsArray(){return this.technicalForm.get("colors")}addFont(){this.technicalForm.get("fonts").push(this.fb.group({name:[""],priority:[1]}))}removeFont(o){this.technicalForm.get("fonts").removeAt(o)}get fontsArray(){return this.technicalForm.get("fonts")}addObjective(){this.technicalForm.get("objectivesTable").push(this.fb.group({objective:[""],target:[""],deadline:[""]}))}removeObjective(o){this.technicalForm.get("objectivesTable").removeAt(o)}get objectivesArray(){return this.technicalForm.get("objectivesTable")}calculateCurrentRatio(){let o=this.technicalForm.get("financial.currentRatio.calculation.numerator")?.value||0,t=this.technicalForm.get("financial.currentRatio.calculation.denominator")?.value||1,a=o/t;this.technicalForm.get("financial.currentRatio.value")?.setValue(a)}calculateROE(){let o=this.technicalForm.get("financial.roe.calculation.numerator")?.value||0,t=this.technicalForm.get("financial.roe.calculation.denominator")?.value||1,a=o/t*100;this.technicalForm.get("financial.roe.value")?.setValue(a)}getModuleIcon(o){return{immagine:"image",digital:"computer",accounting:"calculate",optimization:"tune"}[o]||"folder"}static \u0275fac=function(t){return new(t||r)(C(ae),C(G),C(U),C($),C(B))};static \u0275cmp=O({type:r,selectors:[["app-informazioni-tecniche"]],decls:18,vars:6,consts:[[1,"technical-info-container"],[1,"form-section"],[1,"section-header"],[1,"material-icons","header-icon"],[1,"section-titles"],[1,"section-title"],[1,"sottotitolo"],[2,"display","flex","flex-direction","row","gap","var(--gutter-sm)","margin-top","var(--gutter-sm)"],["class","badge badge-info",4,"ngIf"],["class","badge badge-warning",4,"ngIf"],["class","status-message error",4,"ngIf"],["class","form-container",4,"ngIf"],["class","status-message loading",4,"ngIf"],["class","modules-container",4,"ngIf"],[1,"badge","badge-info"],[1,"badge","badge-warning"],[1,"status-message","error"],[1,"form-container"],[1,"form-header","section-header"],[1,"material-icons"],[1,"icon-btn","close",3,"click"],[1,"form-vertical",3,"ngSubmit","formGroup"],[1,"grid-form"],[1,"form-field"],[1,"form-label"],["type","text","formControlName","projectNumber","required","",1,"form-control"],["type","text","formControlName","projectName","required","",1,"form-control"],["class","form-module-content",4,"ngIf"],["class","form-section",4,"ngIf"],[1,"form-actions"],[1,"actions-container"],["type","button",1,"promethea-button","ghost",3,"click"],["type","submit",1,"promethea-button",3,"disabled"],[1,"form-module-content"],["type","text","formControlName","profileType","placeholder","Es: Business, Personale...",1,"form-control"],["type","text","formControlName","platform","placeholder","Es: Instagram, Facebook...",1,"form-control"],[1,"form-field","form-field-col-span"],["formControlName","buyerPersonas","rows","3","placeholder","Descrivi le buyer personas...",1,"form-control"],["formControlName","interviewObjectives","rows","3","placeholder","Obiettivi dell'intervista...",1,"form-control"],["formControlName","contentStrategy","rows","3","placeholder","Strategia dei contenuti...",1,"form-control"],["formArrayName","objectivesTable",1,"objectives-container"],["class","objective-row",3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"promethea-button","secondary",3,"click"],["formGroupName","graphicInfo",1,"grid-form"],["type","text","formControlName","software","placeholder","Es: Photoshop, Illustrator...",1,"form-control"],["type","text","formControlName","fileFormat","placeholder","Es: JPG, PNG, PDF...",1,"form-control"],["type","text","formControlName","savePath","placeholder","Percorso di salvataggio file...",1,"form-control"],["formGroupName","dimensions",1,"grid-form"],["type","number","formControlName","width","placeholder","0",1,"form-control"],["formControlName","widthUnit",1,"form-control"],["value","px"],["value","cm"],["value","in"],["value","%"],["type","number","formControlName","height","placeholder","0",1,"form-control"],["formControlName","heightUnit",1,"form-control"],["type","number","formControlName","resolution","placeholder","0",1,"form-control"],["formControlName","resolutionUnit",1,"form-control"],["value","ppi"],["value","dpi"],["formArrayName","colors",1,"colors-container"],["class","color-row",3,"formGroupName",4,"ngFor","ngForOf"],["formGroupName","toneOfVoice",1,"grid-form"],["formControlName","fromInterview","rows","2","placeholder","Note dall'intervista...",1,"form-control"],["type","text","formControlName","style","placeholder","Es: Formale, Informale...",1,"form-control"],["formArrayName","fonts",1,"fonts-container"],["class","font-row",3,"formGroupName",4,"ngFor","ngForOf"],[1,"objective-row",3,"formGroupName"],[1,"objective-fields"],["type","text","formControlName","objective","placeholder","Descrizione obiettivo",1,"form-control"],["type","text","formControlName","target","placeholder","Target specifico",1,"form-control"],["type","date","formControlName","deadline",1,"form-control"],["type","button","title","Rimuovi obiettivo",1,"action-btn","delete",3,"click"],[1,"color-row",3,"formGroupName"],[1,"color-fields"],["type","text","formControlName","name","placeholder","Nome colore",1,"form-control"],["type","text","formControlName","code","placeholder","#HEX o RGB",1,"form-control"],["type","number","formControlName","priority","min","1","max","10","placeholder","1-10",1,"form-control"],["type","button","title","Rimuovi colore",1,"action-btn","delete",3,"click"],[1,"font-row",3,"formGroupName"],[1,"font-fields"],["type","text","formControlName","name","placeholder","Nome del font",1,"form-control"],["type","button","title","Rimuovi font",1,"action-btn","delete",3,"click"],[1,"card-title"],["formGroupName","domain",1,"grid-form"],["type","text","formControlName","name",1,"form-control"],["type","text","formControlName","username",1,"form-control"],["type","password","formControlName","password",1,"form-control"],["formGroupName","hosting",1,"grid-form"],["type","text","formControlName","provider",1,"form-control"],["type","text","formControlName","plan",1,"form-control"],["formGroupName","database",1,"grid-form"],["type","text","formControlName","type",1,"form-control"],["type","text","formControlName","version",1,"form-control"],["type","email","formControlName","email",1,"form-control"],["formGroupName","server",1,"grid-form"],["formGroupName","repository",1,"grid-form"],["type","text","formControlName","sistema_versionamento",1,"form-control"],["type","checkbox","formControlName","pubblicato",1,"form-check"],["type","date","formControlName","data_pubblicazione",1,"form-control"],["type","text","formControlName","sviluppatore",1,"form-control"],["type","number","formControlName","clientAutonomy","min","1","max","5",1,"form-control"],[1,"hint"],["type","number","formControlName","digitalizationLevel","min","1","max","5",1,"form-control"],["type","text","formControlName","internalManager","placeholder","Nome responsabile",1,"form-control"],["type","number","formControlName","structuralComplexity","min","1","max","5",1,"form-control"],["type","text","formControlName","softwareUsed","placeholder","Software contabilit\xE0",1,"form-control"],["formGroupName","training",1,"grid-form"],["formControlName","objective","rows","3","placeholder","Obiettivi formativi...",1,"form-control"],["type","number","formControlName","totalEmployees","placeholder","0",1,"form-control"],["type","number","formControlName","employeesToTrain","placeholder","0",1,"form-control"],["type","number","formControlName","totalHours","placeholder","0",1,"form-control"],["type","number","formControlName","remainingHours","placeholder","0",1,"form-control"],[1,"status-message","loading"],[1,"loading-spinner"],[1,"modules-container"],["class","empty-state",4,"ngIf"],["class","module-section",4,"ngFor","ngForOf"],[1,"empty-state"],[1,"empty-icon"],["class","text-muted",4,"ngIf"],[1,"text-muted"],[1,"module-section"],[1,"promethea-button",3,"click","disabled"],[1,"grid-cards"],["class","card clickable",3,"click",4,"ngFor","ngForOf"],[1,"promethea-button",3,"click"],[1,"card","clickable",3,"click"],[1,"card-header"],[1,"table-actions"],["title","Modifica",1,"action-btn","edit",3,"click"],["title","Elimina",1,"action-btn","delete",3,"click"],[1,"card-content"],[1,"module-specific-content"],["class","grid-responsive",4,"ngIf"],[1,"card-footer"],[1,"grid-responsive"],["class","chip",4,"ngIf"],[1,"chip"],[1,"progress-container"],[1,"progress"],[1,"progress-bar"],[1,"stats-container"],[1,"stat-card"],[1,"stat-value"],[1,"stat-label"]],template:function(t,a){t&1&&(i(0,"div")(1,"div",0)(2,"div",1)(3,"div",2)(4,"i",3),n(5,"settings"),e(),i(6,"div",4)(7,"h2",5),n(8,"Informazioni Tecniche"),e(),i(9,"p",6),n(10,"Dati tecnici e configurazioni per il cliente"),e(),i(11,"div",7),h(12,de,2,1,"span",8)(13,se,2,0,"span",9),e()()()(),h(14,pe,2,1,"div",10)(15,be,40,11,"div",11)(16,Ee,4,0,"div",12)(17,De,3,2,"div",13),e()()),t&2&&(l(12),p("ngIf",a.clienteId),l(),p("ngIf",a.isAdmin),l(),p("ngIf",a.error),l(),p("ngIf",a.showForm),l(),p("ngIf",a.loading),l(),p("ngIf",!a.loading&&!a.showForm))},dependencies:[D,k,V,le,Y,te,ie,H,J,q,ee,L,K,re,oe,ne,X,Z,Q,W,R,j,P],styles:['.technical-info-container[_ngcontent-%COMP%]{container-type:inline-size}.modules-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gutter-xl);margin-top:var(--gutter-lg)}.module-section[_ngcontent-%COMP%]{container-type:inline-size;padding:var(--gutter-md);border-radius:12px;border:1px solid var(--smoke-color-1)}.form-vertical[_ngcontent-%COMP%], .form-module-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gutter-lg)}.form-container[_ngcontent-%COMP%]{background:var(--background);border:1px solid var(--smoke-color-1);border-radius:16px;padding:var(--gutter-lg);margin-bottom:var(--gutter-xl);box-shadow:0 4px 12px var(--shadow);animation:slideIn .3s ease-out;container-type:inline-size}.form-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--gutter-lg);border-bottom:1px solid var(--smoke-color-1);padding-bottom:var(--gutter-md);gap:var(--gutter-sm)}.form-section[_ngcontent-%COMP%]{border:1px solid var(--smoke-color-1);border-radius:12px;padding:var(--gutter-lg);background:var(--background);transition:all .3s ease}.form-section[_ngcontent-%COMP%]:hover{border-color:var(--primary);box-shadow:0 2px 8px var(--shadow)}.objectives-container[_ngcontent-%COMP%], .colors-container[_ngcontent-%COMP%], .fonts-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gutter-md)}.objective-row[_ngcontent-%COMP%], .color-row[_ngcontent-%COMP%], .font-row[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--background) 95%,var(--primary));border:1px solid var(--smoke-color-1);border-radius:8px;padding:var(--gutter-md);transition:all .2s ease}.objective-row[_ngcontent-%COMP%]:hover, .color-row[_ngcontent-%COMP%]:hover, .font-row[_ngcontent-%COMP%]:hover{border-color:var(--primary);background:color-mix(in srgb,var(--background) 92%,var(--primary))}.objective-fields[_ngcontent-%COMP%], .color-fields[_ngcontent-%COMP%], .font-fields[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr auto;gap:var(--gutter-md);align-items:start}.form-actions[_ngcontent-%COMP%]{margin-top:var(--gutter-xl);padding-top:var(--gutter-lg);border-top:1px solid var(--smoke-color-1)}.module-specific-content[_ngcontent-%COMP%]{margin-top:var(--gutter-sm)}.progress-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.progress-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:var(--fs-sm);font-weight:600;color:var(--text-color)}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:var(--gutter-xl);text-align:center;gap:var(--gutter-md)}.empty-icon[_ngcontent-%COMP%]{font-size:3rem;opacity:.5}.stats-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:var(--gutter-sm);margin-top:var(--gutter-sm)}.stat-card[_ngcontent-%COMP%]{background:var(--smoke-color-2);border-radius:12px;padding:var(--gutter-sm);text-align:center;border:1px solid var(--smoke-color-1)}.stat-value[_ngcontent-%COMP%]{font-size:var(--fs-md);font-weight:700;color:var(--primary);line-height:1}.stat-label[_ngcontent-%COMP%]{font-size:var(--fs-sm);color:var(--text-color);opacity:.7;margin-top:.25rem}@container (max-width: 768px){.form-container[_ngcontent-%COMP%]{padding:var(--gutter-md);margin-bottom:var(--gutter-lg)}.form-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:var(--gutter-sm)}.form-section[_ngcontent-%COMP%]{padding:var(--gutter-md)}.objective-fields[_ngcontent-%COMP%], .color-fields[_ngcontent-%COMP%], .font-fields[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:var(--gutter-sm)}.stats-container[_ngcontent-%COMP%]{grid-template-columns:1fr}.section-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:var(--gutter-sm)}.grid-form[_ngcontent-%COMP%]{grid-template-columns:1fr!important}}.form-container[_ngcontent-%COMP%]{scroll-margin-top:var(--gutter-lg)}.hint[_ngcontent-%COMP%]{font-size:.8rem;color:color-mix(in srgb,var(--text-color) 60%,transparent);margin-top:.25rem;font-style:italic}.form-label[required][_ngcontent-%COMP%]:after{content:" *";color:#ef4444}.form-section[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .4s ease-out}@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}']})};export{me as InformazioniTecniche,P as TruncatePipe};
