import{a as ct}from"./chunk-OXZM6BNI.js";import{a as st}from"./chunk-56O2AJMX.js";import{a as lt}from"./chunk-JHFRRPN6.js";import{a as at}from"./chunk-VLRJGYQ5.js";import{a as Z,c as tt,e as et,l as it,m as nt,r as ot}from"./chunk-2BUGNTQC.js";import{a as rt}from"./chunk-V5FVNXN7.js";import{a as X}from"./chunk-62NP47TA.js";import{c as Q}from"./chunk-PIGK44NO.js";import{d as W,e as q,j as H,o as G,p as J}from"./chunk-2OIVJVMF.js";import{$a as P,B as D,Ba as R,Cb as M,Ia as N,J as F,Na as f,T as w,Y as g,Ya as d,Z as u,Za as n,_a as o,db as Y,eb as $,f as T,fb as x,ga as E,ib as _,jb as m,kb as S,mb as b,ob as a,pb as v,qb as y,sb as K,tb as U,ua as A,ub as B,wa as l,wb as j,y as z}from"./chunk-IZFCH7PQ.js";import"./chunk-X5YLR3NI.js";import{a as V,i as h}from"./chunk-ODN5LVDJ.js";var mt=()=>["/soggetti/nuovo","prospect"];function gt(r,e){if(r&1&&(n(0,"span"),a(1),o()),r&2){let t=m();l(),v(t.totalProspectCount())}}function ut(r,e){if(r&1&&(n(0,"span"),a(1),o()),r&2){let t=m();l(),v(t.kpi().senzaContatto)}}function _t(r,e){if(r&1&&(n(0,"span"),a(1),o()),r&2){let t=m();l(),v(t.kpi().daRichiamare)}}function ft(r,e){if(r&1&&(n(0,"span"),a(1),o()),r&2){let t=m();l(),v(t.kpi().configurati)}}function vt(r,e){r&1&&P(0,"span",45)}function ht(r,e){if(r&1&&(n(0,"option",46),a(1),o()),r&2){let t=e.$implicit;d("value",t),l(),v(t)}}function xt(r,e){if(r&1&&(n(0,"option",46),a(1),o()),r&2){let t=e.$implicit;d("value",t),l(),v(t)}}function Pt(r,e){if(r&1&&(n(0,"span"),a(1),o()),r&2){let t=m().$implicit;l(),v(t.comune)}}function wt(r,e){if(r&1&&(n(0,"span"),a(1),o()),r&2){let t=m().$implicit;l(),y(" (",t.provincia,")")}}function St(r,e){r&1&&(n(0,"span",69),a(1," Nessun indirizzo "),o())}function bt(r,e){r&1&&(n(0,"span",70),a(1,"S\xEC"),o())}function Ct(r,e){r&1&&(n(0,"span",71),a(1,"No"),o())}function Et(r,e){if(r&1&&(Y(0),n(1,"span"),a(2),o(),$()),r&2){let t=e.ngIf;l(2),v(t.tipo)}}function yt(r,e){r&1&&a(0,"\u2014")}function It(r,e){if(r&1){let t=x();n(0,"button",72),_("click",function(s){g(t);let p=m().$implicit,c=m();return s.stopPropagation(),u(c.vediConfigurazionePromethea(p))}),P(1,"img",73),o()}}function kt(r,e){if(r&1){let t=x();n(0,"button",74),_("click",function(s){g(t);let p=m().$implicit,c=m();return s.stopPropagation(),u(c.vediTrattativaYuvi(p))}),P(1,"img",75),o()}}function Lt(r,e){if(r&1){let t=x();n(0,"button",81),_("click",function(s){g(t);let p=m(2).$implicit,c=m();return s.stopPropagation(),c.vediConfigurazionePromethea(p),u(c.closeAllDropdowns())}),P(1,"img",82),n(2,"span"),a(3,"Configura Promethea"),o()()}}function Tt(r,e){if(r&1){let t=x();n(0,"button",81),_("click",function(s){g(t);let p=m(2).$implicit,c=m();return s.stopPropagation(),c.vediTrattativaYuvi(p),u(c.closeAllDropdowns())}),P(1,"img",83),n(2,"span"),a(3,"Trattativa YUVI"),o()()}}function Mt(r,e){if(r&1){let t=x();n(0,"div",76)(1,"div",77),f(2,Lt,4,0,"button",78)(3,Tt,4,0,"button",78),n(4,"button",79),_("click",function(s){g(t);let p=m().$implicit,c=m();return s.stopPropagation(),c.onEdit(p),u(c.closeAllDropdowns())}),n(5,"span",15),a(6,"edit"),o(),n(7,"span"),a(8,"Modifica"),o()(),n(9,"button",79),_("click",function(s){g(t);let p=m().$implicit,c=m();return s.stopPropagation(),c.openEsito(p),u(c.closeAllDropdowns())}),n(10,"span",15),a(11,"add"),o(),n(12,"span"),a(13,"Aggiungi esito"),o()(),n(14,"button",80),_("click",function(s){g(t);let p=m().$implicit,c=m();return s.stopPropagation(),c.onDelete(p),u(c.closeAllDropdowns())}),n(15,"span",15),a(16,"delete"),o(),n(17,"span"),a(18,"Elimina"),o()()()()}if(r&2){let t=m().$implicit,i=m();l(2),d("ngIf",t.hasConfigPromethea),l(),d("ngIf",t.hasTrattativaYuvi),l(11),d("disabled",i.deletingIds.has(t.id))}}function Ot(r,e){if(r&1){let t=x();n(0,"div",84),_("click",function(){g(t);let s=m(2);return u(s.closeAllDropdowns())}),o()}}function Vt(r,e){if(r&1){let t=x();n(0,"tr")(1,"td",47)(2,"div",48)(3,"strong"),a(4),o()()(),n(5,"td",49)(6,"div",48),a(7),o()(),n(8,"td",50)(9,"div",48),a(10),o()(),n(11,"td",51)(12,"div",48),f(13,Pt,2,1,"span",41)(14,wt,2,1,"span",41)(15,St,2,0,"span",52),o()(),n(16,"td",53)(17,"div",48),f(18,bt,2,0,"span",54)(19,Ct,2,0,"span",55),o()(),n(20,"td",56)(21,"div",48),f(22,Et,3,1,"ng-container",20)(23,yt,1,0,"ng-template",null,4,M),o()(),n(25,"td",57)(26,"div",48)(27,"select",58,5),_("change",function(){let s=g(t).$implicit,p=S(28),c=m();return u(c.onChangeProdotto(s,p.value))}),n(29,"option",59),a(30,"Promethea"),o(),n(31,"option",60),a(32,"YUVI"),o()()()(),n(33,"td",61)(34,"div",62),f(35,It,2,0,"button",63)(36,kt,2,0,"button",64),n(37,"div",65)(38,"button",66),_("click",function(s){let p=g(t).$implicit,c=m();return s.stopPropagation(),u(c.toggleActionsDropdown(p.id,s))}),n(39,"span",15),a(40,"more_vert"),o()(),f(41,Mt,19,3,"div",67)(42,Ot,1,0,"div",68),o()()()()}if(r&2){let t=e.$implicit,i=S(24),s=m();l(4),v(t.ragione_sociale),l(3),v(t.referente||"\u2014"),l(3),v(t.telefono||"\u2014"),l(3),d("ngIf",t.comune),l(),d("ngIf",t.provincia),l(),d("ngIf",!t.comune&&!t.provincia),l(3),d("ngIf",t.configurato),l(),d("ngIf",!t.configurato),l(3),d("ngIf",t.ultimoEsito)("ngIfElse",i),l(5),d("value",t.prodotto)("disabled",s.updatingProdottoIds.has(t.id)),l(8),d("ngIf",t.hasConfigPromethea),l(),d("ngIf",t.hasTrattativaYuvi),l(),b("open",s.activeDropdownId===t.id),l(4),d("ngIf",s.activeDropdownId===t.id),l(),d("ngIf",s.activeDropdownId===t.id)}}function zt(r,e){if(r&1&&(n(0,"tr")(1,"td",85),a(2),o()()),r&2){let t=m();l(2),y(" ",t.searchTerm?"Nessun prospect trovato":"Nessun prospect"," ")}}function Dt(r,e){r&1&&(n(0,"span",15),a(1,"expand_more"),o())}function Ft(r,e){r&1&&(n(0,"span",15),a(1,"hourglass_bottom"),o())}function At(r,e){if(r&1){let t=x();n(0,"div",86)(1,"button",87),_("click",function(){g(t);let s=m();return u(s.loadMore())}),f(2,Dt,2,0,"span",88)(3,Ft,2,0,"span",88),a(4),o()()}if(r&2){let t=m();l(),d("disabled",t.loading()),l(),d("ngIf",!t.loading()),l(),d("ngIf",t.loading()),l(),y(" ",t.loading()?"Caricamento\u2026":"Carica altri"," ")}}function Rt(r,e){if(r&1&&(n(0,"div",89),a(1),o()),r&2){let t=m();l(),y(" ",t.error()," ")}}var dt=class r{listaService=w(st);soggettiService=w(rt);authService=w(Q);userService=w(X);router=w(G);renderer=w(R);searchSubject=new T;destroy$=new T;rows=this.listaService.rows;filteredRows=this.listaService.filteredRows;loading=this.listaService.loading;error=this.listaService.error;hasMore=this.listaService.hasMore;currentFiltri=this.listaService.currentFiltri;province=E([]);kpiLoading=E(!1);kpi=E({senzaContatto:0,daRichiamare:0,configurati:0});totalProspectCount=E(0);deletingIds=new Set;showEsito=!1;selectedId=null;updatingProdottoIds=new Set;activeDropdownId=null;clickListener;esitiTipi=lt;searchTerm="";filtroConfigurato=null;isLoading=E(!0);constructor(){this.searchSubject.pipe(F(this.destroy$),z(300),D()).subscribe(e=>{this.onSearchExecuted(e)})}ngOnInit(){return h(this,null,function*(){console.log("\u{1F680} Lista Prospect - START"),this.isLoading.set(!0),yield this.authService.getAuthState();let e=this.authService.user();if(console.log("\u{1F464} User after auth:",{id:e?.id,email:e?.email}),!e){console.error("\u274C Nessun utente autenticato!"),this.isLoading.set(!1);return}let t=this.userService.isAdmin();console.log("\u{1F511} Admin status:",t),this.listaService.inizializza({tipo:"prospect",abilitaConfigurazioni:!0,abilitaTrattative:!0}),console.log("\u2699\uFE0F Servizio inizializzato");try{console.log("\u{1F4CA} Inizio caricamento dati..."),yield this.listaService.caricaAltri(!0);let i=this.rows(),s=this.filteredRows();console.log("\u{1F4C4} Dati caricati:",{totalRows:i.length,filteredRows:s.length,firstRow:i[0]?.ragione_sociale||"N/A"}),yield Promise.all([this.loadProvince(),this.loadTotalKPI()]),console.log("\u2705 Init completato")}catch(i){console.error("\u274C Errore durante init:",i),this.refreshLocalKPI()}finally{setTimeout(()=>{this.isLoading.set(!1)},300)}})}refreshData(){return h(this,null,function*(){try{yield this.listaService.caricaAltri(!0),yield this.loadTotalKPI()}catch(e){console.error("\u274C Errore refresh data:",e),this.refreshLocalKPI()}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.closeAllDropdowns()}loadMore(e=!1){return h(this,null,function*(){yield this.listaService.caricaAltri(e)})}onSearchExecuted(e){return h(this,null,function*(){yield this.listaService.cerca(e)})}onSearchChange(e){this.searchTerm=e,this.searchSubject.next(e)}onChangeFiltroEsito(e){this.listaService.applicaFiltri({esito:e,configurato:null}),this.filtroConfigurato=null}onChangeFiltroProvincia(e){this.listaService.applicaFiltri({provincia:e})}onChangeSortDir(e){this.listaService.applicaFiltri({sortDir:e})}onFiltroTotale(){this.listaService.applicaFiltri({esito:"tutti",provincia:"tutte",configurato:null}),this.filtroConfigurato=null}onFiltroSenzaContatto(){this.listaService.applicaFiltri({esito:"senza-esito",configurato:null}),this.filtroConfigurato=null}onFiltroDaRichiamare(){this.listaService.applicaFiltri({esito:"Richiamare",configurato:null}),this.filtroConfigurato=null}onFiltroConfigurati(){this.listaService.applicaFiltri({esito:"tutti",configurato:!0}),this.filtroConfigurato=!0}vediConfigurazionePromethea(e){this.router.navigate(["/alchemizzatore"],{queryParams:{prospectId:e.id,step:6}})}vediTrattativaYuvi(e){return h(this,null,function*(){try{let{data:t,error:i}=yield this.soggettiService.supabaseService.supabase.from("trattative_yuvi").select("*").eq("prospect_id",e.id).order("created_at",{ascending:!1}).limit(1).single();if(i)throw i;if(!t){alert("Nessuna trattativa YUVI trovata per questo prospect");return}this.router.navigate(["/yuvi-trattativa"],{queryParams:{prospectId:e.id,trattativaId:t.id,step:7},state:{prospect:e,trattativaEsistente:t,from:"lista-prospect"}})}catch(t){alert("Errore nel caricamento della trattativa: "+t.message)}})}onDelete(e){return h(this,null,function*(){if(!(!e?.id||!confirm(`Eliminare il prospect "${e.ragione_sociale}"?`))){this.deletingIds.add(e.id);try{(yield this.listaService.eliminaSoggetto(e.id))&&(yield this.loadTotalKPI())}catch(i){console.error("Errore durante l'eliminazione:",i)}finally{this.deletingIds.delete(e.id)}}})}onEdit(e){e?.id&&this.router.navigate(["/soggetti/modifica",e.id])}openEsito(e){this.selectedId=e.id,this.showEsito=!0}onPopupClosed(e){return h(this,null,function*(){this.showEsito=!1,this.selectedId=null,e.saved&&(yield Promise.all([this.listaService.caricaAltri(!0),this.loadTotalKPI()]))})}onChangeProdotto(e,t){return h(this,null,function*(){if(!e?.id)return;let i=t;if(e.prodotto!==i){this.updatingProdottoIds.add(e.id);try{yield this.listaService.aggiornaProdotto(e.id,i)}catch(s){console.error("Errore durante l'aggiornamento del prodotto:",s)}finally{this.updatingProdottoIds.delete(e.id)}}})}trackById=(e,t)=>t.id;toggleActionsDropdown(e,t){t&&t.stopPropagation();let i=this.activeDropdownId===e;this.activeDropdownId=i?null:e,this.activeDropdownId?(this.clickListener=this.renderer.listen("document","click",s=>{s.target.closest(".actions-dropdown")||this.closeAllDropdowns()}),document.body.classList.add("dropdown-open")):this.closeAllDropdowns()}closeAllDropdowns(){this.activeDropdownId=null,document.body.classList.remove("dropdown-open"),this.clickListener&&(this.clickListener(),this.clickListener=void 0)}onWindowScroll(){this.activeDropdownId&&this.closeAllDropdowns()}loadProvince(){return h(this,null,function*(){let{data:e}=yield this.soggettiService.getProvinceByTipo("prospect");e&&this.province.set(e)})}loadTotalKPI(){return h(this,null,function*(){this.kpiLoading.set(!0);try{let t=(yield this.soggettiService.countByTipo("prospect")).data||0;if(this.totalProspectCount.set(t),t===0){this.kpi.set({senzaContatto:0,daRichiamare:0,configurati:0});return}let{data:i,error:s}=yield this.soggettiService.getSoggettiByTipo("prospect",0,Math.max(t,1e3));if(s)throw console.warn("\u26A0\uFE0F Errore caricamento prospect per KPI:",s),s;if(!i||i.length===0){this.kpi.set({senzaContatto:0,daRichiamare:0,configurati:0});return}let p=i.map(C=>C.id).filter(C=>!!C);if(p.length===0){this.kpi.set({senzaContatto:0,daRichiamare:0,configurati:0});return}let[c,Nt]=yield Promise.all([this.soggettiService.getConfigurazioniPrometheaByCliente(p),this.soggettiService.getTrattativeYuviByProspect(p)]),I=0,k=0,L=0;i.forEach(C=>{let O=this.getLastEsito(C.esiti),pt=c.get(C.id)||!1;O||I++,O?.tipo==="Richiamare"&&k++,pt&&L++}),this.kpi.set({senzaContatto:I,daRichiamare:k,configurati:L}),console.log("\u2705 KPI calcolati:",{total:t,senzaContatto:I,daRichiamare:k,configurati:L,prospectProcessati:i.length})}catch(e){console.error("\u274C Errore nel caricamento KPI totali:",e),this.refreshLocalKPI()}finally{this.kpiLoading.set(!1)}})}refreshLocalKPI(){console.log("\u{1F504} Usando KPI locali come fallback...");let e=this.rows();if(e.length===0){let i=this.kpi();i.senzaContatto===0&&i.daRichiamare===0&&i.configurati===0&&(this.totalProspectCount.set(0),this.kpi.set({senzaContatto:0,daRichiamare:0,configurati:0}));return}let t={senzaContatto:e.filter(i=>!i.ultimoEsito).length,daRichiamare:e.filter(i=>i.ultimoEsito?.tipo==="Richiamare").length,configurati:e.filter(i=>i.configurato).length};this.totalProspectCount.set(e.length),this.kpi.set(t),console.log("\u{1F4CA} KPI locali:",V({totalLocal:e.length},t))}getLastEsito(e){return!Array.isArray(e)||e.length===0?null:e.reduce((t,i)=>{let s=new Date(i.ts).getTime(),p=new Date(t.ts).getTime();return s>p?i:t})}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=N({type:r,selectors:[["app-lista-prospect"]],hostBindings:function(t,i){t&1&&_("scroll",function(){return i.onWindowScroll()},A)},decls:105,vars:35,consts:[["loadingSpinner",""],["filtroSel",""],["ordinaSel",""],["provSel",""],["noEsito",""],["sel",""],["title","Caricamento Prospect","subtitle","Stiamo caricando i tuoi prospect...",3,"isLoading"],[1,"form-section"],[1,"section-header"],[1,"material-icons","header-icon"],[1,"section-titles"],[1,"section-title"],[1,"sottotitolo"],[1,"flex-1"],["title","Aggiungi prospect","aria-label","Aggiungi prospect",1,"icon-btn",3,"routerLink"],[1,"material-icons"],[1,"prospect-cards"],[1,"card",3,"click"],[1,"card-title"],[1,"card-number"],[4,"ngIf","ngIfElse"],[1,"table-section"],[1,"table-tools"],[1,"tool"],["for","search",1,"label"],["id","search","type","text","placeholder","Nome, telefono, email...",1,"table-inline-input",3,"ngModelChange","ngModel"],["for","filtroEsito",1,"label"],["id","filtroEsito",1,"table-inline-select",3,"change","value"],["value","tutti"],["value","senza-esito"],[3,"value",4,"ngFor","ngForOf"],["for","ordinaPer",1,"label"],["id","ordinaPer",1,"table-inline-select",3,"change","value"],["value","desc"],["value","asc"],["for","filtroProvincia",1,"label"],["id","filtroProvincia",1,"table-inline-select",3,"change","value"],["value","tutte"],[1,"table-container"],[1,"crm-table"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],["class","load-more-container",4,"ngIf"],["style","text-align:center; color:#ef4444; margin-top:1rem;",4,"ngIf"],[3,"closed","open","soggettoId","tipo"],[1,"loading-spinner"],[3,"value"],["data-label","Ragione Sociale"],[1,"cell-content"],["data-label","Referente"],["data-label","Telefono"],["data-label","Localit\xE0"],["style","color: #6b7280; font-style: italic;",4,"ngIf"],["data-label","Configurato"],["class","badge badge-success",4,"ngIf"],["class","badge badge-danger",4,"ngIf"],["data-label","Ultimo Esito"],["data-label","Prodotto"],[1,"table-inline-select",3,"change","value","disabled"],["value","Promethea"],["value","YUVI"],["data-label","Azioni"],[1,"actions-container"],["class","action-btn document","title","Configurazione Promethea",3,"click",4,"ngIf"],["class","action-btn email","title","Trattativa YUVI",3,"click",4,"ngIf"],[1,"actions-dropdown"],["title","Altre azioni",1,"action-btn",3,"click"],["class","modal",4,"ngIf"],["class","mobile-dropdown-backdrop",3,"click",4,"ngIf"],[2,"color","#6b7280","font-style","italic"],[1,"badge","badge-success"],[1,"badge","badge-danger"],["title","Configurazione Promethea",1,"action-btn","document",3,"click"],["src","assets/Logo.png","alt","Promethea",1,"icon-img"],["title","Trattativa YUVI",1,"action-btn","email",3,"click"],["src","assets/yuvi.png","alt","YUVI",1,"icon-img"],[1,"modal"],[1,"modal-body",2,"padding","0"],["class","dropdown-item mobile-only",3,"click",4,"ngIf"],[1,"dropdown-item",3,"click"],[1,"dropdown-item",3,"click","disabled"],[1,"dropdown-item","mobile-only",3,"click"],["src","assets/Logo.png","alt","Promethea",1,"icon-img",2,"width","16px","height","16px"],["src","assets/yuvi.png","alt","YUVI",1,"icon-img",2,"width","16px","height","16px"],[1,"mobile-dropdown-backdrop",3,"click"],["colspan","8",2,"text-align","center","padding","1.5rem"],[1,"load-more-container"],[1,"promethea-button",3,"click","disabled"],["class","material-icons",4,"ngIf"],[2,"text-align","center","color","#ef4444","margin-top","1rem"]],template:function(t,i){if(t&1){let s=x();P(0,"app-page-loader",6),n(1,"div")(2,"div",7)(3,"div",8)(4,"i",9),a(5,"group"),o(),n(6,"div",10)(7,"h2",11),a(8,"Prospect"),o(),n(9,"p",12),a(10,"Panoramica prospect e filtri rapidi"),o()(),P(11,"div",13),n(12,"a",14)(13,"span",15),a(14,"add_circle"),o()()(),n(15,"div",16)(16,"div",17),_("click",function(){return g(s),u(i.onFiltroTotale())}),n(17,"h3",18),a(18,"Totale"),o(),n(19,"div",19),f(20,gt,2,1,"span",20),o()(),n(21,"div",17),_("click",function(){return g(s),u(i.onFiltroSenzaContatto())}),n(22,"h3",18),a(23,"Senza Contatto"),o(),n(24,"div",19),f(25,ut,2,1,"span",20),o()(),n(26,"div",17),_("click",function(){return g(s),u(i.onFiltroDaRichiamare())}),n(27,"h3",18),a(28,"Da Richiamare"),o(),n(29,"div",19),f(30,_t,2,1,"span",20),o()(),n(31,"div",17),_("click",function(){return g(s),u(i.onFiltroConfigurati())}),n(32,"h3",18),a(33,"Configurati"),o(),n(34,"div",19),f(35,ft,2,1,"span",20),o()(),f(36,vt,1,0,"ng-template",null,0,M),o()(),n(38,"section",21)(39,"div",22)(40,"div",23)(41,"label",24)(42,"span",15),a(43,"search"),o(),a(44," Cerca "),o(),n(45,"input",25),B("ngModelChange",function(c){return g(s),U(i.searchTerm,c)||(i.searchTerm=c),u(c)}),_("ngModelChange",function(c){return g(s),u(i.onSearchChange(c))}),o()(),n(46,"div",23)(47,"label",26)(48,"span",15),a(49,"filter_list"),o(),a(50," Ultimo esito "),o(),n(51,"select",27,1),_("change",function(){g(s);let c=S(52);return u(i.onChangeFiltroEsito(c.value))}),n(53,"option",28),a(54,"Tutti"),o(),n(55,"option",29),a(56,"Senza esito"),o(),f(57,ht,2,2,"option",30),o()(),n(58,"div",23)(59,"label",31)(60,"span",15),a(61,"sort"),o(),a(62," Ordina per: "),o(),n(63,"select",32,2),_("change",function(){g(s);let c=S(64);return u(i.onChangeSortDir(c.value))}),n(65,"option",33),a(66,"Pi\xF9 recente"),o(),n(67,"option",34),a(68,"Meno recente"),o()()(),n(69,"div",23)(70,"label",35)(71,"span",15),a(72,"place"),o(),a(73," Provincia "),o(),n(74,"select",36,3),_("change",function(){g(s);let c=S(75);return u(i.onChangeFiltroProvincia(c.value))}),n(76,"option",37),a(77,"Tutte"),o(),f(78,xt,2,2,"option",30),o()()(),n(79,"div",38)(80,"table",39)(81,"thead")(82,"tr")(83,"th"),a(84,"Ragione Sociale"),o(),n(85,"th"),a(86,"Referente"),o(),n(87,"th"),a(88,"Telefono"),o(),n(89,"th"),a(90,"Localit\xE0"),o(),n(91,"th"),a(92,"Configurato"),o(),n(93,"th"),a(94,"Ultimo Esito"),o(),n(95,"th"),a(96,"Prodotto"),o(),n(97,"th"),a(98,"Azioni"),o()()(),n(99,"tbody"),f(100,Vt,43,18,"tr",40)(101,zt,3,1,"tr",41),o()()(),f(102,At,5,4,"div",42)(103,Rt,2,1,"div",43),o(),n(104,"app-esito-popup",44),_("closed",function(c){return g(s),u(i.onPopupClosed(c))}),o()()}if(t&2){let s=S(37);d("isLoading",i.isLoading()),l(),b("hidden",i.isLoading()),l(11),d("routerLink",j(34,mt)),l(4),b("card-active",i.currentFiltri().esito==="tutti"&&i.filtroConfigurato===null),l(4),d("ngIf",!i.kpiLoading())("ngIfElse",s),l(),b("card-active",i.currentFiltri().esito==="senza-esito"),l(4),d("ngIf",!i.kpiLoading())("ngIfElse",s),l(),b("card-active",i.currentFiltri().esito==="Richiamare"),l(4),d("ngIf",!i.kpiLoading())("ngIfElse",s),l(),b("card-active",i.filtroConfigurato===!0),l(4),d("ngIf",!i.kpiLoading())("ngIfElse",s),l(10),K("ngModel",i.searchTerm),l(6),d("value",i.currentFiltri().esito),l(6),d("ngForOf",i.esitiTipi),l(6),d("value",i.currentFiltri().sortDir),l(11),d("value",i.currentFiltri().provincia),l(4),d("ngForOf",i.province()),l(22),d("ngForOf",i.filteredRows())("ngForTrackBy",i.trackById),l(),d("ngIf",!i.loading()&&!i.error()&&i.filteredRows().length===0),l(),d("ngIf",!i.error()&&i.hasMore()),l(),d("ngIf",i.error()),l(),d("open",i.showEsito)("soggettoId",i.selectedId)("tipo","prospect")}},dependencies:[H,W,q,ct,ot,it,nt,Z,tt,et,J,at],styles:['.actions-dropdown[_ngcontent-%COMP%]{position:relative;display:inline-flex}.actions-dropdown[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;width:200px;z-index:1000;border:1px solid var(--smoke-color-1);border-radius:12px;box-shadow:0 8px 24px var(--shadow);background:var(--background);animation:_ngcontent-%COMP%_slideDown .2s ease-out}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}.dropdown-item[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;gap:var(--gutter-sm);padding:.75rem 1rem;border:none;background:transparent;color:var(--text-color);cursor:pointer;transition:background .15s ease;font-size:var(--fs-sm);text-align:left;border-bottom:1px solid var(--smoke-color-1)}.dropdown-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.dropdown-item[_ngcontent-%COMP%]:hover{background:var(--smoke-color-2)}.dropdown-item[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.dropdown-item[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:1.1rem;width:20px}.dropdown-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:transparent;z-index:999;display:none}.actions-dropdown.open[_ngcontent-%COMP%] ~ .dropdown-overlay[_ngcontent-%COMP%]{display:block}@container (max-width: 768px){.crm-table[_ngcontent-%COMP%]   td[data-label=Azioni][_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(.actions-dropdown){display:none}.crm-table[_ngcontent-%COMP%]   td[data-label=Azioni][_ngcontent-%COMP%]   .actions-dropdown[_ngcontent-%COMP%]   .dropdown-item[style*="display: none"][_ngcontent-%COMP%]{display:flex!important}.crm-table[_ngcontent-%COMP%]   td[data-label=Azioni][_ngcontent-%COMP%]   .actions-dropdown.open[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]{position:fixed!important;inset:50% auto auto 50%!important;transform:translate(-50%,-50%)!important;width:min(90vw,300px)!important;max-height:70vh!important;overflow-y:auto!important;z-index:1001!important;border-radius:16px!important;box-shadow:0 20px 40px var(--shadow)!important}.crm-table[_ngcontent-%COMP%]   td[data-label=Azioni][_ngcontent-%COMP%]   .actions-dropdown[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{width:3rem!important;height:3rem!important;font-size:1.3rem!important}.crm-table[_ngcontent-%COMP%]   td[data-label=Azioni][_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]{justify-content:center!important;padding:var(--gutter-sm) 0}}@container (min-width: 769px){.actions-dropdown[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]{min-width:180px}.actions-dropdown.left[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]{right:auto;left:0}.actions-dropdown.top[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]{top:auto;bottom:100%}}.table-container[_ngcontent-%COMP%]{overflow-x:auto;position:relative}body.dropdown-open[_ngcontent-%COMP%]{overflow:hidden}.mobile-dropdown-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:color-mix(in srgb,var(--text-color) 20%,transparent);-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);z-index:998;display:none}.actions-dropdown.open[_ngcontent-%COMP%] ~ .mobile-dropdown-backdrop[_ngcontent-%COMP%]{display:block}']})};export{dt as ListaProspect};
