import{a as et}from"./chunk-KH5IGOQ6.js";import{a as tt}from"./chunk-AW2I6Z2Q.js";import{b as G,d as $,f as J,o as K,p as Q,q as X,v as Y}from"./chunk-XK6OQE2G.js";import{b as Z}from"./chunk-LWVBIPYG.js";import{a as q}from"./chunk-I5UR3M7V.js";import{c as R}from"./chunk-5QACXCZZ.js";import{b as H,f as U}from"./chunk-74XWVHEF.js";import{j as W,k as B,n as j,r as A}from"./chunk-53FSC42K.js";import{Ba as I,Cb as V,Db as T,Eb as C,Fa as o,Fb as a,Gb as x,Hb as g,Ib as N,Jb as k,Kb as h,La as y,Lb as b,Ra as L,Ub as P,Vb as O,Wa as v,X as u,Y as _,ea as F,fb as D,gb as d,hb as i,ib as n,jb as p,qb as S,tb as f,ub as m}from"./chunk-CPJK23XT.js";import"./chunk-X5YLR3NI.js";import{i as w}from"./chunk-ODN5LVDJ.js";function at(s,r){if(s&1&&(i(0,"option",40),a(1),n()),s&2){let t=r.$implicit;d("value",t.id),o(),g(" ",t.ragione_sociale," ")}}function rt(s,r){if(s&1&&(i(0,"div",41),p(1,"i",42),a(2),n()),s&2){let t=m();o(2),g(" ",t.error," ")}}function ot(s,r){s&1&&(i(0,"small",69),a(1,"Scaduta"),n())}function st(s,r){if(s&1&&(i(0,"div",70)(1,"div",71)(2,"span",72),a(3),n(),i(4,"span",73),a(5,"Da iniziare"),n()(),i(6,"div",71)(7,"span",74),a(8),n(),i(9,"span",73),a(10,"In lavorazione"),n()(),i(11,"div",71)(12,"span",75),a(13),n(),i(14,"span",73),a(15,"Completate"),n()()()),s&2){let t=m().$implicit,e=m(2);o(3),x(e.taskService.getSottoTaskCounts(t.sotto_tasks).daFare),o(5),x(e.taskService.getSottoTaskCounts(t.sotto_tasks).inLavorazione),o(5),x(e.taskService.getSottoTaskCounts(t.sotto_tasks).completate)}}function lt(s,r){s&1&&(i(0,"div",76),p(1,"i",77),a(2," Nessuna sotto-task definita "),n())}function ct(s,r){if(s&1){let t=S();i(0,"div",45)(1,"div",46)(2,"div",47)(3,"h3",48),f("click",function(){let l=u(t).$implicit,c=m(2);return _(c.apriDettaglioTask(l.id))}),n(),i(4,"div",49)(5,"span",50),p(6,"i",51),a(7),n(),i(8,"span",50),p(9,"i",52),a(10),n()()(),i(11,"div",53)(12,"div",54)(13,"span",55),a(14),n(),i(15,"div",56)(16,"div",57),a(17),P(18,"date"),n(),v(19,ot,2,0,"small",58),n()()()(),i(20,"div",59)(21,"div",60)(22,"div",61)(23,"div",62)(24,"div",63),a(25),n()(),i(26,"span",64),a(27),n()()(),v(28,st,16,3,"div",65)(29,lt,3,0,"div",37),n(),i(30,"div",66)(31,"small",67),a(32),P(33,"date"),n(),i(34,"button",9),f("click",function(){let l=u(t).$implicit,c=m(2);return _(c.apriDettaglioTask(l.id))}),p(35,"i",68),a(36," Gestisci "),n()()()}if(s&2){let t=r.$implicit,e=m(2);T("scaduta",e.taskService.isScaduta(t.data_scadenza)),o(3),d("innerHTML",e.highlightText(t.nome),I),o(4),g(" ",(t.cliente==null?null:t.cliente.ragione_sociale)||"Nessun cliente"," "),o(3),g(" ",e.taskService.getModuloName(t.assegnazione_id||null)," "),o(3),C(e.taskService.getPrioritaBadgeClass(t.priorita_globale)),D("data-priority",t.priorita_globale),o(),g(" ",e.taskService.getNomePriorita(t.priorita_globale)," "),o(),T("scaduta",e.taskService.isScaduta(t.data_scadenza))("scadenza-imminente",e.taskService.isScadenzaImminente(t.data_scadenza)),o(2),x(O(18,26,t.data_scadenza,"dd/MM/yyyy")),o(2),d("ngIf",e.taskService.isScaduta(t.data_scadenza)),o(5),C(e.taskService.getStatoBadgeClass(t.stato)),V("width",t.progresso+"%"),o(),g(" ",t.progresso,"% "),o(),C(e.taskService.getStatoBadgeClass(t.stato)),o(),g(" ",e.taskService.getStatoTesto(t.stato)," "),o(),d("ngIf",t.sotto_tasks&&t.sotto_tasks.length>0),o(),d("ngIf",!t.sotto_tasks||t.sotto_tasks.length===0),o(3),g(" Aggiornato: ",O(33,29,t.updated_at,"dd/MM/yyyy HH:mm")," ")}}function dt(s,r){if(s&1&&(i(0,"div",43),v(1,ct,37,32,"div",44),n()),s&2){let t=m();o(),d("ngForOf",t.tasksAttive)}}function mt(s,r){s&1&&(i(0,"span",88),p(1,"i",42),a(2," Imminente "),n())}function pt(s,r){s&1&&(i(0,"span",69),p(1,"i",89),a(2," Scaduta "),n())}function gt(s,r){if(s&1&&(i(0,"div",90)(1,"div",71)(2,"span",72),a(3),n(),i(4,"span",73),a(5,"Da iniziare"),n()(),i(6,"div",71)(7,"span",74),a(8),n(),i(9,"span",73),a(10,"In lavorazione"),n()(),i(11,"div",71)(12,"span",75),a(13),n(),i(14,"span",73),a(15,"Completate"),n()()()),s&2){let t=m().$implicit,e=m(2);o(3),x(e.taskService.getSottoTaskCounts(t.sotto_tasks).daFare),o(5),x(e.taskService.getSottoTaskCounts(t.sotto_tasks).inLavorazione),o(5),x(e.taskService.getSottoTaskCounts(t.sotto_tasks).completate)}}function ut(s,r){s&1&&(i(0,"div",76),p(1,"i",77),a(2," Nessuna sotto-task definita "),n())}function _t(s,r){if(s&1){let t=S();i(0,"div",45)(1,"div",46)(2,"div",47)(3,"h3",48),f("click",function(){let l=u(t).$implicit,c=m(2);return _(c.apriDettaglioTask(l.id))}),n(),i(4,"div",49)(5,"span",50),p(6,"i",51),a(7),n(),i(8,"span",50),p(9,"i",52),a(10),n()()(),i(11,"div",53)(12,"div",83)(13,"span",55),a(14),n()()()(),i(15,"div",59)(16,"div",60)(17,"div",61)(18,"div",62)(19,"div",63),a(20),n()(),i(21,"span",64),a(22),n()()(),i(23,"div",84),p(24,"i",85),a(25),P(26,"date"),v(27,mt,3,0,"span",86)(28,pt,3,0,"span",58),n(),v(29,gt,16,3,"div",87)(30,ut,3,0,"div",37),n(),i(31,"div",66)(32,"small",67),a(33),P(34,"date"),n(),i(35,"button",9),f("click",function(){let l=u(t).$implicit,c=m(2);return _(c.apriDettaglioTask(l.id))}),p(36,"i",68),a(37," Gestisci "),n()()()}if(s&2){let t=r.$implicit,e=m(2);o(3),d("innerHTML",e.highlightText(t.nome),I),o(4),g(" ",(t.cliente==null?null:t.cliente.ragione_sociale)||"Nessun cliente"," "),o(3),g(" ",e.taskService.getModuloName(t.assegnazione_id||null)," "),o(3),C(e.taskService.getPrioritaBadgeClass(t.priorita_globale)),D("data-priority",t.priorita_globale),o(),N(" P",t.priorita_globale," \u2022 ",e.taskService.getNomePriorita(t.priorita_globale)," "),o(5),C(e.taskService.getStatoBadgeClass(t.stato)),V("width",t.progresso+"%"),o(),g(" ",t.progresso,"% "),o(),C(e.taskService.getStatoBadgeClass(t.stato)),o(),g(" ",e.taskService.getStatoTesto(t.stato)," "),o(),T("scaduta",e.taskService.isScaduta(t.data_scadenza))("scadenza-imminente",e.taskService.isScadenzaImminente(t.data_scadenza)),o(2),g(" ",O(26,26,t.data_scadenza,"dd/MM/yyyy")," "),o(2),d("ngIf",e.taskService.isScadenzaImminente(t.data_scadenza)),o(),d("ngIf",e.taskService.isScaduta(t.data_scadenza)),o(),d("ngIf",t.sotto_tasks&&t.sotto_tasks.length>0),o(),d("ngIf",!t.sotto_tasks||t.sotto_tasks.length===0),o(3),g(" Aggiornato: ",O(34,29,t.updated_at,"dd/MM/yyyy HH:mm")," ")}}function vt(s,r){if(s&1&&(i(0,"div",78)(1,"div",2)(2,"div",3)(3,"h1",4),p(4,"i",79),a(5," Macro Task completate "),n(),i(6,"div",80),a(7,"Elenco delle macro task concluse"),n()(),p(8,"div",6),n(),i(9,"div",81),v(10,_t,38,32,"div",82),n()()),s&2){let t=m();o(10),d("ngForOf",t.tasksCompletate)}}function ft(s,r){if(s&1){let t=S();i(0,"div",76),p(1,"i",91),i(2,"h3"),a(3,"Nessuna task trovata"),n(),i(4,"p"),a(5,"Modifica i filtri o crea una nuova macro task"),n(),i(6,"div",92)(7,"button",7),f("click",function(){u(t);let l=m();return _(l.nuovaMacroTask())}),a(8," Crea la prima task "),n()()()}}function xt(s,r){if(s&1){let t=S();i(0,"div",93),f("click",function(){u(t);let l=m();return _(l.chiudiTemplateModal())}),n()}}function kt(s,r){if(s&1){let t=S();i(0,"button",109),f("click",function(){let l=u(t).$implicit,c=m(2);return _(c.selezionaTemplate(l))}),i(1,"div",110),p(2,"i",52),a(3),n(),i(4,"span",111),a(5),n()()}if(s&2){let t=r.$implicit,e=m(2);T("active",(e.selectedTemplate==null?null:e.selectedTemplate.id)===t.id),o(3),g(" ",t.nome," "),o(2),x(e.taskService.getModuloName(t.modulo))}}function ht(s,r){if(s&1&&(i(0,"option",103),a(1),n()),s&2){let t=r.$implicit;d("ngValue",t.id),o(),x(t.ragione_sociale)}}function bt(s,r){if(s&1){let t=S();i(0,"div",94)(1,"header",95)(2,"h2",96),a(3,"Crea da Template"),n(),i(4,"button",97),f("click",function(){u(t);let l=m();return _(l.chiudiTemplateModal())}),i(5,"span",13),a(6,"close"),n()()(),i(7,"section",98)(8,"div",99)(9,"label",100)(10,"span",17),a(11,"Template"),n(),i(12,"div",101),v(13,kt,6,4,"button",102),n()(),i(14,"label",16)(15,"span",17),a(16,"Cliente"),n(),i(17,"select",18),b("ngModelChange",function(l){u(t);let c=m();return h(c.selectedTemplateClienteId,l)||(c.selectedTemplateClienteId=l),_(l)}),i(18,"option",103),a(19,"\u2014 Nessun cliente (opzionale) \u2014"),n(),v(20,ht,2,2,"option",104),n()(),i(21,"label",16)(22,"span",17),a(23,"Data scadenza"),n(),i(24,"input",105),b("ngModelChange",function(l){u(t);let c=m();return h(c.templateDataScadenza,l)||(c.templateDataScadenza=l),_(l)}),n()()()(),i(25,"footer",106)(26,"button",107),f("click",function(){u(t);let l=m();return _(l.chiudiTemplateModal())}),a(27,"Annulla"),n(),i(28,"button",108),f("click",function(){u(t);let l=m();return _(l.creaTaskDaTemplate())}),a(29," Crea "),n()()()}if(s&2){let t=m();o(13),d("ngForOf",t.macroTaskTemplates),o(4),k("ngModel",t.selectedTemplateClienteId),o(),d("ngValue",""),o(2),d("ngForOf",t.clienti),o(4),k("ngModel",t.templateDataScadenza),o(4),d("disabled",!t.selectedTemplate)}}var it=class s{constructor(r,t,e,l,c,M){this.taskService=r;this.soggettiService=t;this.router=e;this.authService=l;this.userService=c;this.sanitizer=M}currentUser=null;macroTasks=[];macroTaskTemplates=[];clienti=[];loading=!1;error="";searchTerm="";isLoading=F(!0);filtro={stato:"tutti",priorita:"tutti",cliente:"tutti",modulo:"tutti"};showTemplateModal=!1;selectedTemplate=null;templateDataScadenza="";selectedTemplateClienteId="";ngOnInit(){return w(this,null,function*(){this.isLoading.set(!0);try{try{let r=this.authService.user();if(r?.id){let t=yield this.userService.getUserById(r.id);this.currentUser=t?.data??null}}catch{this.currentUser=null}yield this.caricaDati()}finally{setTimeout(()=>{this.isLoading.set(!1)},300)}})}caricaDati(){return w(this,null,function*(){this.loading=!0,this.error="";try{let[r,t,e]=yield Promise.all([this.taskService.getMacroTasks(),this.soggettiService.getSoggettiByTipo("cliente"),this.taskService.getMacroTaskTemplates()]);if(r.error)throw r.error;if(t.error)throw t.error;if(e.error)throw e.error;this.macroTasks=r.data||[],this.clienti=t.data||[],this.macroTaskTemplates=e.data||[]}catch(r){this.error="Errore nel caricamento: "+r.message}finally{this.loading=!1}})}get tasksFiltrate(){return[...this.macroTasks.filter(e=>{if(!this.taskService.canViewTask(this.currentUser,e))return!1;let l=this.filtro.stato==="tutti"||e.stato===this.filtro.stato,c=this.filtro.priorita==="tutti"||e.priorita_globale===parseInt(this.filtro.priorita),M=this.filtro.cliente==="tutti"||e.cliente_id===this.filtro.cliente,z=this.filtro.modulo==="tutti"||e.assegnazione_id===this.filtro.modulo,E=(this.searchTerm||"").trim().toLowerCase(),nt=!E||(e.nome||"").toString().toLowerCase().includes(E);return l&&c&&M&&z&&nt})].sort((e,l)=>{let c=e.priorita_globale??0,M=l.priorita_globale??0;if(M!==c)return M-c;let z=e.data_scadenza?new Date(e.data_scadenza).getTime():1/0,E=l.data_scadenza?new Date(l.data_scadenza).getTime():1/0;return z-E})}get tasksAttive(){return this.tasksFiltrate.filter(r=>r.stato!=="completato")}get tasksCompletate(){return this.tasksFiltrate.filter(r=>r.stato==="completato")}getClienteName(r){let t=this.clienti.find(e=>e.id===r);return t?t.ragione_sociale:"N/A"}apriDettaglioTask(r){this.router.navigate(["/task-singola",r])}nuovaMacroTask(){this.router.navigate(["/task-singola","nuova"])}apriTemplateModal(){this.templateDataScadenza=this.calcolaDataScadenza(30),this.selectedTemplateClienteId=this.filtro.cliente!=="tutti"?this.filtro.cliente:"",this.showTemplateModal=!0}chiudiTemplateModal(){this.showTemplateModal=!1,this.selectedTemplate=null,this.selectedTemplateClienteId=""}selezionaTemplate(r){this.selectedTemplate=r,this.templateDataScadenza=this.calcolaDataScadenza(r.data_scadenza_default)}calcolaDataScadenza(r){let t=new Date;return t.setDate(t.getDate()+r),t.toISOString().split("T")[0]}creaTaskDaTemplate(){return w(this,null,function*(){if(this.selectedTemplate){this.loading=!0;try{let r=this.selectedTemplateClienteId||(this.filtro.cliente!=="tutti"?this.filtro.cliente:""),t=yield this.taskService.createMacroTaskFromTemplate(this.selectedTemplate.id,r,this.templateDataScadenza);t.error?this.error="Errore creazione task: "+t.error.message:(this.chiudiTemplateModal(),yield this.caricaDati(),t.data&&this.router.navigate(["/task-singola",t.data.id]))}catch(r){this.error="Errore: "+r.message}finally{this.loading=!1}}})}setPriority(r,t){return w(this,null,function*(){if(!r||!r.id)return;let e=Math.max(1,Math.min(5,Math.round(t)));if(r.priorita_globale!==e)try{let{data:l,error:c}=yield this.taskService.updateMacroTask(r.id,{priorita_globale:e});if(console.debug("[Task] setPriority result:",{id:r.id,data:l,error:c}),c){console.error("Errore aggiornamento priorit\xE0:",c);return}r.priorita_globale=l?.priorita_globale??e}catch(l){console.error("setPriority error",l)}})}increasePriority(r){this.setPriority(r,(r.priorita_globale||1)+1)}decreasePriority(r){this.setPriority(r,(r.priorita_globale||1)-1)}escapeHtml(r){return(r||"").toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}escapeRegex(r){return(r||"").toString().replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}highlightText(r){let t=(this.searchTerm||"").trim();if(!r)return this.sanitizer.bypassSecurityTrustHtml("");let e=this.escapeHtml(r);if(!t)return this.sanitizer.bypassSecurityTrustHtml(e);let l=new RegExp(this.escapeRegex(t),"ig"),c=e.replace(l,M=>`<mark class="search-highlight">${M}</mark>`);return this.sanitizer.bypassSecurityTrustHtml(c)}static \u0275fac=function(t){return new(t||s)(y(et),y(Z),y(U),y(R),y(q),y(H))};static \u0275cmp=L({type:s,selectors:[["app-task"]],decls:78,vars:15,consts:[["title","Caricamento Task","subtitle","Stiamo caricando le task...",3,"isLoading"],[1,"form-section"],[1,"section-header"],[1,"section-titles"],[1,"section-title"],[1,"fas","fa-tasks","header-icon"],[1,"actions-container"],[1,"promethea-button",3,"click"],[1,"fas","fa-plus"],[1,"promethea-button","outline",3,"click"],[1,"fas","fa-magic"],[1,"tool",2,"margin-top","var(--gutter-lg)"],["for","search",1,"label"],[1,"material-icons"],["id","search","type","text","placeholder","Cerca per titolo task...",1,"table-inline-input",3,"ngModelChange","ngModel"],[1,"grid-form"],[1,"form-field"],[1,"form-label"],[1,"form-select",3,"ngModelChange","ngModel"],["value","tutti"],["value","da_fare"],["value","in_lavorazione"],["value","completato"],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],[3,"value",4,"ngFor","ngForOf"],["value","immagine_marketing"],["value","digitalizzazione_automatismi"],["value","contabilita_fiscalita"],["value","ottimizzazione_management"],["class","status-message error",4,"ngIf"],[1,"table-section",2,"margin","var(--gutter-lg) 0"],["class","grid-responsive-tasks",4,"ngIf"],["class","table-section",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","modal-backdrop",3,"click",4,"ngIf"],["class","modal","role","dialog","aria-modal","true",4,"ngIf"],[3,"value"],[1,"status-message","error"],[1,"fas","fa-exclamation-triangle"],[1,"grid-responsive-tasks"],["class","card task-card",3,"scaduta",4,"ngFor","ngForOf"],[1,"card","task-card"],[1,"task-header"],[1,"task-main-info"],[1,"card-title","task-title",3,"click","innerHTML"],[1,"task-meta-compact"],[1,"meta-item"],[1,"fas","fa-building"],[1,"fas","fa-cube"],[1,"task-header-actions"],[1,"priority-column"],[1,"priority-badge"],[1,"scadenza-under"],[1,"scadenza-date"],["class","badge status-no",4,"ngIf"],[1,"card-body"],[1,"progress-section"],[1,"progress-info"],[1,"progress",2,"flex","1"],[1,"progress-bar"],[1,"badge"],["class","task-counts-grid",4,"ngIf"],[1,"task-footer"],[1,"text-muted"],[1,"fas","fa-arrow-right"],[1,"badge","status-no"],[1,"task-counts-grid"],[1,"count-item"],[1,"count-badge","da-fare"],[1,"count-label"],[1,"count-badge","in-lavorazione"],[1,"count-badge","completate"],[1,"empty-state"],[1,"fas","fa-info-circle"],[1,"table-section"],[1,"fas","fa-check-circle","header-icon"],[1,"sottotitolo"],[1,"grid-responsive-tasks",2,"margin-top","var(--gutter-lg)"],["class","card task-card",4,"ngFor","ngForOf"],[2,"display","flex","align-items","center","gap","6px"],[1,"scadenza-section"],[1,"fas","fa-calendar-alt"],["class","badge status-warning",4,"ngIf"],["class","sotto-tasks-counts","style","display: none;",4,"ngIf"],[1,"badge","status-warning"],[1,"fas","fa-exclamation-circle"],[1,"sotto-tasks-counts",2,"display","none"],[1,"fas","fa-clipboard-list","fa-3x"],[1,"actions"],[1,"modal-backdrop",3,"click"],["role","dialog","aria-modal","true",1,"modal"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Chiudi",1,"icon-btn",3,"click"],[1,"modal-body"],[1,"form-grid"],[1,"form-field","form-field-col-span"],[1,"grid-responsive"],["type","button","class","card clickable",3,"active","click",4,"ngFor","ngForOf"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["type","date",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button",1,"promethea-button","ghost",3,"click"],["type","button",1,"promethea-button",3,"click","disabled"],["type","button",1,"card","clickable",3,"click"],[1,"card-title"],[1,"chip"]],template:function(t,e){t&1&&(p(0,"app-page-loader",0),i(1,"div")(2,"div",1)(3,"div",2)(4,"div",3)(5,"h1",4),p(6,"i",5),a(7," Gestione Task "),n()(),i(8,"div",6)(9,"button",7),f("click",function(){return e.nuovaMacroTask()}),p(10,"i",8),a(11," Nuova Macro Task "),n(),i(12,"button",9),f("click",function(){return e.apriTemplateModal()}),p(13,"i",10),a(14," Crea da Template "),n()()(),i(15,"div",11)(16,"label",12)(17,"span",13),a(18,"search"),n(),a(19," Cerca "),n(),i(20,"input",14),b("ngModelChange",function(c){return h(e.searchTerm,c)||(e.searchTerm=c),c}),n()(),i(21,"div",15)(22,"div",16)(23,"label",17),a(24,"Stato"),n(),i(25,"select",18),b("ngModelChange",function(c){return h(e.filtro.stato,c)||(e.filtro.stato=c),c}),i(26,"option",19),a(27,"Tutti gli stati"),n(),i(28,"option",20),a(29,"Da Iniziare"),n(),i(30,"option",21),a(31,"In Lavorazione"),n(),i(32,"option",22),a(33,"Completato"),n()()(),i(34,"div",16)(35,"label",17),a(36,"Priorit\xE0"),n(),i(37,"select",18),b("ngModelChange",function(c){return h(e.filtro.priorita,c)||(e.filtro.priorita=c),c}),i(38,"option",19),a(39,"Tutte le priorit\xE0"),n(),i(40,"option",23),a(41,"Minima"),n(),i(42,"option",24),a(43,"Bassa"),n(),i(44,"option",25),a(45,"Media"),n(),i(46,"option",26),a(47,"Alta"),n(),i(48,"option",27),a(49,"Urgente"),n()()(),i(50,"div",16)(51,"label",17),a(52,"Cliente"),n(),i(53,"select",18),b("ngModelChange",function(c){return h(e.filtro.cliente,c)||(e.filtro.cliente=c),c}),i(54,"option",19),a(55,"Tutti i clienti"),n(),v(56,at,2,2,"option",28),n()(),i(57,"div",16)(58,"label",17),a(59,"Modulo"),n(),i(60,"select",18),b("ngModelChange",function(c){return h(e.filtro.modulo,c)||(e.filtro.modulo=c),c}),i(61,"option",19),a(62,"Tutti i moduli"),n(),i(63,"option",29),a(64,"Immagine e Marketing"),n(),i(65,"option",30),a(66,"Digitalizzazione e Automatismi"),n(),i(67,"option",31),a(68,"Contabilit\xE0 e Fiscalit\xE0"),n(),i(69,"option",32),a(70,"Ottimizzazione e Management"),n()()()()(),v(71,rt,3,1,"div",33),i(72,"div",34),v(73,dt,2,1,"div",35),n(),v(74,vt,11,1,"div",36)(75,ft,9,0,"div",37)(76,xt,1,0,"div",38)(77,bt,30,6,"div",39),n()),t&2&&(d("isLoading",e.isLoading()),o(),T("hidden",e.isLoading()),o(19),k("ngModel",e.searchTerm),o(5),k("ngModel",e.filtro.stato),o(12),k("ngModel",e.filtro.priorita),o(16),k("ngModel",e.filtro.cliente),o(3),d("ngForOf",e.clienti),o(4),k("ngModel",e.filtro.modulo),o(11),d("ngIf",e.error&&!e.loading),o(2),d("ngIf",!e.loading),o(),d("ngIf",!e.loading&&e.tasksCompletate.length),o(),d("ngIf",!e.loading&&e.tasksFiltrate.length===0),o(),d("ngIf",e.showTemplateModal),o(),d("ngIf",e.showTemplateModal))},dependencies:[A,W,B,Y,Q,X,G,K,$,J,tt,j],styles:['.section-title[_ngcontent-%COMP%]{margin:0}.header-actions[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:var(--gutter-sm);width:100%;max-width:320px;container-type:inline-size;padding:var(--gutter-md)}@container (max-width: 300px){.header-actions[_ngcontent-%COMP%]{grid-template-columns:1fr;max-width:100%}}@container (min-width: 301px) and (max-width: 500px){.header-actions[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr;max-width:280px}}@container (min-width: 501px){.header-actions[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr;max-width:320px}}.section-header[_ngcontent-%COMP%]{align-items:flex-start;justify-content:space-between;container-type:inline-size;margin:0}.task-detail-container[_ngcontent-%COMP%]{padding:var(--gutter-lg);background:var(--background);min-height:100vh}.task-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:minmax(0,1fr) minmax(260px,350px);gap:var(--gutter-lg);align-items:flex-start}@container (max-width: 600px){.section-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:var(--gutter-md)}.header-actions[_ngcontent-%COMP%]{max-width:100%;justify-self:center}}.header-actions[_ngcontent-%COMP%]   .promethea-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:var(--gutter-sm);padding:var(--gutter-sm) var(--gutter-md);font-size:var(--fs-sm);min-height:2.5rem;white-space:nowrap}@container (max-width: 160px){.header-actions[_ngcontent-%COMP%]   .promethea-button[_ngcontent-%COMP%]   .btn-text[_ngcontent-%COMP%]{display:none}.header-actions[_ngcontent-%COMP%]   .promethea-button[_ngcontent-%COMP%]{padding:var(--gutter-md);min-width:2.5rem}}.main-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gutter-md);min-width:0}.task-card[_ngcontent-%COMP%]{position:relative;border-left:4px solid var(--primary);padding:var(--gutter-lg);gap:var(--gutter-sm);border-radius:18px;display:flex;flex-direction:column;justify-content:space-between;height:100%}.task-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gutter-sm)}.task-card.scaduta[_ngcontent-%COMP%]{border-left-color:#ef4444;background:linear-gradient(135deg,var(--background) 0%,color-mix(in srgb,#ef4444 8%,transparent) 100%)}.task-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:var(--gutter-sm);margin-bottom:var(--gutter-sm);flex-wrap:wrap}.task-main-info[_ngcontent-%COMP%]{flex:1;min-width:0}.task-title[_ngcontent-%COMP%]{cursor:pointer;margin-bottom:var(--gutter-sm)}.task-meta-compact[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.meta-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);color:color-mix(in srgb,var(--text-color) 60%,transparent)}.task-header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);flex-shrink:0;margin-left:auto}.priority-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;min-width:5rem;height:var(--fs-md);padding:0 var(--gutter-sm);border-radius:6px;font-weight:700;border:1px solid var(--smoke-color-1);background:color-mix(in srgb,var(--text-color) 10%,transparent);text-transform:uppercase;letter-spacing:.5px}.priority-badge[data-priority="5"][_ngcontent-%COMP%]{background:linear-gradient(90deg,#6b0218,#a50b1f);color:#fff;border:1px solid rgba(0,0,0,.12);box-shadow:0 6px 16px #a50b1f1f}.priority-badge[data-priority="4"][_ngcontent-%COMP%]{background:linear-gradient(90deg,#ef4444,#c53030);color:#fff;border:1px solid rgba(0,0,0,.08)}.priority-badge[data-priority="3"][_ngcontent-%COMP%]{background:linear-gradient(90deg,#f59e0b,#d97706);color:#1a1a1a;border:1px solid rgba(0,0,0,.06)}.priority-badge[data-priority="2"][_ngcontent-%COMP%]{background:linear-gradient(90deg,#10b981,#059669);color:#fff;border:1px solid rgba(0,0,0,.06)}.priority-badge[data-priority="1"][_ngcontent-%COMP%], .priority-badge[data-priority="0"][_ngcontent-%COMP%], .priority-badge[_ngcontent-%COMP%]:not([data-priority]){background:color-mix(in srgb,var(--text-color) 6%,transparent);color:var(--text-color);border:1px solid var(--smoke-color-1)}.progress-section[_ngcontent-%COMP%]{margin:var(--gutter-sm) 0}.progress-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm)}.progress-stats[_ngcontent-%COMP%]{flex-shrink:0}.scadenza-date[_ngcontent-%COMP%]{font-weight:700;margin-top:var(--gutter-sm)}.task-counts-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gutter-sm);margin:var(--gutter-sm) 0}.count-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:var(--gutter-sm);background:var(--smoke-color-2);border-radius:8px;border:1px solid var(--smoke-color-1)}.count-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:var(--fs-md);height:var(--fs-md);padding:var(--gutter-sm);border-radius:50%;font-weight:700;color:#fff}.count-badge.da-fare[_ngcontent-%COMP%]{background:#42464d}.count-badge.in-lavorazione[_ngcontent-%COMP%]{background:var(--secondary)}.count-badge.completate[_ngcontent-%COMP%]{background:#10b981}.count-label[_ngcontent-%COMP%]{margin-top:4px;text-align:center;color:color-mix(in srgb,var(--text-color) 70%,transparent);text-transform:uppercase;letter-spacing:.5px}.task-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:var(--gutter-sm);border-top:1px solid var(--smoke-color-1);margin-top:auto}.sotto-task-card[_ngcontent-%COMP%]{border-left:4px solid var(--primary);display:flex;flex-direction:column;height:100%;container-type:inline-size;min-width:0;position:relative;overflow:visible}.sotto-task-card.expanded[_ngcontent-%COMP%]{box-shadow:0 8px 24px var(--shadow2);border-color:var(--primary)}.sotto-task-card[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{z-index:50}.sotto-task-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:var(--gutter-sm);margin-bottom:var(--gutter-sm);flex-wrap:wrap;cursor:pointer}.sotto-task-info[_ngcontent-%COMP%]{flex:1 1 auto;min-width:0;display:flex;align-items:flex-start;gap:var(--gutter-sm)}.sotto-task-content[_ngcontent-%COMP%]{flex:1;min-width:0}.sotto-task-meta[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-sm);align-items:center;flex-wrap:wrap;margin-top:.25rem}.sotto-task-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);margin-left:auto;flex:1 1 auto;justify-content:flex-end;flex-wrap:wrap;min-width:0;max-width:100%;position:relative;z-index:2}.dettaglio-container[_ngcontent-%COMP%]{max-height:0;overflow:hidden;opacity:0;transition:max-height .5s cubic-bezier(.4,0,.2,1),opacity .3s ease .1s}.dettaglio-container.show[_ngcontent-%COMP%]{max-height:5000px;opacity:1;transition:max-height .8s cubic-bezier(.4,0,.2,1),opacity .4s ease .1s}.dettaglio-list[_ngcontent-%COMP%]{border-top:1px solid var(--smoke-color-1);padding-top:var(--gutter-sm);display:flex;flex-direction:column;gap:var(--gutter-sm)}.dettaglio-item[_ngcontent-%COMP%]{padding:var(--gutter-sm);background:var(--background);border-radius:10px;border:1px solid var(--smoke-color-1);transition:all .2s ease}.dettaglio-item[_ngcontent-%COMP%]:hover{border-color:var(--primary);background:var(--smoke-color-2)}.dettaglio-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr;column-gap:var(--gutter-sm);justify-content:center;align-items:first baseline}.dettaglio-descrizione[_ngcontent-%COMP%]{padding:var(--gutter-sm) 0}.dettaglio-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:minmax(0,1fr) auto auto;align-items:center;gap:var(--gutter-sm)}.dettaglio-header[_ngcontent-%COMP%]   strong.completed[_ngcontent-%COMP%]{text-decoration:line-through;color:color-mix(in srgb,var(--text-color) 50%,transparent)}.dettaglio-counter[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;font-size:.75rem;color:color-mix(in srgb,var(--text-color) 60%,transparent);background:var(--smoke-color-2);padding:.125rem .5rem;border-radius:12px;border:1px solid var(--smoke-color-1)}.sotto-task-card[_ngcontent-%COMP%]:not(.expanded)   .dettaglio-counter[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--primary) 15%,transparent);color:var(--primary);border-color:color-mix(in srgb,var(--primary) 30%,transparent)}.form-section.riepilogo[_ngcontent-%COMP%]{padding:0;background:transparent;border:none;box-shadow:none;align-self:flex-start;position:sticky;top:var(--gutter-lg)}.contenitore-sottotask[_ngcontent-%COMP%]{gap:var(--gutter-md);display:flex;flex-direction:column}.marcotaskform[_ngcontent-%COMP%]{margin-top:var(--gutter-lg)!important}.info-card[_ngcontent-%COMP%]{background:var(--background);border:1px solid var(--smoke-color-1);border-radius:16px;padding:var(--gutter-lg);box-shadow:0 4px 12px var(--shadow);position:sticky;top:var(--gutter-lg);z-index:10}.info-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--text-color);margin-bottom:var(--gutter-sm);font-weight:600;border-bottom:2px solid var(--primary);padding-bottom:var(--gutter-sm)}.info-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:var(--gutter-sm);padding:var(--gutter-sm) 0;border-bottom:1px solid color-mix(in srgb,var(--text-color) 15%,transparent)}.info-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.info-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:var(--text-color);margin:0}.info-item[_ngcontent-%COMP%]   span.scaduta[_ngcontent-%COMP%]{color:#e74c3c;font-weight:500}.info-item[_ngcontent-%COMP%]   span.imminente[_ngcontent-%COMP%]{color:#f39c12;font-weight:500}.form-section.riepilogo[_ngcontent-%COMP%]{padding:0;background:transparent;border:none;box-shadow:none;align-self:flex-start;position:sticky;top:var(--gutter-lg);z-index:10}.sotto-task-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%], .sotto-task-actions[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]{flex:0 0 auto}.dropdown[_ngcontent-%COMP%]{position:relative;display:inline-block}.dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;display:none;min-width:180px;padding:8px 0;margin:4px 0 0;background:var(--background);border:1px solid var(--smoke-color-1);border-radius:8px;box-shadow:0 4px 12px var(--shadow);list-style:none;z-index:10000}.dropdown-menu.show[_ngcontent-%COMP%]{display:block}.dropdown-header[_ngcontent-%COMP%]{padding:var(--gutter-sm);font-weight:800;background:color-mix(in srgb,var(--text-color) 10%,transparent);text-transform:uppercase;border-bottom:1px solid color-mix(in srgb,var(--text-color) 30%,transparent)}.dropdown-menu[_ngcontent-%COMP%], .dropdown-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%], .dropdown-header[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none}.dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;width:100%;padding:8px 16px;background:transparent;border:none;color:var(--text-color);text-align:left;text-decoration:none;cursor:pointer;transition:all .2s ease;font-size:.85em}.dropdown-item[_ngcontent-%COMP%]:hover{background:var(--smoke-color-2);color:var(--primary)}.dropdown-divider[_ngcontent-%COMP%]{height:1px;background:var(--smoke-color-1);margin:8px 0;border:none}.sotto-task-card.dropdown-open[_ngcontent-%COMP%]{z-index:200}.dettaglio-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm)}.grid-responsive-tasks[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(380px,1fr));display:grid;gap:var(--gutter-lg)}@media (max-width: 1024px){.task-content[_ngcontent-%COMP%]{grid-template-columns:1fr}.form-section.riepilogo[_ngcontent-%COMP%]{position:static;order:-1}}@media (max-width: 768px){.section-header[_ngcontent-%COMP%]{display:flex;flex-direction:column}.contenitore-bottoni[_ngcontent-%COMP%]{display:flex;justify-content:center}.section-title[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}.sotto-task-header[_ngcontent-%COMP%], .task-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.sotto-task-actions[_ngcontent-%COMP%], .task-header-actions[_ngcontent-%COMP%]{margin-left:0;justify-content:flex-start}.dettaglio-header[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:var(--gutter-sm)}.sotto-tasks-counts[_ngcontent-%COMP%]{grid-template-columns:1fr}.sotto-task-global-actions[_ngcontent-%COMP%]{flex-direction:column;width:100%;margin-top:var(--gutter-sm)}}.search-highlight[_ngcontent-%COMP%], mark.search-highlight[_ngcontent-%COMP%]{display:inline!important;background:#ffeb3b65;padding:0 .12em;border-radius:2px;line-height:inherit;vertical-align:baseline}']})};export{it as Task};
