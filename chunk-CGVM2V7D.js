import{b as R,d as D,f as U,h as W,o as N,p as G,q as L,s as $,v as K}from"./chunk-DITEEB7V.js";import{j as V,k,o as T,p as O,r as B}from"./chunk-G7C3XVRV.js";import{$b as g,Ab as c,Ga as l,Ib as y,Jb as E,Kb as I,Lb as a,Mb as u,Nb as x,Ob as A,Pb as b,Qb as h,Rb as S,Sa as w,X as p,Xa as f,Y as z,_b as v,mb as m,nb as t,ob as e,wb as C,zb as _}from"./chunk-S7YZFXYO.js";import{a as F,b as M}from"./chunk-ODN5LVDJ.js";function j(s,o){if(s&1){let i=C();t(0,"div",24)(1,"label",25),a(2,"Seleziona Pacchetto:"),e(),t(3,"div",7)(4,"button",26),_("click",function(){p(i);let r=c().$implicit,d=c(2);return z(d.selezionaPacchetto(r,"base"))}),a(5," Base "),e(),t(6,"button",26),_("click",function(){p(i);let r=c().$implicit,d=c(2);return z(d.selezionaPacchetto(r,"avanzato"))}),a(7," Avanzato "),e(),t(8,"button",26),_("click",function(){p(i);let r=c().$implicit,d=c(2);return z(d.selezionaPacchetto(r,"premium"))}),a(9," Premium "),e()()()}}function Q(s,o){if(s&1){let i=C();t(0,"div",33)(1,"div",34)(2,"label",25),a(3,"Quantit\xE0:"),e(),t(4,"div",7)(5,"button",35),_("click",function(){p(i);let r=c().$implicit,d=c(3);return z(d.modificaQuantita(r.id,-1))}),a(6,"-"),e(),t(7,"input",36),S("ngModelChange",function(r){p(i);let d=c().$implicit,P=c(3);return h(P.configurazioni[d.id].quantita,r)||(P.configurazioni[d.id].quantita=r),z(r)}),_("change",function(){p(i);let r=c(4);return z(r.calcolaTotali())}),e(),t(8,"button",37),_("click",function(){p(i);let r=c().$implicit,d=c(3);return z(d.modificaQuantita(r.id,1))}),a(9,"+"),e()()()()}if(s&2){let i=c().$implicit,n=c(3);l(7),b("ngModel",n.configurazioni[i.id].quantita)}}function H(s,o){if(s&1){let i=C();t(0,"div",40)(1,"label",41)(2,"input",29),_("change",function(){let r=p(i).$implicit,d=c(5);return r.selezionato=!r.selezionato,z(d.calcolaTotali())}),e(),t(3,"span",9),a(4),e(),a(5),v(6,"currency"),e(),t(7,"p",42),a(8),e()()}if(s&2){let i=o.$implicit,n=c(2).$implicit;l(2),m("checked",i.selezionato)("disabled",!n.selezionato),l(2),u(i.selezionato?"check_box":"check_box_outline_blank"),l(),A(" ",i.nome," - ",g(6,6,i.prezzo,"EUR")," "),l(3),u(i.descrizione)}}function J(s,o){if(s&1&&(t(0,"div",38),f(1,H,9,9,"div",39),e()),s&2){let i=c().$implicit,n=c().$implicit,r=c(2);l(),m("ngForOf",r.getServiziDipendenti(n,i.id))}}function X(s,o){if(s&1){let i=C();t(0,"div",27)(1,"div",28)(2,"label",25)(3,"input",29),_("change",function(){let r=p(i).$implicit,d=c().$implicit,P=c(2);return r.selezionato=!r.selezionato,z(P.onServizioChange(r,d))}),e(),t(4,"span",9),a(5),e(),a(6),v(7,"currency"),e(),t(8,"p",30),a(9),e(),f(10,Q,10,1,"div",31)(11,J,2,1,"div",32),e()()}if(s&2){let i=o.$implicit,n=c().$implicit,r=c(2);l(),E("disabilitato",!r.isServizioAbilitato(i,n)),l(2),m("checked",i.selezionato)("disabled",!r.isServizioAbilitato(i,n)),l(2),u(i.selezionato?"check_box":"check_box_outline_blank"),l(),A(" ",i.nome," - ",g(7,10,r.getPrezzoServizio(i),"EUR")," "),l(3),u(i.descrizione),l(),m("ngIf",i.tipo==="configurabile"&&i.selezionato),l(),m("ngIf",i.tipo==="gruppo")}}function Y(s,o){if(s&1&&(t(0,"div",20)(1,"div",0)(2,"div",4)(3,"span",9),a(4,"category"),e(),a(5),t(6,"span",21),a(7),v(8,"currency"),e()(),f(9,j,10,0,"div",22)(10,X,12,13,"div",23),e()()),s&2){let i=o.$implicit,n=c(2);l(5),x(" ",n.moduli[i].nome," "),l(2),x(" ",g(8,4,n.moduli[i].totale,"EUR")," "),l(2),m("ngIf",n.hasPacchetti(i)),l(),m("ngForOf",n.moduli[i].servizi)}}function Z(s,o){if(s&1&&(t(0,"div",18),f(1,Y,11,7,"div",19),e()),s&2){let i=c();l(),m("ngForOf",i.getModuliKeys())}}function ii(s,o){if(s&1&&(t(0,"option",59),a(1),e()),s&2){let i=o.$implicit;m("value",i),l(),x(" ",i," ")}}function ei(s,o){if(s&1){let i=C();t(0,"div",0)(1,"div",4)(2,"span",9),a(3,"add_circle"),e(),a(4," Aggiungi Nuovo Costo "),e(),t(5,"div",46)(6,"div",27)(7,"label",25),a(8,"Descrizione"),e(),t(9,"input",47),S("ngModelChange",function(r){p(i);let d=c(2);return h(d.nuovoCosto.descrizione,r)||(d.nuovoCosto.descrizione=r),z(r)}),e()(),t(10,"div",27)(11,"label",25),a(12,"Importo"),e(),t(13,"input",48),S("ngModelChange",function(r){p(i);let d=c(2);return h(d.nuovoCosto.importo,r)||(d.nuovoCosto.importo=r),z(r)}),e()(),t(14,"div",27)(15,"label",25),a(16,"Categoria"),e(),t(17,"select",49),S("ngModelChange",function(r){p(i);let d=c(2);return h(d.nuovoCosto.categoria,r)||(d.nuovoCosto.categoria=r),z(r)}),f(18,ii,2,2,"option",50),e()(),t(19,"div",27)(20,"label",25),a(21,"Tipo"),e(),t(22,"select",49),S("ngModelChange",function(r){p(i);let d=c(2);return h(d.nuovoCosto.tipo,r)||(d.nuovoCosto.tipo=r),z(r)}),t(23,"option",51),a(24,"Fisso"),e(),t(25,"option",52),a(26,"Variabile"),e()()(),t(27,"div",27)(28,"label",25),a(29,"Periodicit\xE0"),e(),t(30,"select",49),S("ngModelChange",function(r){p(i);let d=c(2);return h(d.nuovoCosto.periodicita,r)||(d.nuovoCosto.periodicita=r),z(r)}),t(31,"option",53),a(32,"Mensile"),e(),t(33,"option",54),a(34,"Trimestrale"),e(),t(35,"option",55),a(36,"Annuale"),e(),t(37,"option",56),a(38,"Una Tantum"),e()()()(),t(39,"div",57)(40,"button",8),_("click",function(){p(i);let r=c(2);return z(r.aggiungiCosto())}),t(41,"span",9),a(42,"save"),e(),a(43," Salva Costo "),e(),t(44,"button",58),_("click",function(){p(i);let r=c(2);return z(r.mostraFormCosto=!1)}),a(45," Annulla "),e()()()}if(s&2){let i=c(2);l(9),b("ngModel",i.nuovoCosto.descrizione),l(4),b("ngModel",i.nuovoCosto.importo),l(4),b("ngModel",i.nuovoCosto.categoria),l(),m("ngForOf",i.categorieCosti),l(4),b("ngModel",i.nuovoCosto.tipo),l(8),b("ngModel",i.nuovoCosto.periodicita)}}function ti(s,o){if(s&1){let i=C();t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"span",15),a(5),e()(),t(6,"td")(7,"span",62),a(8),e()(),t(9,"td"),a(10),v(11,"currency"),e(),t(12,"td"),a(13),v(14,"currency"),e(),t(15,"td")(16,"div",63)(17,"button",64),_("click",function(){let r=p(i).$implicit,d=c(3);return z(d.rimuoviCosto(r.id))}),t(18,"span",9),a(19,"delete"),e()()()()()}if(s&2){let i=o.$implicit,n=c(3);l(2),u(i.descrizione),l(2),I(i.tipo==="fisso"?"badge-primary":"badge-secondary"),l(),x(" ",i.tipo," "),l(3),u(i.periodicita),l(2),u(g(11,7,i.importo,"EUR")),l(3),u(g(14,10,n.getImportoCostoAnnuale(i),"EUR"))}}function ni(s,o){if(s&1&&(t(0,"div")(1,"div",0)(2,"div",4)(3,"span",9),a(4,"folder"),e(),a(5),t(6,"span",21),a(7),v(8,"currency"),e()(),t(9,"div",60)(10,"table",61)(11,"thead")(12,"tr")(13,"th"),a(14,"Descrizione"),e(),t(15,"th"),a(16,"Tipo"),e(),t(17,"th"),a(18,"Periodicit\xE0"),e(),t(19,"th"),a(20,"Importo"),e(),t(21,"th"),a(22,"Annuale"),e(),t(23,"th"),a(24,"Azioni"),e()()(),t(25,"tbody"),f(26,ti,20,13,"tr",44),e()()()()()),s&2){let i=o.$implicit,n=c(2);l(5),x(" ",i," "),l(2),x(" ",g(8,3,n.getTotaleCategoria(i),"EUR")," "),l(19),m("ngForOf",n.getCostiPerCategoria()[i])}}function oi(s,o){if(s&1){let i=C();t(0,"div",57)(1,"button",8),_("click",function(){p(i);let r=c(2);return z(r.mostraFormCosto=!0)}),t(2,"span",9),a(3,"add"),e(),a(4," Aggiungi Costo "),e()()}}function ai(s,o){if(s&1&&(t(0,"div"),f(1,ei,46,6,"div",43)(2,ni,27,6,"div",44)(3,oi,5,0,"div",45),e()),s&2){let i=c();l(),m("ngIf",i.mostraFormCosto),l(),m("ngForOf",i.getCategorieCosti()),l(),m("ngIf",!i.mostraFormCosto)}}function ri(s,o){if(s&1&&(t(0,"div",73)(1,"span"),a(2),e(),t(3,"span",74),a(4),v(5,"currency"),e()()),s&2){let i=o.$implicit,n=c(2);l(2),u(n.moduli[i].nome),l(2),u(g(5,2,n.moduli[i].totale,"EUR"))}}function li(s,o){if(s&1&&(t(0,"div",73)(1,"span"),a(2),e(),t(3,"span",74),a(4),v(5,"currency"),e()()),s&2){let i=o.$implicit,n=c(2);l(2),u(i),l(2),u(g(5,2,n.getTotaleCategoria(i),"EUR"))}}function si(s,o){if(s&1&&(t(0,"div")(1,"div",0)(2,"div",4)(3,"span",9),a(4,"analytics"),e(),a(5," Riepilogo Bilancio Previsionale "),e(),t(6,"div",65)(7,"div",66)(8,"div",67)(9,"div",68),a(10,"Ricavi"),e(),t(11,"div",69),a(12),v(13,"currency"),e()(),t(14,"div",70)(15,"div",68),a(16,"Costi"),e(),t(17,"div",69),a(18),v(19,"currency"),e()(),t(20,"div",71)(21,"div",68),a(22,"Margine"),e(),t(23,"div",69),a(24),v(25,"currency"),e()()()(),t(26,"div",46)(27,"div",0)(28,"h3",4),a(29,"Dettaglio Ricavi"),e(),f(30,ri,6,5,"div",72),e(),t(31,"div",0)(32,"h3",4),a(33,"Dettaglio Costi"),e(),f(34,li,6,5,"div",72),e()()()()),s&2){let i=c();l(8),y("height",i.getAltezzaBarra(i.bilancio.totaleRicavi),"%"),l(4),u(g(13,15,i.bilancio.totaleRicavi,"EUR")),l(2),y("height",i.getAltezzaBarra(i.bilancio.totaleCosti),"%"),l(4),u(g(19,18,i.bilancio.totaleCosti,"EUR")),l(2),y("height",i.getAltezzaBarra(i.getValoreAssoluto(i.bilancio.margineOperativo)),"%"),E("positivo",i.bilancio.margineOperativo>=0)("negativo",i.bilancio.margineOperativo<0),l(4),u(g(25,21,i.bilancio.margineOperativo,"EUR")),l(6),m("ngForOf",i.getModuliKeys()),l(4),m("ngForOf",i.getCategorieCosti())}}var q=class s{moduli={immagine_marketing:{nome:"Immagine & Marketing",servizi:[{id:"creazione_logo",nome:"Creazione del Logo",prezzo:300,selezionato:!1,descrizione:"Design professionale del logo aziendale"},{id:"creazione_brand",nome:"Creazione del Brand",prezzo:800,selezionato:!1,descrizione:"Identit\xE0 visiva completa: logo, palette colori, typography"},{id:"social_2_post",nome:"Gestione Social Media (2 post/settimana)",prezzo:400,selezionato:!1,pacchetto:"base",descrizione:"2 post settimanali su Facebook e Instagram"},{id:"social_3_post",nome:"Gestione Social Media (3 post/settimana)",prezzo:600,selezionato:!1,pacchetto:"avanzato",descrizione:"3 post settimanali su Facebook, Instagram e LinkedIn"},{id:"social_5_post",nome:"Gestione Social Media (5 post/settimana)",prezzo:800,selezionato:!1,pacchetto:"premium",descrizione:"5 post settimanali su tutti i social + stories"},{id:"servizio_fotografico",nome:"Servizio Fotografico",prezzo:500,selezionato:!1,descrizione:"Servizio fotografico professionale per prodotti/azienda"}],totale:0},digitalizzazione_automatismi:{nome:"Digitalizzazione & Automatismi",servizi:[{id:"landing_page",nome:"Landing Page",prezzo:1e3,selezionato:!1,pacchetto:"base",descrizione:"Pagina di destinazione ottimizzata per conversioni"},{id:"sito_completo",nome:"Sito Web Completo",prezzo:2e3,selezionato:!1,pacchetto:"avanzato",descrizione:"Sito web responsive"},{id:"sito_pro",nome:"Sito Web Pro",prezzo:3500,selezionato:!1,pacchetto:"premium",descrizione:"Sito web avanzato con funzionalit\xE0 personalizzate"},{id:"software_personalizzato",nome:"Software Personalizzato",prezzo:0,selezionato:!1,descrizione:"Richiesta di valutazione per software su misura"},{id:"consulenza_digitale",nome:"Consulenza Digitale",prezzo:300,selezionato:!1,descrizione:"Consulenza per mailing list, automazioni e digital strategy"}],totale:0},contabilita_fiscalita:{nome:"Contabilit\xE0 e Fiscalit\xE0",servizi:[{id:"costituzione_principale",nome:"Costituzione Azienda",prezzo:0,selezionato:!1,categoria:"Costituzione",descrizione:"Servizi di costituzione aziendale - Seleziona per attivare i servizi specifici",tipo:"gruppo"},{id:"cost_assic_redazione",nome:"Assistenza redazione atto costitutivo e Statuto",prezzo:150,selezionato:!1,categoria:"Costituzione",descrizione:"Assistenza redazione atto costitutivo e Statuto (oltre costo notaio e spese accessorie notaio)",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_apertura_piva",nome:"Apertura partita IVA",prezzo:100,selezionato:!1,categoria:"Costituzione",descrizione:"Apertura partita IVA",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_cciaa_no_scia",nome:"Pratica CCIAA senza SCIA",prezzo:80,selezionato:!1,categoria:"Costituzione",descrizione:"Pratica CCIAA per comunicazione attivit\xE0 (senza SCIA) - oltre accessorie (30 Euro diritti CCIAA)",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_cciaa_con_scia",nome:"Pratica CCIAA con SCIA",prezzo:200,selezionato:!1,categoria:"Costituzione",descrizione:"Pratica CCIAA per comunicazione attivit\xE0 (con SCIA al Comune) - oltre accessorie (30 Euro diritti CCIAA)",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_cciaa_scia_plus",nome:"Pratica CCIAA con SCIA plus",prezzo:250,selezionato:!1,categoria:"Costituzione",descrizione:"Pratica CCIAA per comunicazione attivit\xE0 (con SCIA al Comune e plus) - oltre accessorie",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_inps_artigiani",nome:"INPS art/comm",prezzo:50,selezionato:!1,categoria:"Costituzione",descrizione:"INPS artigiani commercianti (soci lavoratori) - per ciascuno",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_inps_gest_separata",nome:"INPS gestione separata",prezzo:80,selezionato:!1,categoria:"Costituzione",descrizione:"INPS gestione separata (P.IVA individuale e amministratori) - per ciascuno",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_vidimazione_libri",nome:"Vidimazione libri sociali",prezzo:20,selezionato:!1,categoria:"Costituzione",descrizione:"Vidimazione libri sociali (oltre accessori) - per libro",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"cost_registrazione_verbali",nome:"Registrazione verbali",prezzo:100,selezionato:!1,categoria:"Costituzione",descrizione:"Registrazione verbali - oltre accessori",tipo:"fisso",dipendeDa:"costituzione_principale"},{id:"contabilita_principale",nome:"Servizi di Contabilit\xE0",prezzo:0,selezionato:!1,categoria:"Contabilit\xE0",descrizione:"Seleziona il tipo di contabilit\xE0 e inserisci il numero di registrazioni annuali",tipo:"configurabile"},{id:"fatturazione_principale",nome:"Servizi di Fatturazione",prezzo:0,selezionato:!1,categoria:"Fatturazione",descrizione:"Configura i servizi di fatturazione in base alle tue esigenze",tipo:"configurabile"},{id:"iva_principale",nome:"Servizi IVA",prezzo:0,selezionato:!1,categoria:"IVA",descrizione:"Configura i servizi IVA in base alla tua periodicit\xE0",tipo:"configurabile"},{id:"redditi_principale",nome:"Dichiarazione Redditi",prezzo:0,selezionato:!1,categoria:"Redditi",descrizione:"Configura la dichiarazione redditi in base al tipo di soggetto e volume d'affari",tipo:"configurabile"},{id:"bilancio_principale",nome:"Bilancio",prezzo:0,selezionato:!1,categoria:"Bilancio",descrizione:"Configura il servizio di bilancio in base alle tue esigenze",tipo:"configurabile"},{id:"altro_cu_autonomi",nome:"CU autonomi (fino a 5 percipienti)",prezzo:180,selezionato:!1,categoria:"Altri Servizi",descrizione:"CU per autonomi - fino a 5 percipienti",tipo:"fisso"},{id:"altro_modello_770",nome:"Modello 770",prezzo:100,selezionato:!1,categoria:"Altri Servizi",descrizione:"Modello 770 - autonomi e capitali - una tantum/anno",tipo:"fisso"},{id:"altro_f24_12",nome:"F24 (fino a 12/anno)",prezzo:300,selezionato:!1,categoria:"Altri Servizi",descrizione:"F24 - fino a 12 pagamenti/anno",tipo:"fisso"},{id:"altro_imu_dichiarazione",nome:"Dichiarazione IMU/ILIA",prezzo:60,selezionato:!1,categoria:"Altri Servizi",descrizione:"Dichiarazione IMU/ILIA",tipo:"fisso"},{id:"altro_imu_verifica",nome:"Verifica Esatto/calcolo IMU",prezzo:40,selezionato:!1,categoria:"Altri Servizi",descrizione:"Verifica Esatto/calcolo IMU",tipo:"fisso"},{id:"altro_imu_pagamento",nome:"Pagamento IMU a scadenza",prezzo:25,selezionato:!1,categoria:"Altri Servizi",descrizione:"Pagamento IMU a scadenza",tipo:"fisso"},{id:"altro_avvisi_bonari",nome:"Autotutela avvisi bonari",prezzo:70,selezionato:!1,categoria:"Altri Servizi",descrizione:"Autotutela avvisi bonari",tipo:"fisso"},{id:"altro_locazioni",nome:"Supporto contratti locazione",prezzo:180,selezionato:!1,categoria:"Altri Servizi",descrizione:"Supporto nella predisposizione e registrazione contratti locazione",tipo:"fisso"},{id:"altro_lettere_intento",nome:"Invio lettere d'intento",prezzo:85,selezionato:!1,categoria:"Altri Servizi",descrizione:"Invio lettere d'intento - per ciascuna",tipo:"fisso"},{id:"altro_smart_card_rilascio",nome:"Rilascio Smart Card",prezzo:60,selezionato:!1,categoria:"Altri Servizi",descrizione:"Rilascio Smart Card - per ciascuna",tipo:"fisso"},{id:"altro_smart_card_conservazione",nome:"Conservazione Smart Card",prezzo:30,selezionato:!1,categoria:"Altri Servizi",descrizione:"Conservazione Smart Card - annuale",tipo:"fisso"},{id:"altro_titolare_effettivo",nome:"Invio pratica titolare effettivo",prezzo:130,selezionato:!1,categoria:"Altri Servizi",descrizione:"Invio pratica titolare effettivo - prezzo medio",tipo:"fisso"},{id:"altro_visure_online",nome:"Visura ordinaria",prezzo:20,selezionato:!1,categoria:"Altri Servizi",descrizione:"Visura ordinaria",tipo:"fisso"},{id:"altro_chiamate_consulenza",nome:"Chiamate per consulenza",prezzo:300,selezionato:!1,categoria:"Altri Servizi",descrizione:"Chiamate per consulenza - una tantum",tipo:"fisso"},{id:"altro_gestione_pec",nome:"Gestione PEC mensile",prezzo:16,selezionato:!1,categoria:"Altri Servizi",descrizione:"Gestione mensile PEC",tipo:"fisso"}],totale:0},ottimizzazione_management:{nome:"Ottimizzazione e Management",servizi:[{id:"consulenza_impresa_base",nome:"Consulenza di Impresa Base",prezzo:800,selezionato:!1,pacchetto:"base",descrizione:"Analisi iniziale e piano di miglioramento base"},{id:"consulenza_impresa_avanzata",nome:"Consulenza di Impresa Avanzata",prezzo:1500,selezionato:!1,pacchetto:"avanzato",descrizione:"Consulenza strategica con piano d'azione dettagliato"},{id:"consulenza_impresa_premium",nome:"Consulenza di Impresa Premium",prezzo:2500,selezionato:!1,pacchetto:"premium",descrizione:"Consulenza completa con supporto continuativo"},{id:"formazione_commerciale_base",nome:"Formazione Commerciale Base",prezzo:600,selezionato:!1,pacchetto:"base",descrizione:"Corso base di tecniche di vendita"},{id:"formazione_commerciale_avanzata",nome:"Formazione Commerciale Avanzata",prezzo:1200,selezionato:!1,pacchetto:"avanzato",descrizione:"Formazione avanzata con simulazioni pratiche"},{id:"formazione_commerciale_premium",nome:"Formazione Commerciale Premium",prezzo:2e3,selezionato:!1,pacchetto:"premium",descrizione:"Programma completo con coaching individuale"}],totale:0}};costi=[{id:"costo1",descrizione:"Affitto ufficio",importo:500,tipo:"fisso",categoria:"Struttura",periodicita:"mensile"},{id:"costo2",descrizione:"Stipendi",importo:3e3,tipo:"fisso",categoria:"Personale",periodicita:"mensile"},{id:"costo3",descrizione:"Bollette",importo:200,tipo:"variabile",categoria:"Utilit\xE0",periodicita:"mensile"}];nuovoCosto={id:"",descrizione:"",importo:0,tipo:"fisso",categoria:"Generale",periodicita:"mensile"};categorieCosti=["Struttura","Personale","Utilit\xE0","Marketing","Software","Fornitori","Generale"];bilancio={totaleRicavi:0,totaleCosti:0,margineOperativo:0,marginePercentuale:0};vistaAttiva="ricavi";mostraFormCosto=!1;configurazioni={};periodoAnalisi=12;totaleGenerale=0;moduliAperti={};ngOnInit(){this.inizializzaConfigurazioni(),this.calcolaTotali()}inizializzaConfigurazioni(){Object.keys(this.moduli).forEach(o=>{this.moduli[o].servizi.forEach(i=>{i.tipo==="configurabile"&&(this.configurazioni[i.id]={quantita:1,mesi:12})})})}toggleModulo(o){this.moduliAperti[o]=!this.moduliAperti[o]}onServizioChange(o,i){o.tipo==="gruppo"&&this.moduli[i].servizi.forEach(n=>{n.dipendeDa===o.id&&(n.selezionato=o.selezionato)}),this.calcolaTotali()}calcolaTotali(){this.totaleGenerale=0,Object.keys(this.moduli).forEach(o=>{let i=this.moduli[o];i.totale=0,i.servizi.forEach(n=>{if(n.selezionato){let r=n.prezzo;if(n.tipo==="configurabile"&&this.configurazioni[n.id]){let d=this.configurazioni[n.id];r=this.calcolaPrezzoConfigurabile(n.id,d)}i.totale+=r}}),this.totaleGenerale+=i.totale})}calcolaPrezzoConfigurabile(o,i){switch(o){case"contabilita_principale":return i.quantita*50;case"fatturazione_principale":return i.quantita*30;default:return 0}}getServiziDipendenti(o,i){return this.moduli[o].servizi.filter(n=>n.dipendeDa===i)}isServizioAbilitato(o,i){if(!o.dipendeDa)return!0;let n=this.moduli[i].servizi.find(r=>r.id===o.dipendeDa);return n?n.selezionato:!1}selezionaPacchetto(o,i){this.moduli[o].servizi.forEach(n=>{n.pacchetto===i?n.selezionato=!0:n.pacchetto&&n.pacchetto!==i&&(n.selezionato=!1)}),this.calcolaTotali()}getModuliKeys(){return Object.keys(this.moduli)}getNumeroServiziSelezionati(){let o=0;return Object.keys(this.moduli).forEach(i=>{o+=this.moduli[i].servizi.filter(n=>n.selezionato).length}),o}hasPacchetti(o){return this.moduli[o].servizi.some(i=>i.pacchetto)}getPrezzoServizio(o){return o.tipo==="configurabile"&&this.configurazioni[o.id]?this.calcolaPrezzoConfigurabile(o.id,this.configurazioni[o.id]):o.prezzo}modificaQuantita(o,i){this.configurazioni[o]&&(this.configurazioni[o].quantita=Math.max(1,this.configurazioni[o].quantita+i),this.calcolaTotali())}aggiungiCosto(){if(this.nuovoCosto.descrizione&&this.nuovoCosto.importo>0){let o=M(F({},this.nuovoCosto),{id:"costo_"+Date.now()});this.costi.push(o),this.nuovoCosto={id:"",descrizione:"",importo:0,tipo:"fisso",categoria:"Generale",periodicita:"mensile"},this.mostraFormCosto=!1,this.calcolaBilancio()}}rimuoviCosto(o){this.costi=this.costi.filter(i=>i.id!==o),this.calcolaBilancio()}getCostiPerCategoria(){return this.costi.reduce((o,i)=>(o[i.categoria]||(o[i.categoria]=[]),o[i.categoria].push(i),o),{})}getImportoCostoAnnuale(o){switch(o.periodicita){case"mensile":return o.importo*12;case"trimestrale":return o.importo*4;case"annuale":return o.importo;case"una_tantum":return o.importo;default:return o.importo}}calcolaBilancio(){this.bilancio.totaleRicavi=0,Object.keys(this.moduli).forEach(o=>{let i=this.moduli[o];i.totale=0,i.servizi.forEach(n=>{if(n.selezionato){let r=n.prezzo;if(n.tipo==="configurabile"&&this.configurazioni[n.id]){let d=this.configurazioni[n.id];r=this.calcolaPrezzoConfigurabile(n.id,d)}i.totale+=r}}),this.bilancio.totaleRicavi+=i.totale}),this.bilancio.totaleCosti=this.costi.reduce((o,i)=>o+this.getImportoCostoAnnuale(i),0),this.bilancio.margineOperativo=this.bilancio.totaleRicavi-this.bilancio.totaleCosti,this.bilancio.marginePercentuale=this.bilancio.totaleRicavi>0?this.bilancio.margineOperativo/this.bilancio.totaleRicavi*100:0}cambiaVista(o){this.vistaAttiva=o}getCategorieCosti(){return[...new Set(this.costi.map(i=>i.categoria))].sort()}getTotaleCategoria(o){return this.costi.filter(i=>i.categoria===o).reduce((i,n)=>i+this.getImportoCostoAnnuale(n),0)}getAltezzaBarra(o){let i=Math.max(this.bilancio.totaleRicavi,this.bilancio.totaleCosti,Math.abs(this.bilancio.margineOperativo));return i>0?o/i*80:0}getValoreAssoluto(o){return Math.abs(o)}static \u0275fac=function(i){return new(i||s)};static \u0275cmp=w({type:s,selectors:[["app-pianificazione-finanziaria"]],decls:57,vars:30,consts:[[1,"form-section"],[1,"section-header"],[1,"material-icons","header-icon"],[1,"section-titles"],[1,"section-title"],[1,"sottotitolo"],[1,"actions"],[1,"count-controls"],[1,"promethea-button",3,"click"],[1,"material-icons"],[1,"prospect-cards"],[1,"card"],[1,"card-title"],[1,"card-number"],[1,"text-muted"],[1,"badge"],["style","margin-top: var(--gutter-lg);",4,"ngIf"],[4,"ngIf"],[2,"margin-top","var(--gutter-lg)"],["class","grid-form","style","margin: var(--gutter-lg) 0;",4,"ngFor","ngForOf"],[1,"grid-form",2,"margin","var(--gutter-lg) 0"],[1,"badge",2,"margin-left","auto"],["class","actions","style","margin: var(--gutter-md) 0;",4,"ngIf"],["class","form-field",4,"ngFor","ngForOf"],[1,"actions",2,"margin","var(--gutter-md) 0"],[1,"form-label"],[1,"promethea-button","outline",3,"click"],[1,"form-field"],[1,"servizio-item"],["type","checkbox",3,"change","checked","disabled"],[1,"descrizione","text-muted"],["class","configurazione",4,"ngIf"],["class","servizi-dipendenti",4,"ngIf"],[1,"configurazione"],[1,"count-control"],[1,"action-btn",3,"click"],["type","number","min","1",1,"count-input",3,"ngModelChange","change","ngModel"],[1,"action-btn","add",3,"click"],[1,"servizi-dipendenti"],["class","servizio-dipendente",4,"ngFor","ngForOf"],[1,"servizio-dipendente"],[1,"form-label",2,"margin-left","2rem"],[1,"descrizione","text-muted",2,"margin-left","2rem"],["class","form-section",4,"ngIf"],[4,"ngFor","ngForOf"],["class","actions-container",4,"ngIf"],[1,"grid-form"],["type","text","placeholder","Es. Affitto, Bollette, Stipendi...",3,"ngModelChange","ngModel"],["type","number","min","0","step","0.01",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["value","fisso"],["value","variabile"],["value","mensile"],["value","trimestrale"],["value","annuale"],["value","una_tantum"],[1,"actions-container"],[1,"promethea-button","ghost",3,"click"],[3,"value"],[1,"table-container"],[1,"crm-table"],[1,"chip"],[1,"table-actions"],[1,"action-btn","delete",3,"click"],[1,"bilancio-chart"],[1,"chart-bars"],[1,"chart-bar","ricavi"],[1,"chart-label"],[1,"chart-value"],[1,"chart-bar","costi"],[1,"chart-bar","margine"],["class","voce-bilancio",4,"ngFor","ngForOf"],[1,"voce-bilancio"],[1,"importo"]],template:function(i,n){i&1&&(t(0,"div",0)(1,"div",1)(2,"span",2),a(3,"trending_up"),e(),t(4,"div",3)(5,"h1",4),a(6,"Previsione Finanziaria"),e(),t(7,"p",5),a(8,"Bilancio previsionale tra ricavi e costi aziendali"),e()()(),t(9,"div",6)(10,"div",7)(11,"button",8),_("click",function(){return n.cambiaVista("ricavi")}),t(12,"span",9),a(13,"attach_money"),e(),a(14," Ricavi "),e(),t(15,"button",8),_("click",function(){return n.cambiaVista("costi")}),t(16,"span",9),a(17,"money_off"),e(),a(18," Costi "),e(),t(19,"button",8),_("click",function(){return n.cambiaVista("bilancio")}),t(20,"span",9),a(21,"balance"),e(),a(22," Bilancio "),e()()(),t(23,"div",10)(24,"div",11)(25,"div",12)(26,"span"),a(27,"Totale Ricavi"),e(),t(28,"div",13),a(29),v(30,"currency"),e()(),t(31,"p",14),a(32,"Ricavi annuali dai servizi"),e()(),t(33,"div",11)(34,"div",12)(35,"span"),a(36,"Totale Costi"),e(),t(37,"div",13),a(38),v(39,"currency"),e()(),t(40,"p",14),a(41,"Costi operativi annuali"),e()(),t(42,"div",11)(43,"div",12)(44,"span"),a(45,"Margine Operativo"),e(),t(46,"div",13),a(47),v(48,"currency"),e()(),t(49,"p",14),a(50),v(51,"number"),t(52,"span",15),a(53),e()()()(),f(54,Z,2,1,"div",16)(55,ai,4,3,"div",17)(56,si,35,24,"div",17),e()),i&2&&(l(11),E("outline",n.vistaAttiva!=="ricavi"),l(4),E("outline",n.vistaAttiva!=="costi"),l(4),E("outline",n.vistaAttiva!=="bilancio"),l(10),u(g(30,18,n.bilancio.totaleRicavi,"EUR")),l(9),u(g(39,21,n.bilancio.totaleCosti,"EUR")),l(4),I(n.bilancio.margineOperativo>=0?"card":"card error"),l(5),u(g(48,24,n.bilancio.margineOperativo,"EUR")),l(3),x(" ",g(51,27,n.bilancio.marginePercentuale,"1.1-1"),"% "),l(2),I(n.bilancio.margineOperativo>=0?"badge-success":"badge-danger"),l(),x(" ",n.bilancio.margineOperativo>=0?"Positivo":"Negativo"," "),l(),m("ngIf",n.vistaAttiva==="ricavi"),l(),m("ngIf",n.vistaAttiva==="costi"),l(),m("ngIf",n.vistaAttiva==="bilancio"))},dependencies:[B,V,k,K,G,L,R,W,N,D,$,U,T,O],styles:[".servizio-item[_ngcontent-%COMP%]{padding:var(--gutter-sm);border:1px solid var(--smoke-color-1);border-radius:12px;margin-bottom:var(--gutter-sm);transition:all .3s ease}.servizio-item[_ngcontent-%COMP%]:hover{border-color:var(--primary);background:color-mix(in srgb,var(--primary) 5%,transparent)}.servizio-item.disabilitato[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.servizio-item.disabilitato[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{color:color-mix(in srgb,var(--text-color) 40%,transparent)}.configurazione[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--background) 80%,var(--smoke-color-1));padding:var(--gutter-sm);border-radius:8px;margin-top:var(--gutter-sm);border:1px solid var(--smoke-color-1)}.servizi-dipendenti[_ngcontent-%COMP%]{margin-top:var(--gutter-sm);padding-left:var(--gutter-sm);border-left:3px solid var(--smoke-color-1)}.servizio-dipendente[_ngcontent-%COMP%]{margin-bottom:var(--gutter-sm)}.servizi-riepilogo[_ngcontent-%COMP%]{margin-top:var(--gutter-sm)}.servizio-riepilogo[_ngcontent-%COMP%]{font-size:var(--fs-sm);color:color-mix(in srgb,var(--text-color) 80%,transparent);margin-bottom:.25rem}.descrizione[_ngcontent-%COMP%]{font-size:.9em;margin:.25rem 0 0 2rem;line-height:1.4}@media (max-width: 768px){.servizio-item[_ngcontent-%COMP%], .configurazione[_ngcontent-%COMP%]{padding:var(--gutter-sm)}}"]})};export{q as PianificazioneFinanziaria};
