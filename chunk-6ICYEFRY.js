import{e as z,g as U,k as Y}from"./chunk-233B5766.js";import{Ab as C,Bb as M,Da as k,Db as L,Fa as s,Fb as c,Ka as P,La as x,Mb as j,Ra as I,Wa as g,X as m,Xb as H,Y as _,Ya as v,eb as E,fb as S,gb as u,hb as r,ib as a,ja as w,jb as f,nb as A,ob as T,pb as b,qb as h,tb as p,ub as l,vb as V,wb as O,xb as D,yb as B,zb as y}from"./chunk-R6HFAJZF.js";var R=["[dropdown-items]"],q=["trigger"],N=[[["","dropdown-items",""]]];function $(o,t){if(o&1){let e=h();r(0,"button",13),p("click",function(i){m(e);let d=l(3);return _(d.emitAction("send-intro-email",i))}),f(1,"img",15),r(2,"span"),c(3,"Invia presentazione Promethea"),a()()}}function W(o,t){if(o&1){let e=h();r(0,"button",16),p("click",function(){m(e);let i=l(3);return _(i.onSendYuvi())}),f(1,"img",17),c(2," Invia Presentazione YUVI "),a()}}function X(o,t){if(o&1){let e=h();r(0,"button",13),p("click",function(i){m(e);let d=l(3);return _(d.emitAction("promethea",i))}),f(1,"img",18),r(2,"span"),c(3,"Configurazione Promethea"),a()()}}function G(o,t){if(o&1){let e=h();r(0,"button",13),p("click",function(i){m(e);let d=l(3);return _(d.emitAction("yuvi",i))}),f(1,"img",17),r(2,"span"),c(3,"Trattativa YUVI"),a()()}}function J(o,t){if(o&1){let e=h();r(0,"button",13),p("click",function(i){m(e);let d=l(3);return _(d.emitAction("info-tecniche",i))}),r(1,"span",4),c(2,"build"),a(),r(3,"span"),c(4,"Informazioni tecniche"),a()()}}function K(o,t){if(o&1){let e=h();r(0,"button",19),p("click",function(i){m(e);let d=l(3);return i.stopPropagation(),_(d.openProductPicker(d.row))}),r(1,"span",20)(2,"span",4),c(3,"inventory_2"),a()(),r(4,"span",21)(5,"span",22),c(6,"Aggiungi prodotto"),a(),r(7,"small",23),c(8,"Scegli e assegna un prodotto al cliente"),a()()()}}function Z(o,t){if(o&1){let e=h();A(0),g(1,$,4,0,"button",9)(2,W,3,0,"button",10)(3,X,4,0,"button",9)(4,G,4,0,"button",9)(5,J,5,0,"button",9),f(6,"hr",11),g(7,K,9,0,"button",12),r(8,"button",13),p("click",function(i){m(e);let d=l(2);return _(d.emitAction("edit",i))}),r(9,"span",4),c(10,"edit"),a(),r(11,"span"),c(12,"Modifica"),a()(),r(13,"button",13),p("click",function(i){m(e);let d=l(2);return _(d.emitAction("esito",i))}),r(14,"span",4),c(15,"add"),a(),r(16,"span"),c(17,"Aggiungi esito"),a()(),r(18,"button",14),p("click",function(i){m(e);let d=l(2);return _(d.emitAction("delete",i))}),r(19,"span",4),c(20,"delete"),a(),r(21,"span"),c(22,"Elimina"),a()(),T()}if(o&2){let e=l(2);s(),u("ngIf",e.showPromethea),s(),u("ngIf",e.row&&((e.row==null||e.row.prodotti==null?null:e.row.prodotti.includes("Partner-YUVI"))||e.row.prodotto&&(e.row.prodotto+"").includes("Partner-YUVI")||(e.row==null?null:e.row.hasTrattativaYuvi))),s(),u("ngIf",e.row==null?null:e.row.hasConfigPromethea),s(),u("ngIf",e.row==null?null:e.row.hasTrattativaYuvi),s(),u("ngIf",e.primaryIcons==null?null:e.primaryIcons.infoTecniche),s(2),u("ngIf",!e.hideAddProduct),s(11),u("disabled",e.row==null?null:e.row.deleting)}}function ee(o,t){if(o&1&&(O(0),g(1,Z,23,7,"ng-container",8)),o&2){let e=l();s(),u("ngIf",!e.hasProjectedMenu)}}function te(o,t){if(o&1){let e=h();r(0,"div",24),p("click",function(){m(e);let i=l();return _(i.close())}),a()}}function ne(o,t){o&1&&b(0)}function ie(o,t){if(o&1){let e=h();r(0,"div",25)(1,"div",26)(2,"button",27),p("click",function(){m(e);let i=l();return _(i.close())}),r(3,"span",4),c(4,"close"),a()()(),r(5,"div",28),g(6,ne,1,0,"ng-container",29),a()()}if(o&2){l();let e=M(6);s(6),u("ngTemplateOutlet",e)}}function oe(o,t){o&1&&b(0)}function re(o,t){if(o&1){let e=h();r(0,"div",30),p("click",function(i){return m(e),_(i.stopPropagation())}),g(1,oe,1,0,"ng-container",29),a()}if(o&2){l();let e=M(6);s(),u("ngTemplateOutlet",e)}}var Q=class o{constructor(t,e){this.el=t;this.renderer=e}mode="modal";row;hideAddProduct=!1;showPromethea=!0;sendYuvi=new v;primaryIcons={};trigger;opened=new v;closed=new v;action=new v;projectedMenu;_hasProjectedMenu=!1;get hasProjectedMenu(){return this._hasProjectedMenu||!!this.projectedMenu}open=!1;detachedBackdrop;detachedModal;outsideUnlisten;detachedInlineMenu;repositionUnlisten;toggle(t){t&&t.stopPropagation(),this.open?this._close():this._open()}_open(){this.open=!0,setTimeout(()=>{this.updateProjectedPresence(),this.mode==="modal"?(this.attachToBody(),document.body.classList.add("dropdown-open")):this.attachInlineMenuToBody(),this.listenOutside(),this.opened.emit()},0)}_close(){this.open=!1,this.removeOutsideListener(),this.mode==="modal"?(this.detachFromBody(),document.body.classList.remove("dropdown-open")):(this.detachInlineMenuFromBody(),this.repositionUnlisten&&(this.repositionUnlisten(),this.repositionUnlisten=void 0)),this.closed.emit()}close(){this._close()}openProductPicker(t){this.action.emit("add-product"),this._close()}emitAction(t,e){e&&e.stopPropagation(),this.action.emit(t),this._close()}listenOutside(){this.removeOutsideListener(),this.outsideUnlisten=this.renderer.listen("document","click",t=>{let e=t.target;(this.mode==="modal"?!this.el.nativeElement.contains(e)&&!this.detachedModal?.contains(e):!this.el.nativeElement.contains(e)&&!this.detachedInlineMenu?.contains(e))&&this._close()})}removeOutsideListener(){this.outsideUnlisten&&(this.outsideUnlisten(),this.outsideUnlisten=void 0)}attachToBody(){try{let t=this.el.nativeElement;if(this.mode!=="modal")return;let e=t.querySelector(".modal"),n=t.querySelector(".dropdown-backdrop");n&&!this.detachedBackdrop&&(this.detachedBackdrop=n,this.renderer.appendChild(document.body,n),this.renderer.setStyle(n,"z-index","2200")),e&&!this.detachedModal&&(this.detachedModal=e,this.renderer.appendChild(document.body,e),this.renderer.setStyle(e,"position","fixed"),this.renderer.setStyle(e,"z-index","2201"),this.renderer.setStyle(e,"left","50%"),this.renderer.setStyle(e,"top","50%"),this.renderer.setStyle(e,"transform","translate(-50%, -50%)"))}catch(t){console.warn("[action-dropdown] attachToBody failed",t)}}detachFromBody(){try{this.detachedModal&&this.detachedModal.parentElement===document.body&&(this.renderer.removeChild(document.body,this.detachedModal),this.detachedModal=void 0),this.detachedBackdrop&&this.detachedBackdrop.parentElement===document.body&&(this.renderer.removeChild(document.body,this.detachedBackdrop),this.detachedBackdrop=void 0)}catch{}}onScrollClose(){this.open&&this._close()}ngOnDestroy(){this.removeOutsideListener(),this.detachFromBody(),this.detachInlineMenuFromBody(),document.body.classList.remove("dropdown-open")}attachInlineMenuToBody(){try{let e=this.el.nativeElement.querySelector(".dropdown-menu");if(!e||this.detachedInlineMenu)return;this.detachedInlineMenu=e,this.renderer.appendChild(document.body,e),this.renderer.setStyle(e,"position","absolute"),this.renderer.setStyle(e,"z-index","2201"),this.positionInlineMenu()}catch(t){console.warn("[action-dropdown] attachInlineMenuToBody failed",t)}}positionInlineMenu(){if(!(!this.detachedInlineMenu||!this.trigger))try{let e=this.trigger.nativeElement.getBoundingClientRect(),n=this.detachedInlineMenu,i=e.left+window.scrollX,d=e.bottom+window.scrollY+6;this.renderer.setStyle(n,"left",`${Math.max(8,i)}px`),this.renderer.setStyle(n,"top",`${d}px`),this.renderer.setStyle(n,"min-width",`${Math.max(160,e.width+8)}px`)}catch{}}detachInlineMenuFromBody(){try{if(this.detachedInlineMenu&&this.detachedInlineMenu.parentElement===document.body){let t=this.el.nativeElement;this.renderer.appendChild(t,this.detachedInlineMenu),this.renderer.removeStyle(this.detachedInlineMenu,"position"),this.renderer.removeStyle(this.detachedInlineMenu,"left"),this.renderer.removeStyle(this.detachedInlineMenu,"top"),this.renderer.removeStyle(this.detachedInlineMenu,"z-index"),this.detachedInlineMenu=void 0}}catch{}}ngAfterContentInit(){try{this.updateProjectedPresence()}catch{}}updateProjectedPresence(){try{let t=this.el.nativeElement,e=!!t.querySelector("[dropdown-items]");this._hasProjectedMenu=e,e?this.renderer.addClass(t,"has-projected-menu"):this.renderer.removeClass(t,"has-projected-menu")}catch{}}onSendYuvi(){this.sendYuvi.emit(this.row)}static \u0275fac=function(e){return new(e||o)(x(w),x(P))};static \u0275cmp=I({type:o,selectors:[["app-action-dropdown"]],contentQueries:function(e,n,i){if(e&1&&D(i,R,5,w),e&2){let d;y(d=C())&&(n.projectedMenu=d.first)}},viewQuery:function(e,n){if(e&1&&B(q,7,w),e&2){let i;y(i=C())&&(n.trigger=i.first)}},hostBindings:function(e,n){e&1&&p("scroll",function(){return n.onScrollClose()},k)},inputs:{mode:"mode",row:"row",hideAddProduct:"hideAddProduct",showPromethea:"showPromethea",primaryIcons:"primaryIcons"},outputs:{sendYuvi:"sendYuvi",opened:"opened",closed:"closed",action:"action"},ngContentSelectors:R,decls:10,vars:10,consts:[["trigger",""],["menuContent",""],[1,"actions-dropdown",3,"aria-expanded"],["title","Altre azioni","aria-haspopup","dialog",1,"action-btn",3,"click"],[1,"material-icons"],["class","dropdown-backdrop","aria-hidden","true",3,"click",4,"ngIf"],["class","modal","role","dialog","aria-modal","true","tabindex","-1",4,"ngIf"],["class","dropdown-menu","role","menu","aria-hidden","false",3,"click",4,"ngIf"],[4,"ngIf"],["class","dropdown-item",3,"click",4,"ngIf"],["type","button","class","dropdown-item",3,"click",4,"ngIf"],[1,"divider"],["class","dropdown-item","title","Aggiungi prodotto","aria-label","Aggiungi prodotto",3,"click",4,"ngIf"],[1,"dropdown-item",3,"click"],[1,"dropdown-item","danger",3,"click","disabled"],["src","assets/Logotipo.png","alt","YUVI",1,"icon-img"],["type","button",1,"dropdown-item",3,"click"],["src","assets/yuvi.png","alt","YUVI",1,"icon-img"],["src","assets/Logo.png","alt","Promethea",1,"icon-img"],["title","Aggiungi prodotto","aria-label","Aggiungi prodotto",1,"dropdown-item",3,"click"],["aria-hidden","true",1,"item-icon"],[1,"item-content"],[1,"item-title"],[1,"text-muted","item-sub"],["aria-hidden","true",1,"dropdown-backdrop",3,"click"],["role","dialog","aria-modal","true","tabindex","-1",1,"modal"],[1,"modal-header"],["aria-label","Chiudi",1,"modal-close",3,"click"],[1,"modal-body"],[4,"ngTemplateOutlet"],["role","menu","aria-hidden","false",1,"dropdown-menu",3,"click"]],template:function(e,n){if(e&1){let i=h();V(N),r(0,"div",2)(1,"button",3,0),p("click",function(F){return m(i),_(n.toggle(F))}),r(3,"span",4),c(4,"more_vert"),a()(),g(5,ee,2,1,"ng-template",null,1,H)(7,te,1,0,"div",5)(8,ie,7,1,"div",6)(9,re,2,1,"div",7),a()}e&2&&(L("open",n.open)("inline-mode",n.mode==="menu"),E("aria-expanded",j(n.open)),s(),S("aria-expanded",n.open),s(6),u("ngIf",n.open&&n.mode==="modal"),s(),u("ngIf",n.open&&n.mode==="modal"),s(),u("ngIf",n.mode==="menu"&&n.open))},dependencies:[Y,z,U],styles:[".actions-dropdown[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center}.dropdown-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000047;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);z-index:1200}.actions-dropdown[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]{position:fixed!important;top:50%!important;left:50%!important;transform:translate(-50%,-50%)!important;width:min(92vw,480px);max-height:84vh;overflow-y:auto;z-index:1201;background:var(--background, #fff);border-radius:12px;box-shadow:0 24px 60px #0a141e47;border:1px solid var(--smoke-color-1, #ececec)}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:.25rem}.modal-close[_ngcontent-%COMP%]{background:transparent;border:none;cursor:pointer;padding:.25rem;color:var(--text-color)}.modal-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:0;padding:.25rem .5rem .6rem}.dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm,.5rem);padding:.6rem .8rem;background:transparent;border:none;width:100%;text-align:left;cursor:pointer;color:var(--text-color);font-weight:500}.dropdown-item[_ngcontent-%COMP%]:hover{background:color-mix(in srgb,var(--smoke-color-1) 12%,transparent)}.dropdown-item[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:1.1rem;width:24px;color:var(--muted-color)}.item-sub[_ngcontent-%COMP%]{margin:var(--gutter-sm)}.icon-img[_ngcontent-%COMP%]{width:18px;height:18px;object-fit:contain}.divider[_ngcontent-%COMP%]{border:none;height:1px;background:var(--smoke-color-1);margin:.25rem 0}.dropdown-item.danger[_ngcontent-%COMP%]{color:var(--danger, #b00020)}@media (max-width: 640px){.actions-dropdown[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]{width:min(96vw,420px);border-radius:10px}.dropdown-item[_ngcontent-%COMP%]{padding:.85rem 1rem;font-size:1rem}}.actions-dropdown[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]{position:fixed!important;top:50%!important;left:50%!important;transform:translate(-50%,-50%)!important;z-index:2201!important}.dropdown-backdrop[_ngcontent-%COMP%]{position:fixed!important;inset:0!important;z-index:2200!important}.actions-dropdown[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:.5rem 0}.dropdown-item[_ngcontent-%COMP%]{padding:.6rem 1rem;position:relative}.dropdown-item[_ngcontent-%COMP%]:before{content:none!important}.dropdown-item[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%], .dropdown-item[_ngcontent-%COMP%]   .icon-img[_ngcontent-%COMP%]{margin-left:0;margin-right:var(--gutter-sm, .5rem)}"]})};export{Q as a};
